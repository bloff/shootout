<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
	<title>C:\Fulgham\Projects\shootout\bench\spellcheck\spellcheck.erlang</title>
	<link rel="stylesheet" type="text/css" href="highlight.css">
</head>
<body>
<pre><span class="line">    1 </span><span class="com">%%% -*- mode: erlang -*-
</span><span class="line">    2 </span><span class="com"></span><span class="com">%%% $Id: spellcheck.erlang.html,v 1.1 2004-06-14 23:09:28 bfulgham Exp $
</span><span class="line">    3 </span><span class="com"></span><span class="com">%%% http://www.bagley.org/~doug/shootout/
</span><span class="line">    4 </span><span class="com"></span>
<span class="line">    5 </span>-module(spellcheck).
<span class="line">    6 </span>-export([main/0, main/1]).
<span class="line">    7 </span>
<span class="line">    8 </span>
<span class="line">    9 </span>main() -&gt; main([<span class="str">'1'</span>]).
<span class="line">   10 </span>main(Args) -&gt;
<span class="line">   11 </span>    <span class="com">% load dictionary into hash table (erlang ets table)
</span><span class="line">   12 </span><span class="com"></span>    Dict = load_dict(),
<span class="line">   13 </span>    <span class="com">% read words from stin and print those not in dictionary
</span><span class="line">   14 </span><span class="com"></span>    spell(Dict),
<span class="line">   15 </span>    halt(0).
<span class="line">   16 </span>
<span class="line">   17 </span>
<span class="line">   18 </span>load_dict() -&gt;
<span class="line">   19 </span>    Dict = ets:new(i_am_a_carrot, [set]),
<span class="line">   20 </span>    {ok, In} = file:open(<span class="str">&quot;Usr.Dict.Words&quot;</span>, [raw]),
<span class="line">   21 </span>    <span class="com">% I'm just guessing that the file opened above has fd=3
</span><span class="line">   22 </span><span class="com"></span>    <span class="com">% this is a total hack, but I could find nothing in the Erlang
</span><span class="line">   23 </span><span class="com"></span>    <span class="com">% documention on how to do this.
</span><span class="line">   24 </span><span class="com"></span>    Port = open_port({fd, <span class="num">3</span>, <span class="num">1</span>}, [eof, {line, <span class="num">64</span>}]),
<span class="line">   25 </span>    read_dict(Port, Dict),
<span class="line">   26 </span>    file:close(In),
<span class="line">   27 </span>    Dict.
<span class="line">   28 </span>
<span class="line">   29 </span>
<span class="line">   30 </span>load_dict_1() -&gt;
<span class="line">   31 </span>    Dict = ets:new(i_am_a_carrot, [set]),
<span class="line">   32 </span>    <span class="com">%{ok, In} = file:open(&quot;Usr.Dict.Words&quot;, [read]),
</span><span class="line">   33 </span><span class="com"></span>    <span class="com">%Port = open_port({fd, ????, 1}, [eof, {line, 64}]),
</span><span class="line">   34 </span><span class="com"></span>    Port = open_port({<span class="typ">spawn</span>, <span class="str">&quot;cat Usr.Dict.Words&quot;</span>}, [eof, {line, <span class="num">64</span>}]),
<span class="line">   35 </span>    read_dict(Port, Dict),
<span class="line">   36 </span>    <span class="com">%file:close(In),
</span><span class="line">   37 </span><span class="com"></span>    Dict.
<span class="line">   38 </span>
<span class="line">   39 </span>
<span class="line">   40 </span>read_dict(Port, Dict) -&gt;
<span class="line">   41 </span>    <span class="key">receive
</span><span class="line">   42 </span><span class="key">    </span>{Port, {_, {_, Word}}} -&gt;
<span class="line">   43 </span>        Atom = list_to_atom(Word),
<span class="line">   44 </span>        ets:insert(Dict, { Atom, <span class="num">1 </span>}),
<span class="line">   45 </span>        read_dict(Port, Dict);
<span class="line">   46 </span>    {Port, eof} -&gt; ok
<span class="line">   47 </span>    <span class="key">end</span>.
<span class="line">   48 </span>
<span class="line">   49 </span>
<span class="line">   50 </span>spell(Dict) -&gt;
<span class="line">   51 </span>    Port = open_port({fd, <span class="num">0</span>, <span class="num">1</span>}, [eof, {line, <span class="num">64</span>}]),
<span class="line">   52 </span>    spell(Port, Dict).
<span class="line">   53 </span>
<span class="line">   54 </span>spell(Port, Dict) -&gt;
<span class="line">   55 </span>    <span class="key">receive
</span><span class="line">   56 </span><span class="key">    </span>{Port, {_, {_, Word}}} -&gt;
<span class="line">   57 </span>        Atom = list_to_atom(Word),
<span class="line">   58 </span>        <span class="key">case </span>ets:lookup(Dict, Atom) <span class="key">of
</span><span class="line">   59 </span><span class="key">        </span>[] -&gt; io:format(<span class="str">&quot;~w~n&quot;</span>,[Atom]);
<span class="line">   60 </span>        _  -&gt; ok
<span class="line">   61 </span>        <span class="key">end</span>,
<span class="line">   62 </span>        spell(Port, Dict);
<span class="line">   63 </span>    {Port, eof} -&gt; ok
<span class="line">   64 </span>    <span class="key">end</span>.
</pre>
</body>
</html>
<!--HTML generated by highlight 2.0-24, http://www.andre-simon.de/-->
