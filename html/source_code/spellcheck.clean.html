<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
	<title>C:\Fulgham\Projects\shootout\bench\spellcheck\spellcheck.clean</title>
	<link rel="stylesheet" type="text/css" href="highlight.css">
</head>
<body>
<pre><span class="line">    1 </span>/* The Great Computer Language Shootout  
<span class="line">    2 </span>   contributed by Isaac Gouy (Clean novice) 
<span class="line">    3 </span> 
<span class="line">    4 </span>   http://shootout.alioth.debian.org/ 
<span class="line">    5 </span>    
<span class="line">    6 </span> NOTE: This solution is OK reading input.txt <span class="key">as </span>a text file. 
<span class="line">    7 </span>       It fails when reading the re-directed file from stdin. 
<span class="line">    8 </span>  
<span class="line">    9 </span>       IO error: fend: not allowed for stdio and stderr    
<span class="line">   10 </span> 
<span class="line">   11 </span>To compile:     
<span class="line">   12 </span>   cleanIDE.exe <span class="com">--batch-force-build &quot;e:\shoot\contrib\clean\spellcheck.
</span><span class="line">   13 </span><span class="com"></span>   prj<span class="str">&quot; 
</span><span class="line">   14 </span><span class="str"> 
</span><span class="line">   15 </span><span class="str">To run: 
</span><span class="line">   16 </span><span class="str">   spellcheck.exe -con &lt; input.txt &gt; output.txt 
</span><span class="line">   17 </span><span class="str">*/ 
</span><span class="line">   18 </span><span class="str"> 
</span><span class="line">   19 </span><span class="str">module spellcheck 
</span><span class="line">   20 </span><span class="str">import StdEnv, SimpleHash 
</span><span class="line">   21 </span><span class="str">   
</span><span class="line">   22 </span><span class="str">Start world  
</span><span class="line">   23 </span><span class="str">    # dictionary = htNew 20000 
</span><span class="line">   24 </span><span class="str">    # (dictionary,world) = readUsrDictWords world dictionary 
</span><span class="line">   25 </span><span class="str">    = checkInputWords world dictionary  
</span><span class="line">   26 </span><span class="str"> 
</span><span class="line">   27 </span><span class="str">readUsrDictWords world ht 
</span><span class="line">   28 </span><span class="str">    # (openok, file, world) = fopen &quot;</span>Usr.Dict.Words<span class="str">&quot; FReadText world 
</span><span class="line">   29 </span><span class="str">    | not openok = abort (&quot;</span>Cannot open Usr.Dict.Words\n<span class="str">&quot;) 
</span><span class="line">   30 </span><span class="str">    # ht = readWords file ht 
</span><span class="line">   31 </span><span class="str">    = (ht,world) 
</span><span class="line">   32 </span><span class="str">     
</span><span class="line">   33 </span><span class="str">    where 
</span><span class="line">   34 </span><span class="str">    readWords f ht  
</span><span class="line">   35 </span><span class="str">           #! (atEnd,f) = fend f 
</span><span class="line">   36 </span><span class="str">           | atEnd = ht 
</span><span class="line">   37 </span><span class="str">           #! (line, f) = freadline f 
</span><span class="line">   38 </span><span class="str">           = readWords f (htAdd line 1 ht) 
</span><span class="line">   39 </span><span class="str">                       
</span><span class="line">   40 </span><span class="str">/*            
</span><span class="line">   41 </span><span class="str">checkInputWords world ht  
</span><span class="line">   42 </span><span class="str">    # (openok, file, world) = fopen &quot;</span>input.txt<span class="str">&quot; FReadText world 
</span><span class="line">   43 </span><span class="str">    | not openok = abort (&quot;</span>Cannot open input.txt\n<span class="str">&quot;) 
</span><span class="line">   44 </span><span class="str">    = missingWords file ht [] 
</span><span class="line">   45 </span><span class="str">*/ 
</span><span class="line">   46 </span><span class="str"> 
</span><span class="line">   47 </span><span class="str">checkInputWords world ht  
</span><span class="line">   48 </span><span class="str">   # (console, world) = stdio world 
</span><span class="line">   49 </span><span class="str">    = missingWords console ht []     
</span><span class="line">   50 </span><span class="str"> 
</span><span class="line">   51 </span><span class="str">missingWords f ht missing     
</span><span class="line">   52 </span><span class="str">    #! (atEnd,f) = fend f 
</span><span class="line">   53 </span><span class="str">    | atEnd = map withNewline missing 
</span><span class="line">   54 </span><span class="str">    #! (line, f) = freadline f 
</span><span class="line">   55 </span><span class="str">    | (htHasKey line ht) = missingWords f ht missing 
</span><span class="line">   56 </span><span class="str">    = missingWords f ht [line:missing]     
</span><span class="line">   57 </span><span class="str">    where 
</span><span class="line">   58 </span><span class="str">    withNewline s 
</span><span class="line">   59 </span><span class="str">        = if (s.[size s - 1] == '\n') s (s+++&quot;</span>\n<span class="str">&quot;) </span>
</pre>
</body>
</html>
<!--HTML generated by highlight 2.0-24, http://www.andre-simon.de/-->
