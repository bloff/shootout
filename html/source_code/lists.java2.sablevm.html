<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
	<title>C:\Fulgham\Projects\shootout\bench\lists\lists.java2.sablevm</title>
	<link rel="stylesheet" type="text/css" href="highlight.css">
</head>
<body>
<pre><span class="line">    1 </span><span class="com">// $Id: lists.java2.sablevm.html,v 1.1 2004-06-14 23:09:27 bfulgham Exp $
</span><span class="line">    2 </span><span class="com"></span><span class="com">// http://www.bagley.org/~doug/shootout/
</span><span class="line">    3 </span><span class="com"></span><span class="com">// from Stephen Darnell
</span><span class="line">    4 </span><span class="com"></span>
<span class="line">    5 </span><span class="com">//import java.io.*;        // XXX Not needed
</span><span class="line">    6 </span><span class="com"></span><span class="com">//import java.util.*;    // XXX Replaced by private version
</span><span class="line">    7 </span><span class="com"></span><span class="com">//import java.text.*;    // XXX Not needed
</span><span class="line">    8 </span><span class="com"></span>
<span class="line">    9 </span><span class="key">public class </span>lists <span class="sym">{
</span><span class="line">   10 </span><span class="sym">
</span><span class="line">   11 </span><span class="sym">    </span><span class="com">// XXX Make SIZE a final static
</span><span class="line">   12 </span><span class="com"></span>    <span class="key">final static int </span>SIZE = <span class="num">10000</span>;
<span class="line">   13 </span>
<span class="line">   14 </span>    <span class="key">public static void </span>main(String args[]<span class="sym">)
</span><span class="line">   15 </span><span class="sym">    {
</span><span class="line">   16 </span><span class="sym">        </span><span class="key">int </span>n = <span class="num">10</span>;
<span class="line">   17 </span>        <span class="key">if </span><span class="sym">(</span>args.length == <span class="num">1</span><span class="sym">)
</span><span class="line">   18 </span><span class="sym">        {
</span><span class="line">   19 </span><span class="sym">            </span>n = <span class="typ">Integer</span>.parseInt(args[0]<span class="sym">)</span>;
<span class="line">   20 </span>        <span class="sym">}
</span><span class="line">   21 </span><span class="sym">
</span><span class="line">   22 </span><span class="sym">        </span><span class="key">long </span>start = <span class="typ">System</span>.currentTimeMillis(<span class="sym">)</span>;
<span class="line">   23 </span>
<span class="line">   24 </span>        <span class="key">int </span>result = <span class="num">0</span>;
<span class="line">   25 </span>        <span class="key">for </span><span class="sym">(</span><span class="key">int </span>i = <span class="num">0</span>; i &lt; n; i++<span class="sym">) {
</span><span class="line">   26 </span><span class="sym">            </span>result = test_lists(<span class="sym">)</span>;
<span class="line">   27 </span>        <span class="sym">}
</span><span class="line">   28 </span><span class="sym">        </span><span class="key">long </span>stop = <span class="typ">System</span>.currentTimeMillis(<span class="sym">)</span>;
<span class="line">   29 </span>
<span class="line">   30 </span>        <span class="typ">System</span>.out.println(result<span class="sym">)</span>;
<span class="line">   31 </span>        <span class="com">// System.out.println(&quot;Took &quot;+(stop-start)+&quot; ms&quot;);
</span><span class="line">   32 </span><span class="com"></span>    <span class="sym">}
</span><span class="line">   33 </span><span class="sym">
</span><span class="line">   34 </span><span class="sym">    </span><span class="key">public static int </span>test_lists(<span class="sym">) {
</span><span class="line">   35 </span><span class="sym">    </span><span class="key">int </span>result = <span class="num">0</span>;
<span class="line">   36 </span>    <span class="com">// create a list of integers (Li1) from 1 to SIZE
</span><span class="line">   37 </span><span class="com"></span>    <span class="typ">LinkedList </span>Li1 = <span class="key">new </span>LinkedList(<span class="sym">)</span>;
<span class="line">   38 </span>    <span class="key">for </span><span class="sym">(</span><span class="key">int </span>i = <span class="num">1</span>; i &lt; SIZE+1; i++<span class="sym">) {
</span><span class="line">   39 </span><span class="sym">        </span>Li1.addLast(new LLEntry(i<span class="sym">))</span>;
<span class="line">   40 </span>    <span class="sym">}
</span><span class="line">   41 </span><span class="sym">
</span><span class="line">   42 </span><span class="sym"></span><span class="com">//    System.out.println(&quot;Li1 &quot;+Li1.size());
</span><span class="line">   43 </span><span class="com"></span>
<span class="line">   44 </span>    <span class="com">// copy the list to Li2 (not by individual items)
</span><span class="line">   45 </span><span class="com"></span>    <span class="typ">LinkedList </span>Li2 = <span class="key">new </span>LinkedList(Li1<span class="sym">)</span>;
<span class="line">   46 </span>    <span class="typ">LinkedList </span>Li3 = <span class="key">new </span>LinkedList(<span class="sym">)</span>;
<span class="line">   47 </span>
<span class="line">   48 </span><span class="com">//    System.out.println(&quot;Li2 &quot;+Li2.size()+&quot; Li3 &quot;+Li3.size());
</span><span class="line">   49 </span><span class="com"></span>
<span class="line">   50 </span>    <span class="com">// remove each individual item from left side of Li2 and
</span><span class="line">   51 </span><span class="com"></span>    <span class="com">// append to right side of Li3 (preserving order)
</span><span class="line">   52 </span><span class="com"></span>    <span class="key">while </span><span class="sym">(</span>! Li2.isEmpty(<span class="sym">)) {
</span><span class="line">   53 </span><span class="sym">        </span>Li3.addLast(Li2.removeFirst(<span class="sym">))</span>;
<span class="line">   54 </span>    <span class="sym">}
</span><span class="line">   55 </span><span class="sym">
</span><span class="line">   56 </span><span class="sym"></span><span class="com">//    System.out.println(&quot;Li2 &quot;+Li2.size()+&quot; Li3 &quot;+Li3.size());
</span><span class="line">   57 </span><span class="com"></span>
<span class="line">   58 </span>    <span class="com">// Li2 must now be empty
</span><span class="line">   59 </span><span class="com"></span>    <span class="com">// remove each individual item from right side of Li3 and
</span><span class="line">   60 </span><span class="com"></span>    <span class="com">// append to right side of Li2 (reversing list)
</span><span class="line">   61 </span><span class="com"></span>    <span class="key">while </span><span class="sym">(</span>! Li3.isEmpty(<span class="sym">)) {
</span><span class="line">   62 </span><span class="sym">        </span>Li2.addLast(Li3.removeLast(<span class="sym">))</span>;
<span class="line">   63 </span>    <span class="sym">}
</span><span class="line">   64 </span><span class="sym">
</span><span class="line">   65 </span><span class="sym"></span><span class="com">//    System.out.println(&quot;Li2 &quot;+Li2.size()+&quot; Li3 &quot;+Li3.size());
</span><span class="line">   66 </span><span class="com"></span>
<span class="line">   67 </span>    <span class="com">// Li3 must now be empty
</span><span class="line">   68 </span><span class="com"></span>    <span class="com">// reverse Li1
</span><span class="line">   69 </span><span class="com"></span>    <span class="typ">LinkedList </span>tmp = <span class="key">new </span>LinkedList(<span class="sym">)</span>;
<span class="line">   70 </span>    <span class="key">while </span><span class="sym">(</span>! Li1.isEmpty(<span class="sym">)) {
</span><span class="line">   71 </span><span class="sym">        </span>tmp.addFirst(Li1.removeFirst(<span class="sym">))</span>;
<span class="line">   72 </span>    <span class="sym">}
</span><span class="line">   73 </span><span class="sym">    </span>Li1 = tmp;
<span class="line">   74 </span>    <span class="com">// check that first item is now SIZE
</span><span class="line">   75 </span><span class="com"></span>    <span class="key">if </span><span class="sym">(</span>Li1.getFirst(<span class="sym">)</span>.val != SIZE<span class="sym">) {
</span><span class="line">   76 </span><span class="sym">        </span><span class="typ">System</span>.err.println(<span class="str">&quot;first item of Li1 != SIZE&quot;</span><span class="sym">)</span>;
<span class="line">   77 </span>        return(0<span class="sym">)</span>;
<span class="line">   78 </span>    <span class="sym">}
</span><span class="line">   79 </span><span class="sym">    </span><span class="com">// compare Li1 and Li2 for equality
</span><span class="line">   80 </span><span class="com"></span>    <span class="key">if </span><span class="sym">(</span>! Li1.equals(Li2<span class="sym">)) {
</span><span class="line">   81 </span><span class="sym">        </span><span class="typ">System</span>.err.println(<span class="str">&quot;Li1 and Li2 differ&quot;</span><span class="sym">)</span>;
<span class="line">   82 </span>        <span class="typ">System</span>.err.println(<span class="str">&quot;Li1:&quot;</span> + Li1<span class="sym">)</span>;
<span class="line">   83 </span>        <span class="typ">System</span>.err.println(<span class="str">&quot;Li2:&quot;</span> + Li2<span class="sym">)</span>;
<span class="line">   84 </span>        return(0<span class="sym">)</span>;
<span class="line">   85 </span>    <span class="sym">}
</span><span class="line">   86 </span><span class="sym">    </span><span class="com">// return the length of the list
</span><span class="line">   87 </span><span class="com"></span>    return(Li1.size(<span class="sym">))</span>;
<span class="line">   88 </span>    <span class="sym">}
</span><span class="line">   89 </span><span class="sym">}
</span><span class="line">   90 </span><span class="sym">
</span><span class="line">   91 </span><span class="sym"></span><span class="key">class </span>LLEntry
<span class="line">   92 </span><span class="sym">{
</span><span class="line">   93 </span><span class="sym">    </span>LLEntry prev, next;
<span class="line">   94 </span>    <span class="key">int </span>val;
<span class="line">   95 </span>
<span class="line">   96 </span>    LLEntry(<span class="sym">) { }
</span><span class="line">   97 </span><span class="sym">
</span><span class="line">   98 </span><span class="sym">    </span>LLEntry(int value<span class="sym">) {
</span><span class="line">   99 </span><span class="sym">        </span>val = value;
<span class="line">  100 </span>    <span class="sym">}
</span><span class="line">  101 </span><span class="sym">}
</span><span class="line">  102 </span><span class="sym">
</span><span class="line">  103 </span><span class="sym"></span><span class="key">class </span><span class="typ">LinkedList </span><span class="key">extends </span>LLEntry
<span class="line">  104 </span><span class="sym">{
</span><span class="line">  105 </span><span class="sym">    </span>LinkedList(<span class="sym">)
</span><span class="line">  106 </span><span class="sym">    {
</span><span class="line">  107 </span><span class="sym">        </span>next = prev = <span class="key">this</span>;
<span class="line">  108 </span>    <span class="sym">}
</span><span class="line">  109 </span><span class="sym">
</span><span class="line">  110 </span><span class="sym">    </span>LinkedList( <span class="typ">LinkedList </span>other <span class="sym">)
</span><span class="line">  111 </span><span class="sym">    {
</span><span class="line">  112 </span><span class="sym">        </span>this(<span class="sym">)</span>;
<span class="line">  113 </span>
<span class="line">  114 </span>        LLEntry last = <span class="key">this</span>;
<span class="line">  115 </span>        for( LLEntry curr = other.next ; curr != other ; curr = curr.next <span class="sym">)
</span><span class="line">  116 </span><span class="sym">        {
</span><span class="line">  117 </span><span class="sym">            </span>LLEntry entry = <span class="key">new </span>LLEntry(curr.val<span class="sym">)</span>;
<span class="line">  118 </span>            last.next = entry;
<span class="line">  119 </span>            entry.prev = last;
<span class="line">  120 </span>            last = entry;
<span class="line">  121 </span>        <span class="sym">}
</span><span class="line">  122 </span><span class="sym">        </span>last.next = <span class="key">this</span>;
<span class="line">  123 </span>        <span class="key">this</span>.prev = last;
<span class="line">  124 </span>
<span class="line">  125 </span>        <span class="key">this</span>.val = other.val;
<span class="line">  126 </span>    <span class="sym">}
</span><span class="line">  127 </span><span class="sym">
</span><span class="line">  128 </span><span class="sym">    </span><span class="key">boolean </span>isEmpty(<span class="sym">)
</span><span class="line">  129 </span><span class="sym">    {
</span><span class="line">  130 </span><span class="sym">        </span><span class="key">return </span>val == <span class="num">0</span>;
<span class="line">  131 </span>    <span class="sym">}
</span><span class="line">  132 </span><span class="sym">
</span><span class="line">  133 </span><span class="sym">    </span><span class="key">void </span>addFirst( LLEntry entry <span class="sym">)
</span><span class="line">  134 </span><span class="sym">    {
</span><span class="line">  135 </span><span class="sym">        </span>entry.prev = <span class="key">this</span>;
<span class="line">  136 </span>        entry.next = <span class="key">this</span>.next;
<span class="line">  137 </span>        <span class="key">this</span>.next.prev = entry;
<span class="line">  138 </span>        <span class="key">this</span>.next = entry;
<span class="line">  139 </span>        <span class="key">this</span>.val++;
<span class="line">  140 </span>    <span class="sym">}
</span><span class="line">  141 </span><span class="sym">
</span><span class="line">  142 </span><span class="sym">    </span><span class="key">void </span>addLast( LLEntry entry <span class="sym">)
</span><span class="line">  143 </span><span class="sym">    {
</span><span class="line">  144 </span><span class="sym">        </span>entry.next = <span class="key">this</span>;
<span class="line">  145 </span>        entry.prev = <span class="key">this</span>.prev;
<span class="line">  146 </span>        <span class="key">this</span>.prev.next = entry;
<span class="line">  147 </span>        <span class="key">this</span>.prev = entry;
<span class="line">  148 </span>        <span class="key">this</span>.val++;
<span class="line">  149 </span>    <span class="sym">}
</span><span class="line">  150 </span><span class="sym">
</span><span class="line">  151 </span><span class="sym">    </span>LLEntry removeFirst(<span class="sym">)
</span><span class="line">  152 </span><span class="sym">    {
</span><span class="line">  153 </span><span class="sym">        </span>LLEntry entry = <span class="key">this</span>.next;
<span class="line">  154 </span>        <span class="key">if </span><span class="sym">(</span>entry == <span class="key">this</span><span class="sym">)
</span><span class="line">  155 </span><span class="sym">            </span><span class="key">return </span>null;
<span class="line">  156 </span>
<span class="line">  157 </span>        <span class="key">this</span>.val--;
<span class="line">  158 </span>        <span class="key">this</span>.next = entry.next;
<span class="line">  159 </span>        entry.next.prev = <span class="key">this</span>;
<span class="line">  160 </span>        <span class="key">return </span>entry;
<span class="line">  161 </span>    <span class="sym">}
</span><span class="line">  162 </span><span class="sym">
</span><span class="line">  163 </span><span class="sym">    </span>LLEntry removeLast(<span class="sym">)
</span><span class="line">  164 </span><span class="sym">    {
</span><span class="line">  165 </span><span class="sym">        </span>LLEntry entry = <span class="key">this</span>.prev;
<span class="line">  166 </span>        <span class="key">if </span><span class="sym">(</span>entry == <span class="key">this</span><span class="sym">)
</span><span class="line">  167 </span><span class="sym">            </span><span class="key">return </span>null;
<span class="line">  168 </span>
<span class="line">  169 </span>        <span class="key">this</span>.val--;
<span class="line">  170 </span>        <span class="key">this</span>.prev = entry.prev;
<span class="line">  171 </span>        entry.prev.next = <span class="key">this</span>;
<span class="line">  172 </span>        <span class="key">return </span>entry;
<span class="line">  173 </span>    <span class="sym">}
</span><span class="line">  174 </span><span class="sym">
</span><span class="line">  175 </span><span class="sym">    </span>LLEntry getFirst(<span class="sym">)
</span><span class="line">  176 </span><span class="sym">    {
</span><span class="line">  177 </span><span class="sym">        </span><span class="key">return this</span>.next;
<span class="line">  178 </span>    <span class="sym">}
</span><span class="line">  179 </span><span class="sym">
</span><span class="line">  180 </span><span class="sym">    </span><span class="key">int </span>size(<span class="sym">)
</span><span class="line">  181 </span><span class="sym">    {
</span><span class="line">  182 </span><span class="sym"></span><span class="com">// Simple sanity checking code:
</span><span class="line">  183 </span><span class="com"></span><span class="com">//        int n = 0;
</span><span class="line">  184 </span><span class="com"></span><span class="com">//        for( LLEntry curr = this.next; curr != this ; curr = curr.next)
</span><span class="line">  185 </span><span class="com"></span><span class="com">//        {
</span><span class="line">  186 </span><span class="com"></span><span class="com">//            n++;
</span><span class="line">  187 </span><span class="com"></span><span class="com">//        }
</span><span class="line">  188 </span><span class="com"></span><span class="com">//        if (n != this.val)
</span><span class="line">  189 </span><span class="com"></span><span class="com">//            throw new Error(&quot;size mismatch&quot;);
</span><span class="line">  190 </span><span class="com"></span>
<span class="line">  191 </span>        <span class="key">return this</span>.val;
<span class="line">  192 </span>    <span class="sym">}
</span><span class="line">  193 </span><span class="sym">
</span><span class="line">  194 </span><span class="sym">    </span><span class="key">boolean </span>equals(LinkedList other<span class="sym">)
</span><span class="line">  195 </span><span class="sym">    {
</span><span class="line">  196 </span><span class="sym">        </span>LLEntry myItem = <span class="key">this</span>;
<span class="line">  197 </span>        LLEntry theirItem = other;
<span class="line">  198 </span>        <span class="key">do
</span><span class="line">  199 </span><span class="key">        </span><span class="sym">{
</span><span class="line">  200 </span><span class="sym">            </span><span class="key">if </span><span class="sym">(</span>myItem.val != theirItem.val<span class="sym">)
</span><span class="line">  201 </span><span class="sym">                </span><span class="key">return </span>false;
<span class="line">  202 </span>            theirItem = theirItem.next;
<span class="line">  203 </span>            myItem = myItem.next;
<span class="line">  204 </span>        <span class="sym">}
</span><span class="line">  205 </span><span class="sym">        </span>while(myItem != <span class="key">this</span><span class="sym">)</span>;
<span class="line">  206 </span>        <span class="key">return </span>true;
<span class="line">  207 </span>    <span class="sym">}
</span><span class="line">  208 </span><span class="sym">}</span>
</pre>
</body>
</html>
<!--HTML generated by highlight 2.0-24, http://www.andre-simon.de/-->
