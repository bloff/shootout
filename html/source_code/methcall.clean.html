<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
	<title>C:\Fulgham\Projects\shootout\bench\methcall\methcall.clean</title>
	<link rel="stylesheet" type="text/css" href="highlight.css">
</head>
<body>
<pre><span class="line">    1 </span>/* The Great Computer Language Shootout  
<span class="line">    2 </span>   contributed by Isaac Gouy (Clean novice) 
<span class="line">    3 </span> 
<span class="line">    4 </span>   http://shootout.alioth.debian.org/ 
<span class="line">    5 </span>    
<span class="line">    6 </span>   Clean is a functional programming language,  
<span class="line">    7 </span>   so there isn<span class="str">'t language support for inheritance. 
</span><span class="line">    8 </span><span class="str">   Existential type variable have some vague similarity 
</span><span class="line">    9 </span><span class="str">   so NToggle delegates function calls to Toggle. 
</span><span class="line">   10 </span><span class="str"> 
</span><span class="line">   11 </span><span class="str">To compile:     
</span><span class="line">   12 </span><span class="str">   cleanIDE.exe --batch-force-build &quot;e:\shoot\contrib\clean\methcall.prj&quot; 
</span><span class="line">   13 </span><span class="str"> 
</span><span class="line">   14 </span><span class="str">To run: 
</span><span class="line">   15 </span><span class="str">   methcall.exe -con 1000000 
</span><span class="line">   16 </span><span class="str">*/ 
</span><span class="line">   17 </span><span class="str"> 
</span><span class="line">   18 </span><span class="str"> 
</span><span class="line">   19 </span><span class="str">module methcall 
</span><span class="line">   20 </span><span class="str"> 
</span><span class="line">   21 </span><span class="str">import StdEnv, ArgEnv, LanguageShootout 
</span><span class="line">   22 </span><span class="str"> 
</span><span class="line">   23 </span><span class="str">Start 
</span><span class="line">   24 </span><span class="str">    # toggle = makeToggle True 
</span><span class="line">   25 </span><span class="str">    # toggleValue = loop n toggle False 
</span><span class="line">   26 </span><span class="str">    # ntoggle = makeNToggle True 3 
</span><span class="line">   27 </span><span class="str">    # ntoggleValue = loop n ntoggle False     
</span><span class="line">   28 </span><span class="str">    = toLString toggleValue +++ &quot;\n&quot; +++  
</span><span class="line">   29 </span><span class="str">      toLString ntoggleValue +++ &quot;\n&quot; 
</span><span class="line">   30 </span><span class="str"> 
</span><span class="line">   31 </span><span class="str">    where  
</span><span class="line">   32 </span><span class="str">    n = toInt ( argv.[1] ) 
</span><span class="line">   33 </span><span class="str">    argv = getCommandLine 
</span><span class="line">   34 </span><span class="str">     
</span><span class="line">   35 </span><span class="str">    loop :: !Int !.Toggler !Bool -&gt; Bool 
</span><span class="line">   36 </span><span class="str">    loop n t v 
</span><span class="line">   37 </span><span class="str">        | n == 0 = v 
</span><span class="line">   38 </span><span class="str">        # t = activate t 
</span><span class="line">   39 </span><span class="str">        # v = value t 
</span><span class="line">   40 </span><span class="str">        = loop (n-1) t v 
</span><span class="line">   41 </span><span class="str">         
</span><span class="line">   42 </span><span class="str">    toLString b 
</span><span class="line">   43 </span><span class="str">        | b = &quot;true&quot; 
</span><span class="line">   44 </span><span class="str">            = &quot;false&quot; 
</span><span class="line">   45 </span><span class="str"> 
</span><span class="line">   46 </span><span class="str"> 
</span><span class="line">   47 </span><span class="str">:: Toggler = E.a: { state :: a 
</span><span class="line">   48 </span><span class="str">                  , activate_ :: a -&gt; a 
</span><span class="line">   49 </span><span class="str">                  , value_ :: a -&gt; Bool 
</span><span class="line">   50 </span><span class="str">                  } 
</span><span class="line">   51 </span><span class="str">                  
</span><span class="line">   52 </span><span class="str">value o=:{state,value_} = value_ state 
</span><span class="line">   53 </span><span class="str">activate o=:{state,activate_} = {o &amp; state = activate_ state} 
</span><span class="line">   54 </span><span class="str"> 
</span><span class="line">   55 </span><span class="str">makeToggle b = 
</span><span class="line">   56 </span><span class="str">    { state = b 
</span><span class="line">   57 </span><span class="str">     
</span><span class="line">   58 </span><span class="str">    , activate_ = \ state -&gt; not state 
</span><span class="line">   59 </span><span class="str">     
</span><span class="line">   60 </span><span class="str">    , value_ = \ state -&gt; state 
</span><span class="line">   61 </span><span class="str">    } 
</span><span class="line">   62 </span><span class="str"> 
</span><span class="line">   63 </span><span class="str">makeNToggle b max = 
</span><span class="line">   64 </span><span class="str">    { state = (makeToggle(b), max, 0) 
</span><span class="line">   65 </span><span class="str">     
</span><span class="line">   66 </span><span class="str">    , activate_ = \ (t, max, count) -&gt;  
</span><span class="line">   67 </span><span class="str">        if (count+1 &gt;= max) 
</span><span class="line">   68 </span><span class="str">            (activate t, max, 0) (t, max, count+1)     
</span><span class="line">   69 </span><span class="str">             
</span><span class="line">   70 </span><span class="str">    , value_ = \ (t,_,_) -&gt; value t 
</span><span class="line">   71 </span><span class="str">    } </span>
</pre>
</body>
</html>
<!--HTML generated by highlight 2.0-24, http://www.andre-simon.de/-->
