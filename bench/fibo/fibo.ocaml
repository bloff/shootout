(*
 * $Id: fibo.ocaml,v 1.2 2004-10-12 06:10:32 bfulgham Exp $
 * http://shootout.alioth.debian.org/
 *
 * Revised per the Lisp versions, by Dan Weber
 *)

let fib x =
   match x with
   | 0 | 1 -> 1
   | x -> let rec fib' x f0 f1 =
              match x with
              | 0 -> f1
              | x -> fib' (x - 1) f1 (f0 + f1)
          in fib' x 0 1;;

let n = if Array.length Sys.argv > 1 then int_of_string Sys.argv.(1) else 1;;

Printf.printf "%d\n" (fib n)
