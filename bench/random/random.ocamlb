(*
 * $Id: random.ocamlb,v 1.2 2004-06-18 07:02:51 bfulgham Exp $
 * http://www.bagley.org/~doug/shootout/
 * with help from Markus Mottl
 *)

let im = 139968
and ia = 3877
and ic = 29573
and first_last = 42

let n = try int_of_string Sys.argv.(1) with _ -> 1

let rec gen_random max last i =
  let new_last = (last * ia + ic) mod im in
  if i > 1 then gen_random max new_last (i - 1)
  else max *. float_of_int new_last /. float im

let () = Printf.printf "%.9f\n" (gen_random 100.0 first_last n)
