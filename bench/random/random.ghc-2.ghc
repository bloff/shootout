<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"><HTML>
<HEAD>
<!-- hennerik CVSweb $Revision: 1.1 $ -->
<TITLE>shootout/bench/random/random.ghc - view - 1.5</TITLE></HEAD>
<BODY BGCOLOR="#eeeeee">
<table width="100%" border=0 cellspacing=0 cellpadding=1 bgcolor="#9999ee"><tr valign=bottom><td><a href="random.ghc?cvsroot=shootout#rev1.5"><IMG SRC="/icons/back.png" ALT="[BACK]" BORDER="0" WIDTH="20" HEIGHT="22"></a> <b>Return to <A HREF="random.ghc?cvsroot=shootout#rev1.5">random.ghc</A>
 CVS log</b> <IMG SRC="/icons/text.png" ALT="[TXT]" BORDER="0" WIDTH="20" HEIGHT="22"></td><td align=right><IMG SRC="/icons/dir.png" ALT="[DIR]" BORDER="0" WIDTH="20" HEIGHT="22"> <b>Up to  <a href="/cgi-bin/cvsweb.cgi/?cvsroot=shootout#dirlist">[GForge-CVS]</a> / <a href="/cgi-bin/cvsweb.cgi/shootout/?cvsroot=shootout#dirlist">shootout</a> / <a href="/cgi-bin/cvsweb.cgi/shootout/bench/?cvsroot=shootout#dirlist">bench</a> / <a href="/cgi-bin/cvsweb.cgi/shootout/bench/random/?cvsroot=shootout#dirlist">random</a></b></td></tr></table><HR noshade><table width="100%"><tr><td bgcolor="#ffffff">File:  <a href="/cgi-bin/cvsweb.cgi/?cvsroot=shootout#dirlist">[GForge-CVS]</a> / <a href="/cgi-bin/cvsweb.cgi/shootout/?cvsroot=shootout#dirlist">shootout</a> / <a href="/cgi-bin/cvsweb.cgi/shootout/bench/?cvsroot=shootout#dirlist">bench</a> / <a href="/cgi-bin/cvsweb.cgi/shootout/bench/random/?cvsroot=shootout#dirlist">random</a> / <a href="/cgi-bin/cvsweb.cgi/shootout/bench/random/random.ghc?cvsroot=shootout">random.ghc</a>&nbsp;(<A HREF="/cgi-bin/cvsweb.cgi/~checkout~/shootout/bench/random/random.ghc?rev=1.5&amp;cvsroot=shootout" target="cvs_checkout" onClick="window.open('/cgi-bin/cvsweb.cgi/~checkout~/shootout/bench/random/random.ghc?rev=1.5','cvs_checkout','resizeable,scrollbars');"><b>download</b></A>)<BR>
Revision <B>1.5</B>, <i>Sun May 15 08:54:24 2005 UTC</i> (8 months ago) by <i>ekarttun-guest</i>
<BR>Changes since <b>1.4: +2 -1
 lines</b><PRE>
Force rerun (linker errors, which should just go away).
</PRE>
</td></tr></table><HR noshade><PRE>-- $Id: random.ghc-2.ghc,v 1.1 2006-01-14 13:44:04 igouy-guest Exp $
-- <A HREF="http://shootout.alioth.debian.org">http://shootout.alioth.debian.org</A>
--
-- Original by Simon Marlow
-- Heavily modified by Einar Karttunen


import System(getArgs)
import Numeric(showFFloat)

main = do ~[n] &lt;- getArgs
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;putStrLn (showFFloat (Just 9) (randl 100 ((read n)-1) 42) &quot;&quot;)

randl :: Double -&gt; Int -&gt; Int -&gt; Double
randl max n seed = newseed `seq` newrand `seq` 
 &nbsp;if n == 0 then newrand else randl max (n-1) newseed
 &nbsp; &nbsp;where newseed = (seed * ia + ic) `mod` im
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;newrand = (fromIntegral newseed) * (max / fromIntegral im)
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;im = 139968
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ia = 3877
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ic = 29573
</PRE>