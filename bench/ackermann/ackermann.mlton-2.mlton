(* -*- mode: sml -*-
 * The Computer Language Shootout
 * http://shootout.alioth.debian.org/
 * 
 * A fairly concise version by Vesa Karvonen.
 *)

fun ack (m, n) = if 0=m then n+1 else ack (m-1, if 0=n then 1 else ack (m, n-1))

val arg = hd (CommandLine.arguments ()) handle _ => "1"
val res = ack (3, getOpt (Int.fromString arg, 0))
val () = app print ["Ack(3,", arg, "): ", Int.toString res, "\n"]
