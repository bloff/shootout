<table width="100%" border="0" cellpadding="5" cellspacing="0"><tr><td bgcolor="#FFFFFF"><pre>
<I><FONT COLOR="#B22222">%%  Always 10000's times faster to append to the head of
</FONT></I><I><FONT COLOR="#B22222">%%  the list (and then Reverse) rather than traversing
</FONT></I><I><FONT COLOR="#B22222">%%  the entire list in each append before adding to tail.
</FONT></I><I><FONT COLOR="#B22222">%%
</FONT></I><I><FONT COLOR="#B22222">%%  http://shootout.alioth.debian.org/
</FONT></I><I><FONT COLOR="#B22222">%%
</FONT></I><I><FONT COLOR="#B22222">%%  contributed by Isaac Gouy
</FONT></I><I><FONT COLOR="#B22222">%%
</FONT></I><I><FONT COLOR="#B22222">%%  Usage: start from command line with
</FONT></I><I><FONT COLOR="#B22222">%%     ozc -x lists.oz -o lists.oz.exe
</FONT></I><I><FONT COLOR="#B22222">%%     lists.oz.exe 16
</FONT></I>
<B><FONT COLOR="#228B22">functor</FONT></B>
<B><FONT COLOR="#5F9EA0">import</FONT></B> System Application

<B><FONT COLOR="#A020F0">define</FONT></B>
   L1 L2 L3
   
   <B><FONT COLOR="#A020F0">fun</FONT></B> {<B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">MoveLeftRight</FONT></I></B></FONT></B> Li2 Li3}
      <I><FONT COLOR="#B22222">%% list|item requires list to be traversed to end
</FONT></I>      <I><FONT COLOR="#B22222">%% before appending item. item|list always faster.
</FONT></I>      <I><FONT COLOR="#B22222">%% {Reverse item|list} result same as list|item
</FONT></I>      <B><FONT COLOR="#5F9EA0">local</FONT></B> H T <B><FONT COLOR="#A020F0">in</FONT></B> 
	 <B><FONT COLOR="#A020F0">if</FONT></B> Li2 <B><FONT COLOR="#5F9EA0">==</FONT></B> <B><FONT COLOR="#228B22">nil</FONT></B> <B><FONT COLOR="#A020F0">then</FONT></B> Li2<B><FONT COLOR="#5F9EA0">|</FONT></B>[{<B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">Reverse</FONT></I></B></FONT></B> Li3}]
	 <B><FONT COLOR="#A020F0">else</FONT></B>
	    H<B><FONT COLOR="#5F9EA0">|</FONT></B>T <B><FONT COLOR="#5F9EA0">=</FONT></B> Li2               <I><FONT COLOR="#B22222">%% take from left
</FONT></I>	    {<B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">MoveLeftRight</FONT></I></B></FONT></B> T H<B><FONT COLOR="#5F9EA0">|</FONT></B>Li3} <I><FONT COLOR="#B22222">%% append to left, reverse later
</FONT></I>	 <B><FONT COLOR="#A020F0">end</FONT></B>
      <B><FONT COLOR="#A020F0">end</FONT></B>
   <B><FONT COLOR="#A020F0">end</FONT></B>

   <B><FONT COLOR="#A020F0">proc</FONT></B> {<B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">AssignL2L3</FONT></I></B></FONT></B> L}
      <I><FONT COLOR="#B22222">%% Factor out the assignment to allow simple reuse
</FONT></I>      {<B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">Assign</FONT></I></B></FONT></B> L2 {<B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">Nth</FONT></I></B></FONT></B> L 1}}
      {<B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">Assign</FONT></I></B></FONT></B> L3 {<B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">List</FONT></I></B></FONT></B>.last L}}
   <B><FONT COLOR="#A020F0">end</FONT></B>
   
<B><FONT COLOR="#A020F0">in</FONT></B>
   <B><FONT COLOR="#5F9EA0">local</FONT></B> Args N Size <B><FONT COLOR="#A020F0">in</FONT></B>
      [Args] <B><FONT COLOR="#5F9EA0">=</FONT></B> {<B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">Application</FONT></I></B></FONT></B>.getArgs plain}
      N <B><FONT COLOR="#5F9EA0">=</FONT></B> {<B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">String</FONT></I></B></FONT></B>.toInt Args}
      Size <B><FONT COLOR="#5F9EA0">=</FONT></B> 10000
      {<B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">NewCell</FONT></I></B></FONT></B> <B><FONT COLOR="#228B22">nil</FONT></B> L1}{<B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">NewCell</FONT></I></B></FONT></B> <B><FONT COLOR="#228B22">nil</FONT></B> L2}{<B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">NewCell</FONT></I></B></FONT></B> <B><FONT COLOR="#228B22">nil</FONT></B> L3}    
      <B><FONT COLOR="#A020F0">for</FONT></B> I <B><FONT COLOR="#A020F0">in</FONT></B> 1<B><FONT COLOR="#5F9EA0">..</FONT></B>N <B><FONT COLOR="#A020F0">do</FONT></B>
	    <I><FONT COLOR="#B22222">%% Create L1
</FONT></I>	 {<B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">Assign</FONT></I></B></FONT></B> L1 {<B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">List</FONT></I></B></FONT></B>.number 1 Size 1} }
	    <I><FONT COLOR="#B22222">%% Copy L1 to L2
</FONT></I>	 {<B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">Assign</FONT></I></B></FONT></B> L2 {<B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">List</FONT></I></B></FONT></B>.take {<B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">Access</FONT></I></B></FONT></B> L1} Size} }
	 {<B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">Assign</FONT></I></B></FONT></B> L3 <B><FONT COLOR="#228B22">nil</FONT></B>}

	    <I><FONT COLOR="#B22222">%% Move items from L2 to L3
</FONT></I>	 {<B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">AssignL2L3</FONT></I></B></FONT></B> {<B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">MoveLeftRight</FONT></I></B></FONT></B> {<B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">Access</FONT></I></B></FONT></B> L2}{<B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">Access</FONT></I></B></FONT></B> L3} }}
	    <I><FONT COLOR="#B22222">%% Move items from L3 to L2
</FONT></I>	 {<B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">AssignL2L3</FONT></I></B></FONT></B> {<B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">Reverse</FONT></I></B></FONT></B> {<B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">MoveLeftRight</FONT></I></B></FONT></B> {<B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">Reverse</FONT></I></B></FONT></B> {<B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">Access</FONT></I></B></FONT></B> L3}}{<B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">Access</FONT></I></B></FONT></B> L2}} }}
	    <I><FONT COLOR="#B22222">%% Reverse L1
</FONT></I>	 {<B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">Assign</FONT></I></B></FONT></B> L1 {<B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">Reverse</FONT></I></B></FONT></B> {<B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">Access</FONT></I></B></FONT></B> L1}}}
         <B><FONT COLOR="#A020F0">if</FONT></B> {<B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">Not</FONT></I></B></FONT></B> {<B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">Nth</FONT></I></B></FONT></B> {<B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">Access</FONT></I></B></FONT></B> L1} 1} <B><FONT COLOR="#5F9EA0">==</FONT></B> Size andthen {<B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">Access</FONT></I></B></FONT></B> L1} <B><FONT COLOR="#5F9EA0">==</FONT></B> {<B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">Access</FONT></I></B></FONT></B> L2}} <B><FONT COLOR="#A020F0">then</FONT></B>
            {<B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">System</FONT></I></B></FONT></B>.showInfo 'L1 !<B><FONT COLOR="#5F9EA0">=</FONT></B> L2'}
         <B><FONT COLOR="#A020F0">end</FONT></B>
      <B><FONT COLOR="#A020F0">end</FONT></B>
      {<B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">System</FONT></I></B></FONT></B>.showInfo {<B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">Length</FONT></I></B></FONT></B> {<B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">Access</FONT></I></B></FONT></B> L1}}}
   {<B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">Application</FONT></I></B></FONT></B>.exit 0}
   <B><FONT COLOR="#A020F0">end</FONT></B>
<B><FONT COLOR="#A020F0">end</FONT></B></pre></td></tr></table>
