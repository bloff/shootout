<table width="100%" border="0" cellpadding="5" cellspacing="0"><tr><td bgcolor="#FFFFFF"><pre>
<I><FONT COLOR="#B22222">-- $Id: hash2-hugs.code,v 1.2 2004-11-08 08:15:14 bfulgham Exp $
</FONT></I><I><FONT COLOR="#B22222">-- http://shootout.alioth.debian.org
</FONT></I><I><FONT COLOR="#B22222">--
</FONT></I><I><FONT COLOR="#B22222">-- By Bryn Keller
</FONT></I><I><FONT COLOR="#B22222">-- Updated by Greg Buchholz to comply with test intent
</FONT></I><B><FONT COLOR="#A020F0">import</FONT></B> System (getArgs)
<B><FONT COLOR="#A020F0">import</FONT></B> Data.FiniteMap

get fm k = lookupWithDefaultFM fm 0 k
keys = map (\x -&gt; <B><FONT COLOR="#BC8F8F">&quot;foo_&quot;</FONT></B> ++ show x) [0..9999]
hash1 = listToFM $ zip keys [0..9999]
hash2 = listToFM $ zip keys (repeat 0)
update k fm = <B><FONT COLOR="#A020F0">let</FONT></B> x = (get hash1 k + get fm k)
                <B><FONT COLOR="#A020F0">in</FONT></B> x `seq` addToFM fm k x
<I><FONT COLOR="#B22222">--update k fm = addToFM_C (+) fm k (get hash1 k)
</FONT></I>
main = do
 [n] &lt;- getArgs
 <B><FONT COLOR="#A020F0">let</FONT></B> res = foldr update hash2 (concat $ replicate (read n) keys)
 putStrLn $ unwords $ map show [get hash1 <B><FONT COLOR="#BC8F8F">&quot;foo_1&quot;</FONT></B>,
                                get hash1 <B><FONT COLOR="#BC8F8F">&quot;foo_9999&quot;</FONT></B>,
                                get res <B><FONT COLOR="#BC8F8F">&quot;foo_1&quot;</FONT></B>,
                                get res <B><FONT COLOR="#BC8F8F">&quot;foo_9999&quot;</FONT></B>] </pre></td></tr></table>
