<table width="100%" border="0" cellpadding="5" cellspacing="0"><tr><td bgcolor="#FFFFFF"><pre>
<I><FONT COLOR="#B22222">/* The Great Computer Language Shootout 
   http://shootout.alioth.debian.org/
   contributed by Isaac Gouy

   Transliterated from the Java implementation

To compile:	
   nicec --sourcepath=.. -d=. -a heapsort.jar heapsort

To run:
   java -ea -jar heapsort.jar 80000
*/</FONT></I>


<B><FONT COLOR="#A020F0">import</FONT></B> random; <I><FONT COLOR="#B22222">// reuse gen_random &amp; floatFormat 
</FONT></I>               <I><FONT COLOR="#B22222">// &amp; toSinglePositiveInt
</FONT></I>
<B><FONT COLOR="#A020F0">void</FONT></B> main(String[] args){
   let n = toSinglePositiveInt(args);

   let numbers = <B><FONT COLOR="#A020F0">new</FONT></B> <B><FONT COLOR="#A020F0">double</FONT></B>[n+1];
   <B><FONT COLOR="#A020F0">for</FONT></B> (var i = 1; i &lt;= n; i++) numbers[i] = gen_random(1);

   heapsort(n, numbers);

   println(floatFormat(10).format(numbers[n]));
}


<B><FONT COLOR="#A020F0">void</FONT></B> heapsort(<B><FONT COLOR="#A020F0">int</FONT></B> n, <B><FONT COLOR="#A020F0">double</FONT></B>[] ra) {
   <B><FONT COLOR="#A020F0">int</FONT></B> l, j, ir, i;
   <B><FONT COLOR="#A020F0">double</FONT></B> rra;

   <B><FONT COLOR="#A020F0">if</FONT></B> (n &lt; 2) <B><FONT COLOR="#A020F0">return</FONT></B>;
   l = (n &gt;&gt; 1) + 1;
   ir = n;
   <B><FONT COLOR="#A020F0">for</FONT></B> (;;) {
      <B><FONT COLOR="#A020F0">if</FONT></B> (l &gt; 1) rra = ra[--l];
      <B><FONT COLOR="#A020F0">else</FONT></B> {
         rra = ra[ir];
         ra[ir] = ra[1];
         <B><FONT COLOR="#A020F0">if</FONT></B> (--ir == 1) {
            ra[1] = rra;
            <B><FONT COLOR="#A020F0">return</FONT></B>;
         }
      }
      i = l;
      j = l &lt;&lt; 1;
      <B><FONT COLOR="#A020F0">while</FONT></B> (j &lt;= ir) {
         <B><FONT COLOR="#A020F0">if</FONT></B> (j &lt; ir &amp;&amp; ra[j] &lt; ra[j+1]) { ++j; }
         <B><FONT COLOR="#A020F0">if</FONT></B> (rra &lt; ra[j]) {
            ra[i] = ra[j];
            j += (i = j);
         } 
         <B><FONT COLOR="#A020F0">else</FONT></B> j = ir + 1;
      }
      ra[i] = rra;
   }
}</pre></td></tr></table>
