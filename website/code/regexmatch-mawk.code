<span class="slc"># $Id: regexmatch-mawk.code,v 1.5 2006-02-10 07:03:47 bfulgham Exp $</span>
<span class="slc"># http://www.bagley.org/~doug/shootout/</span>

<span class="kwa">BEGIN</span> <span class="sym">{</span>
    n <span class="sym">= (</span><span class="kwb">ARGV</span><span class="sym">[</span><span class="num">1</span><span class="sym">] &lt;</span> <span class="num">1</span><span class="sym">)</span> ? <span class="num">1</span> <span class="sym">:</span> <span class="kwb">ARGV</span><span class="sym">[</span><span class="num">1</span><span class="sym">];</span>
    <span class="kwa">delete</span> <span class="kwb">ARGV</span><span class="sym">;</span>
<span class="sym">}</span>

<span class="sym">{</span> phones<span class="sym">[</span>p<span class="sym">++] =</span> $<span class="num">0</span><span class="sym">; }</span>

<span class="kwa">END</span> <span class="sym">{</span>
    <span class="kwa">for</span> <span class="sym">(</span>i<span class="sym">=</span><span class="num">0</span><span class="sym">;</span> i<span class="sym">&lt;</span>n<span class="sym">;</span> i<span class="sym">++) {</span>
	<span class="kwa">for</span> <span class="sym">(</span>j<span class="sym">=</span><span class="num">0</span><span class="sym">;</span> j<span class="sym">&lt;</span>p<span class="sym">;</span> j<span class="sym">++) {</span>
	    line <span class="sym">=</span> phones<span class="sym">[</span>j<span class="sym">];</span>
	    <span class="kwa">if</span> <span class="sym">(</span><span class="kwa">match</span><span class="sym">(</span>line<span class="sym">, /(</span>^<span class="sym">|[</span>^<span class="num">0</span><span class="sym">-</span><span class="num">9</span><span class="sym">])(</span>\(<span class="sym">[</span><span class="num">0</span><span class="sym">-</span><span class="num">9</span><span class="sym">][</span><span class="num">0</span><span class="sym">-</span><span class="num">9</span><span class="sym">][</span><span class="num">0</span><span class="sym">-</span><span class="num">9</span><span class="sym">]</span>\)<span class="sym">|[</span><span class="num">0</span><span class="sym">-</span><span class="num">9</span><span class="sym">][</span><span class="num">0</span><span class="sym">-</span><span class="num">9</span><span class="sym">][</span><span class="num">0</span><span class="sym">-</span><span class="num">9</span><span class="sym">]) [</span><span class="num">0</span><span class="sym">-</span><span class="num">9</span><span class="sym">][</span><span class="num">0</span><span class="sym">-</span><span class="num">9</span><span class="sym">][</span><span class="num">0</span><span class="sym">-</span><span class="num">9</span><span class="sym">][ -][</span><span class="num">0</span><span class="sym">-</span><span class="num">9</span><span class="sym">][</span><span class="num">0</span><span class="sym">-</span><span class="num">9</span><span class="sym">][</span><span class="num">0</span><span class="sym">-</span><span class="num">9</span><span class="sym">][</span><span class="num">0</span><span class="sym">-</span><span class="num">9</span><span class="sym">](</span>$<span class="sym">|[</span>^<span class="num">0</span><span class="sym">-</span><span class="num">9</span><span class="sym">])/)) {</span>
		m1 <span class="sym">=</span> <span class="kwa">substr</span><span class="sym">(</span>line<span class="sym">,</span> <span class="kwb">RSTART</span><span class="sym">,</span> <span class="kwb">RLENGTH</span><span class="sym">);</span>
		num <span class="sym">=</span> <span class="str">&quot;&quot;</span>
		<span class="kwa">if</span> <span class="sym">(</span><span class="kwa">match</span><span class="sym">(</span>m1<span class="sym">, /[</span><span class="num">0</span><span class="sym">-</span><span class="num">9</span><span class="sym">][</span><span class="num">0</span><span class="sym">-</span><span class="num">9</span><span class="sym">][</span><span class="num">0</span><span class="sym">-</span><span class="num">9</span><span class="sym">] [</span><span class="num">0</span><span class="sym">-</span><span class="num">9</span><span class="sym">][</span><span class="num">0</span><span class="sym">-</span><span class="num">9</span><span class="sym">][</span><span class="num">0</span><span class="sym">-</span><span class="num">9</span><span class="sym">][ -][</span><span class="num">0</span><span class="sym">-</span><span class="num">9</span><span class="sym">][</span><span class="num">0</span><span class="sym">-</span><span class="num">9</span><span class="sym">][</span><span class="num">0</span><span class="sym">-</span><span class="num">9</span><span class="sym">][</span><span class="num">0</span><span class="sym">-</span><span class="num">9</span><span class="sym">]/)) {</span>
		    <span class="kwa">if</span> <span class="sym">(</span><span class="kwa">substr</span><span class="sym">(</span>m1<span class="sym">,</span> <span class="kwb">RSTART</span><span class="sym">-</span><span class="num">1</span><span class="sym">,</span> <span class="num">1</span><span class="sym">) ==</span> <span class="str">&quot;(&quot;</span><span class="sym">) {</span>
			<span class="kwa">break</span><span class="sym">;</span>
		    <span class="sym">}</span>
		    <span class="kwa">if</span> <span class="sym">(</span>x <span class="sym">=</span> <span class="kwa">split</span><span class="sym">(</span><span class="kwa">substr</span><span class="sym">(</span>m1<span class="sym">,</span> <span class="kwb">RSTART</span><span class="sym">,</span> <span class="kwb">RLENGTH</span><span class="sym">),</span> parts<span class="sym">, /[ -]/)) {</span>
			num <span class="sym">=</span> <span class="str">&quot;(&quot;</span> parts<span class="sym">[</span><span class="num">1</span><span class="sym">]</span> <span class="str">&quot;) &quot;</span> parts<span class="sym">[</span><span class="num">2</span><span class="sym">]</span> <span class="str">&quot;-&quot;</span> parts<span class="sym">[</span><span class="num">3</span><span class="sym">];</span>
		    <span class="sym">}</span>
		<span class="sym">}</span> <span class="kwa">else if</span> <span class="sym">(</span><span class="kwa">match</span><span class="sym">(</span>m1<span class="sym">, /</span>\(<span class="sym">[</span><span class="num">0</span><span class="sym">-</span><span class="num">9</span><span class="sym">][</span><span class="num">0</span><span class="sym">-</span><span class="num">9</span><span class="sym">][</span><span class="num">0</span><span class="sym">-</span><span class="num">9</span><span class="sym">]</span>\) <span class="sym">[</span><span class="num">0</span><span class="sym">-</span><span class="num">9</span><span class="sym">][</span><span class="num">0</span><span class="sym">-</span><span class="num">9</span><span class="sym">][</span><span class="num">0</span><span class="sym">-</span><span class="num">9</span><span class="sym">][ -][</span><span class="num">0</span><span class="sym">-</span><span class="num">9</span><span class="sym">][</span><span class="num">0</span><span class="sym">-</span><span class="num">9</span><span class="sym">][</span><span class="num">0</span><span class="sym">-</span><span class="num">9</span><span class="sym">][</span><span class="num">0</span><span class="sym">-</span><span class="num">9</span><span class="sym">]/)) {</span>
		    <span class="kwa">if</span> <span class="sym">(</span>x <span class="sym">=</span> <span class="kwa">split</span><span class="sym">(</span><span class="kwa">substr</span><span class="sym">(</span>m1<span class="sym">,</span> <span class="kwb">RSTART</span><span class="sym">,</span> <span class="kwb">RLENGTH</span><span class="sym">),</span> parts<span class="sym">, /[ -]/)) {</span>
			num <span class="sym">=</span> parts<span class="sym">[</span><span class="num">1</span><span class="sym">]</span> <span class="str">&quot; &quot;</span> parts<span class="sym">[</span><span class="num">2</span><span class="sym">]</span> <span class="str">&quot;-&quot;</span> parts<span class="sym">[</span><span class="num">3</span><span class="sym">];</span>
		    <span class="sym">}</span>
		<span class="sym">}</span>
		<span class="kwa">if</span> <span class="sym">(</span>i <span class="sym">== (</span>n<span class="sym">-</span><span class="num">1</span><span class="sym">)) {</span>
		    count<span class="sym">++;</span>
		    <span class="kwa">printf</span><span class="sym">(</span><span class="str">&quot;</span><span class="esc">%d</span><span class="str">:</span> <span class="esc">%s\n</span><span class="str">&quot;</span><span class="sym">,</span> count<span class="sym">,</span> num<span class="sym">);</span>
		<span class="sym">}</span>
	    <span class="sym">}</span>
	<span class="sym">}</span>
    <span class="sym">}</span>
<span class="sym">}</span>
