<table width="100%" border="0" cellpadding="5" cellspacing="0"><tr><td bgcolor="#FFFFFF"><pre>
<B><FONT COLOR="#A020F0">import</FONT></B> System
<B><FONT COLOR="#A020F0">import</FONT></B> Array
<B><FONT COLOR="#A020F0">import</FONT></B> NHC.IOExtras

main = do n &lt;- getArgs &gt;&gt;= return . (\a-&gt; <B><FONT COLOR="#A020F0">case</FONT></B> a <B><FONT COLOR="#A020F0">of</FONT></B> [num] -&gt; read num; <B><FONT COLOR="#A020F0">_-&gt;1)
 </FONT></B>         <B><FONT COLOR="#A020F0">let</FONT></B> x   = listArray (0,n-1) [1..n]
          y &lt;- newIOArray (0,n-1) 0
          mapM_ (\<B><FONT COLOR="#A020F0">_-&gt; </FONT></B>sequence_ [ updateIOArray y i (x!i) | i &lt;- [n-1,n-2..0] ])
                [1..1000]
          y0 &lt;- readIOArray y 0
          yn &lt;- readIOArray y (n-1)
          putStrLn $ show y0 ++ <B><FONT COLOR="#BC8F8F">&quot; &quot;</FONT></B> ++ show yn

updateIOArray a i val = do x &lt;- readIOArray a i 
                           writeIOArray a i (x+val)

</pre></td></tr></table>
