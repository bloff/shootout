<span class="slc">% The Computer Language Shootout</span>
<span class="slc">% http://shootout.alioth.debian.org/</span>
<span class="slc">% contributed by Isaac Gouy</span>

<span class="kwa">functor</span>
<span class="kwa">import</span>
   System Application
   S <span class="kwb">at</span> <span class="str">'../../Include/oz/shootout.ozf'</span>

<span class="kwb">define</span>
   TwoThirds <span class="sym">=</span> <span class="num">2.0</span><span class="sym">/</span><span class="num">3.0</span>
   <span class="sym">[</span>Arg<span class="sym">] = {</span>Application.getArgs plain<span class="sym">}</span>
   N <span class="sym">= {</span>String.toInt Arg<span class="sym">}</span>

   <span class="kwb">fun</span> <span class="sym">{</span>Sums I A1 A2 A3 A4 A5 A6 A7 A8 A9 Alt<span class="sym">}</span>
      <span class="kwb">if</span> I <span class="sym">=&lt;</span> N <span class="kwb">then</span>
         K K2 K3 SK CK
      <span class="kwb">in</span>
         K <span class="sym">= {</span>IntToFloat I<span class="sym">}</span>
         K2 <span class="sym">=</span> K <span class="sym">*</span> K
         K3 <span class="sym">=</span> K2 <span class="sym">*</span> K
         SK <span class="sym">= {</span>Sin K<span class="sym">}</span>
         CK <span class="sym">= {</span>Cos K<span class="sym">}</span>

         <span class="sym">{</span>Sums
            I<span class="sym">+</span><span class="num">1</span>
            A1 <span class="sym">+ {</span>Pow TwoThirds K<span class="sym">-</span><span class="num">1.0</span><span class="sym">}</span>
            A2 <span class="sym">+</span> <span class="num">1.0</span><span class="sym">/{</span>Sqrt K<span class="sym">}</span>
            A3 <span class="sym">+</span> <span class="num">1.0</span><span class="sym">/(</span>K<span class="sym">*(</span>K<span class="sym">+</span><span class="num">1.0</span><span class="sym">))</span>
            A4 <span class="sym">+</span> <span class="num">1.0</span><span class="sym">/(</span>K3<span class="sym">*(</span>SK<span class="sym">*</span>SK<span class="sym">))</span>
            A5 <span class="sym">+</span> <span class="num">1.0</span><span class="sym">/(</span>K3<span class="sym">*(</span>CK<span class="sym">*</span>CK<span class="sym">))</span>
            A6 <span class="sym">+</span> <span class="num">1.0</span><span class="sym">/</span>K
            A7 <span class="sym">+</span> <span class="num">1.0</span><span class="sym">/</span>K2
            A8 <span class="sym">+</span> Alt<span class="sym">/</span>K
            A9 <span class="sym">+</span> Alt<span class="sym">/(</span><span class="num">2.0</span><span class="sym">*</span>K <span class="sym">-</span> <span class="num">1.0</span><span class="sym">)</span>
            ~Alt <span class="sym">}</span>
      <span class="kwb">else</span>
         A1 # A2 # A3 # A4 # A5 # A6 # A7 # A8 # A9
      <span class="kwb">end</span>
   <span class="kwb">end</span>

   A <span class="sym">= {</span>Sums <span class="num">1 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 1.0</span> <span class="sym">}</span>
<span class="kwb">in</span>
   <span class="sym">{</span>System.showInfo <span class="sym">{</span>S.floatToString A<span class="num">.1 9</span><span class="sym">}</span>#<span class="str">&quot;</span><span class="esc">\t</span><span class="str">(2/3)^k&quot;</span><span class="sym">}</span>
   <span class="sym">{</span>System.showInfo <span class="sym">{</span>S.floatToString A<span class="num">.2 9</span><span class="sym">}</span>#<span class="str">&quot;</span><span class="esc">\t</span><span class="str">k^-0.5&quot;</span><span class="sym">}</span>
   <span class="sym">{</span>System.showInfo <span class="sym">{</span>S.floatToString A<span class="num">.3 9</span><span class="sym">}</span>#<span class="str">&quot;</span><span class="esc">\t</span><span class="str">1/k(k+1)&quot;</span><span class="sym">}</span>
   <span class="sym">{</span>System.showInfo <span class="sym">{</span>S.floatToString A<span class="num">.4 9</span><span class="sym">}</span>#<span class="str">&quot;</span><span class="esc">\t</span><span class="str">Flint Hills&quot;</span><span class="sym">}</span>
   <span class="sym">{</span>System.showInfo <span class="sym">{</span>S.floatToString A<span class="num">.5 9</span><span class="sym">}</span>#<span class="str">&quot;</span><span class="esc">\t</span><span class="str">Cookson Hills&quot;</span><span class="sym">}</span>
   <span class="sym">{</span>System.showInfo <span class="sym">{</span>S.floatToString A<span class="num">.6 9</span><span class="sym">}</span>#<span class="str">&quot;</span><span class="esc">\t</span><span class="str">Harmonic&quot;</span><span class="sym">}</span>
   <span class="sym">{</span>System.showInfo <span class="sym">{</span>S.floatToString A<span class="num">.7 9</span><span class="sym">}</span>#<span class="str">&quot;</span><span class="esc">\t</span><span class="str">Riemann Zeta&quot;</span><span class="sym">}</span>
   <span class="sym">{</span>System.showInfo <span class="sym">{</span>S.floatToString A<span class="num">.8 9</span><span class="sym">}</span>#<span class="str">&quot;</span><span class="esc">\t</span><span class="str">Alternating Harmonic&quot;</span><span class="sym">}</span>
   <span class="sym">{</span>System.showInfo <span class="sym">{</span>S.floatToString A<span class="num">.9 9</span><span class="sym">}</span>#<span class="str">&quot;</span><span class="esc">\t</span><span class="str">Gregory&quot;</span><span class="sym">}</span>
   <span class="sym">{</span>Application.exit <span class="num">0</span><span class="sym">}</span>
<span class="kwb">end</span>
