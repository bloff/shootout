<table width="100%" border="0" cellpadding="5" cellspacing="0"><tr><td bgcolor="#FFFFFF"><pre>
main = getContents &gt;&gt;= putStrLn . showC . foldl' wc (C 0 0 0 False)

foldl' f a []     = a
foldl' f a (x:xs) = <B><FONT COLOR="#A020F0">let</FONT></B> a' = f a x <B><FONT COLOR="#A020F0">in</FONT></B> a' `seq` foldl' f a' xs

<B><FONT COLOR="#A020F0">data</FONT></B> C = C !Int !Int !Int !Bool
<I><FONT COLOR="#B22222">--         Line Word Char InWord
</FONT></I>showC (C l w c <B><FONT COLOR="#A020F0">_) </FONT></B>= show l ++ <B><FONT COLOR="#BC8F8F">&quot; &quot;</FONT></B> ++ show w ++ <B><FONT COLOR="#BC8F8F">&quot; &quot;</FONT></B> ++ show c

wc <B><FONT COLOR="#228B22">:: C  -&gt; Char -&gt; C
</FONT></B>wc (C l w c <B><FONT COLOR="#A020F0">_) </FONT></B>    '\n' = C (l+1) w     (c+1) False
wc (C l w c <B><FONT COLOR="#A020F0">_) </FONT></B>    <B><FONT COLOR="#BC8F8F">' '</FONT></B>  = C l     w     (c+1) False
wc (C l w c <B><FONT COLOR="#A020F0">_) </FONT></B>    '\t' = C l     w     (c+1) False
wc (C l w c False) <B><FONT COLOR="#A020F0">_ </FONT></B>   = C l     (w+1) (c+1) True
wc (C l w c True)  <B><FONT COLOR="#A020F0">_ </FONT></B>   = C l     w     (c+1) True
</pre></td></tr></table>
