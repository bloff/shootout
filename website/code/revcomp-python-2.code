<span class="slc">#!/usr/bin/python
</span><span class="slc"># The Great Computer Language Shootout
</span><span class="slc"># http://shootout.alioth.debian.org/
</span><span class="slc">#
</span><span class="slc"># Contributed by Bradford Powell
</span>
<span class="kwc">import</span> sys
<span class="kwc">import</span> string

revtable <span class="sym">=</span> string<span class="sym">.</span>maketrans<span class="sym">(</span><span class="str">'wsatugcyrkmbdhvnATUGCYRKMBDHVN'</span><span class="sym">,
</span><span class="str">'WSTAACGRYMKVHDBNTAACGRYMKVHDBN'</span><span class="sym">)

</span><span class="kwb">def</span> revcomp<span class="sym">(</span>s<span class="sym">):
</span>	<span class="kwb">return</span> s<span class="sym">[::-</span><span class="num">1</span><span class="sym">].</span>translate<span class="sym">(</span>revtable<span class="sym">)

</span><span class="kwb">def</span> printseq<span class="sym">(</span>desc<span class="sym">,</span> s<span class="sym">,</span> linewidth <span class="sym">=</span> <span class="num">60</span><span class="sym">):
</span>	<span class="kwb">print</span> desc<span class="sym">,
</span>	<span class="kwb">for</span> i <span class="kwb">in</span> <span class="kwa">range</span><span class="sym">(</span><span class="num">0</span><span class="sym">,</span> <span class="kwa">len</span><span class="sym">(</span>s<span class="sym">),</span> linewidth<span class="sym">):
</span>		<span class="kwb">print</span> s<span class="sym">[</span>i<span class="sym">:</span>i<span class="sym">+</span>linewidth<span class="sym">]

</span>desc <span class="sym">=</span> <span class="str">''</span>
s <span class="sym">= []
</span><span class="kwb">for</span> line <span class="kwb">in</span> sys<span class="sym">.</span>stdin<span class="sym">:
</span>	<span class="kwb">if</span> line<span class="sym">.</span>startswith<span class="sym">(</span><span class="str">'&gt;'</span><span class="sym">):
</span>		<span class="kwb">if</span> desc<span class="sym">:
</span>			printseq<span class="sym">(</span>desc<span class="sym">,</span> revcomp<span class="sym">(</span><span class="str">''</span><span class="sym">.</span>join<span class="sym">(</span>s<span class="sym">)))
</span>			s <span class="sym">= []
</span>		desc <span class="sym">=</span> line
	<span class="kwb">else</span><span class="sym">:
</span>		s <span class="sym">+=</span> line<span class="sym">.</span>strip<span class="sym">()
</span><span class="kwb">if</span> desc<span class="sym">:
</span>	printseq<span class="sym">(</span>desc<span class="sym">,</span> revcomp<span class="sym">(</span><span class="str">''</span><span class="sym">.</span>join<span class="sym">(</span>s<span class="sym">)))</span>
