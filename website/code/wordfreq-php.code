<table width="100%" border="0" cellpadding="5" cellspacing="0"><tr><td bgcolor="#FFFFFF"><pre>
<I><FONT COLOR="#B22222">#!/usr/bin/php -f
</FONT></I>&lt;?
/* The Great Computer Language Shootout
   http://shootout.alioth.debian.org/
   contributed by Isaac Gouy 

   php -<B><FONT COLOR="#A020F0">q</FONT></B> wordfreq.php &lt; input.txt &gt; output.txt
*/ 


$hasSplitWord = FALSE;

$fp = fopen(<B><FONT COLOR="#BC8F8F">&quot;php://stdin&quot;</FONT></B>, <B><FONT COLOR="#BC8F8F">&quot;r&quot;</FONT></B>);

<B><FONT COLOR="#A020F0">while</FONT></B> ($block = fread($fp, 4096)){

   $words = preg_split(<B><FONT COLOR="#BC8F8F">'/[^a-zA-Z]+/'</FONT></B>, $block);

   $first = 0;
   $last = sizeof($words) - 1;

   <B><FONT COLOR="#A020F0">if</FONT></B> ($last &gt;= $first){
      
      // some words will be split across $block's      

      <B><FONT COLOR="#A020F0">if</FONT></B> (strlen($words[$first])){          
         <B><FONT COLOR="#A020F0">if</FONT></B> ($hasSplitWord){ $words[$first] = $splitWord.$words[$first]; }
      } <B><FONT COLOR="#A020F0">else</FONT></B> {
         <B><FONT COLOR="#A020F0">if</FONT></B> ($hasSplitWord){ $words[$first] = $splitWord; } 
         <B><FONT COLOR="#A020F0">else</FONT></B> { $first++; }      
      }
      <B><FONT COLOR="#A020F0">if</FONT></B> ($hasSplitWord = strlen($words[$last])){
         $splitWord = $words[$last]; 
      }


      <B><FONT COLOR="#A020F0">for</FONT></B> ($i=$first; $i&lt;$last; $i++){
         $w = strtolower($words[$i]);
         <B><FONT COLOR="#A020F0">if</FONT></B> (isset($counts[$w])){ $counts[$w]++; } <B><FONT COLOR="#A020F0">else</FONT></B> { $counts[$w] = 1; }
      }
   }
   unset($words);
} 
fclose($fp);



function CmpCountAndName($a, $b){
   <B><FONT COLOR="#A020F0">if</FONT></B> ($a[1] == $b[1]){ <B><FONT COLOR="#A020F0">return</FONT></B> strcmp($b[0], $a[0]); }
   <B><FONT COLOR="#A020F0">else</FONT></B> { <B><FONT COLOR="#A020F0">return</FONT></B> $a[1] &lt; $b[1]; }
}

<B><FONT COLOR="#A020F0">while</FONT></B> (list($k,$v) = <B><FONT COLOR="#A020F0">each</FONT></B>($counts)) $wordcounts[] = array($k,$v);
usort($wordcounts,<B><FONT COLOR="#BC8F8F">'CmpCountAndName'</FONT></B>);
<B><FONT COLOR="#A020F0">while</FONT></B> (list($k,$v) = <B><FONT COLOR="#A020F0">each</FONT></B>($wordcounts)) <B><FONT COLOR="#A020F0">printf</FONT></B>(<B><FONT COLOR="#BC8F8F">&quot;%7d %s\n&quot;</FONT></B>, $v[1], $v[0]);

?&gt;</pre></td></tr></table>
