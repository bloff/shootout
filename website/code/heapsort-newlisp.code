<table width="100%" border="0" cellpadding="5" cellspacing="0"><tr><td bgcolor="#FFFFFF"><pre>
#!/usr/bin/newlisp

# heapsort - benchmark
#
# note, that newLISP has fast built-in sort <B><FONT COLOR="#A020F0">and</FONT></B> random algorithms
# not used in this - same way - benchmark
#

(set 'IM 139968)
(set 'IA 3877)
(set 'IC 29573)

(set 'LAST 42)

(<B><FONT COLOR="#A020F0">define</FONT></B> (<B><FONT COLOR="#0000FF">gen_random</FONT></B> maximum)
	(set 'LAST (mod (add (mul LAST IA) IC) IM))
	(div (mul maximum LAST) IM))

(<B><FONT COLOR="#A020F0">define</FONT></B> (<B><FONT COLOR="#0000FF">heapsort</FONT></B> n ra)
	(set 'rra 0 'i 0 'j 0)
	(set 'l (+ (&gt;&gt; n 1) 1))
	(set 'ir n)

	(while (not done)
		(<B><FONT COLOR="#A020F0">if</FONT></B> (&gt; l 1) 
			(<B><FONT COLOR="#A020F0">begin</FONT></B>
				(dec 'l)
				(set 'rra (nth l ra)))
			(<B><FONT COLOR="#A020F0">begin</FONT></B>
				(set 'rra (nth ir ra))
				(nth-set ir ra (nth 1 ra))
				(dec 'ir)
				(<B><FONT COLOR="#A020F0">if</FONT></B> (= ir 1)
					(<B><FONT COLOR="#A020F0">begin</FONT></B>
						(nth-set 1 ra rra)
						(set 'done true)
						<I><FONT COLOR="#B22222">; return
</FONT></I>						ra))))
		(set 'i l)
		(set 'j (&lt;&lt; l 1))
		(<B><FONT COLOR="#A020F0">if</FONT></B> (not done) (<B><FONT COLOR="#A020F0">begin</FONT></B> 
			(while (&lt;= j ir)
				(<B><FONT COLOR="#A020F0">if</FONT></B> (<B><FONT COLOR="#A020F0">and</FONT></B> (&lt; j ir) (&lt; (nth j ra) (nth (+ j 1) ra)))
					(inc ' j))
				(<B><FONT COLOR="#A020F0">if</FONT></B> (&lt; rra (nth j ra))
					(<B><FONT COLOR="#A020F0">begin</FONT></B>
						(nth-set i ra (nth j ra))
						(set 'i j)
						(inc 'j i))
					(set 'j (+ ir 1))))
			(nth-set i ra rra))
		) ra))

(<B><FONT COLOR="#A020F0">define</FONT></B> (<B><FONT COLOR="#0000FF">main</FONT></B>)
	(set 'N (integer (last (main-args))))

	(set 'ary (array (+ N 1)))

	(for (i 1 N) (nth-set i ary (gen_random 1.0)))

	(set 'ary (heapsort N ary))

	(println (format <B><FONT COLOR="#BC8F8F">&quot;%.10f&quot;</FONT></B> (nth N ary)))
)

(main)
(exit)

<I><FONT COLOR="#B22222">;; eof
</FONT></I>
			
		
			
			</pre></td></tr></table>
