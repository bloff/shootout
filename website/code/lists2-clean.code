<table width="100%" border="0" cellpadding="5" cellspacing="0"><tr><td bgcolor="#FFFFFF"><pre>
/* The Great Computer Language Shootout 
   contributed by Isaac Gouy (Clean novice)

   http://shootout.alioth.debian.org/

To compile:	
   cleanIDE.exe <I><FONT COLOR="#B22222">--batch-force-build &quot;e:\shoot\contrib\clean\lists2.prj&quot;
</FONT></I>
To run:
   lists2.exe -con 16
*/


<B><FONT COLOR="#A020F0">module</FONT></B> lists2
<B><FONT COLOR="#A020F0">import</FONT></B> StdEnv, LanguageShootout, StdOverloadedList

Start = toString (iter argi lists 10000) +++ <B><FONT COLOR="#BC8F8F">&quot;\n&quot;</FONT></B>

lists n
   #! l1 = [#1..n!]
   #! l2 = [# x \\ x &lt;|- l1 !]
   #! l3 = [#!]
   #! (l2,l3) = mv l2 (Reverse l3)
   #! (l3,l2) = mv (Reverse l3) (Reverse l2)
   #! l1 = Reverse l1
   = <B><FONT COLOR="#A020F0">if</FONT></B> (((Hd l1) == n) &amp;&amp; (l1 == l2)) (Length l1) -1
      
   <B><FONT COLOR="#A020F0">where</FONT></B>
   mv a=:[|] b = (a,Reverse b)
   mv [|h:t] b = mv t [#h:b!]
   </pre></td></tr></table>
