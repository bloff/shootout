<span class="slc">#!/usr/bin/ruby
</span><span class="slc"># The Great Computer Language Shootout
</span><span class="slc"># http://shootout.alioth.debian.org/
</span><span class="slc">#
</span><span class="slc"># Contributed by Peter Bjarke Olsen
</span>revseq=<span class="str">&quot;&quot;</span>
seq=<span class="str">&quot;&quot;</span>

<span class="kwa">def</span> revcomp<span class="sym">(</span>seq<span class="sym">)
</span>  revseq=seq.reverse
  revseq=revseq.upcase
  revseq=revseq.tr<span class="sym">(</span><span class="str">'ACGTUMRWSYKVHDBXN'</span><span class="sym">,</span><span class="str">'TGCAAKYWSRMBDHVXN'</span><span class="sym">)
</span>  stringlen=revseq.length
  <span class="num">0</span>.step<span class="sym">(</span>stringlen-1<span class="sym">,</span><span class="num">60</span><span class="sym">) {|</span>x<span class="sym">|</span> print revseq.slice<span class="sym">(</span>x<span class="sym">,</span><span class="num">60</span><span class="sym">) ,</span> <span class="str">&quot;\n&quot;</span><span class="sym">}
</span><span class="kwa">end

while</span> gets
  <span class="kwa">if</span> <span class="sym">/&gt;/
</span>    <span class="kwa">if</span> seq <span class="sym">!</span>= <span class="str">''</span>
      revseq=revcomp<span class="sym">(</span>seq<span class="sym">)
</span>      seq=<span class="str">&quot;&quot;</span>
    <span class="kwa">end
</span>    puts $_
  <span class="kwa">else
</span>    sub<span class="sym">(/</span>\n<span class="sym">/,</span><span class="str">''</span><span class="sym">)
</span>    seq=seq <span class="sym">+</span> $_
  <span class="kwa">end
end
</span>revseq=revcomp<span class="sym">(</span>seq<span class="sym">)</span>
