<span class="com">{-# OPTIONS -fglasgow-exts -fbang-patterns #-}</span>
<span class="slc">--</span>
<span class="slc">-- The Computer Language Shootout</span>
<span class="slc">-- http://shootout.alioth.debian.org/</span>
<span class="slc">--</span>
<span class="slc">-- Contributed by Vasile Gaburici</span>
<span class="slc">--</span>
<span class="slc">-- Real line-oriented I/O</span>
<span class="slc">--</span>

<span class="kwa">import</span> Data.List
<span class="kwa">import qualified</span> Data.ByteString.Char8 <span class="kwa">as</span> C8
<span class="kwa">import</span> System.IO.Error <span class="kwa">as</span> Err

maybeGetLine <span class="sym">::</span> IO <span class="sym">(</span>Maybe C8.ByteString<span class="sym">)</span>
maybeGetLine <span class="sym">=</span>  Err.catch <span class="sym">(</span><span class="kwa">do</span> line <span class="sym">&lt;-</span> C8.getLine
                              return $ Just line<span class="sym">) (</span>\e <span class="sym">-&gt;</span> return Nothing<span class="sym">)</span>

addLine <span class="sym">::</span> <span class="kwb">Int</span> <span class="sym">-&gt;</span> IO <span class="sym">()</span>
addLine the_sum <span class="sym">=</span> <span class="kwa">do</span> maybe_line <span class="sym">&lt;-</span> maybeGetLine
                     <span class="kwa">case</span> maybe_line <span class="kwa">of</span>
                       Nothing   <span class="sym">-&gt;</span> putStrLn $ show the_sum
                       Just line <span class="sym">-&gt;</span> <span class="kwa">do</span>
                         <span class="kwa">let</span> Just<span class="sym">(</span>num<span class="sym">,</span> _<span class="sym">) =</span> C8.readInt line
                         addLine $<span class="sym">!</span> num <span class="sym">+</span> the_sum

main <span class="sym">=</span> addLine <span class="num">0</span>
