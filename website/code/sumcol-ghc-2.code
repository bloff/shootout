<span class="com">{-# OPTIONS -O2 #-}</span>
<span class="slc">--</span>
<span class="slc">-- The Computer Language Shootout</span>
<span class="slc">-- http://shootout.alioth.debian.org/</span>
<span class="slc">--</span>
<span class="slc">-- contributed by: Ian Henderson</span>
<span class="slc">-- compile with: ghc -O2 -o sum-file sum-file.hs</span>
<span class="slc">--</span>

<span class="kwa">import qualified</span> Data.ByteString.Char8 <span class="kwa">as</span> B
<span class="kwa">import</span> Data.<span class="kwb">Char</span>

main <span class="sym">=</span> print . sum . map parseInt . B.lines <span class="sym">=&lt;&lt;</span> B.getContents

parseInt bs <span class="sym">=</span> <span class="kwa">case</span> B.head bs <span class="kwa">of</span> '<span class="sym">-</span>' <span class="sym">-&gt; -</span>parseNat <span class="sym">(</span>B.tail bs<span class="sym">)</span>
                                _   <span class="sym">-&gt;</span>  parseNat bs

parseNat <span class="sym">=</span> B.foldl' <span class="sym">(</span>\n c <span class="sym">-&gt;</span> n <span class="sym">*</span> <span class="num">10</span> <span class="sym">+</span> ord c <span class="sym">-</span> ord '<span class="num">0</span>'<span class="sym">)</span> <span class="num">0</span>
