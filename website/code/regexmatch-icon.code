<table width="100%" border="0" cellpadding="5" cellspacing="0"><tr><td bgcolor="#FFFFFF"><pre>
<I><FONT COLOR="#B22222"># -*- mode: icon -*-
</FONT></I><I><FONT COLOR="#B22222"># $Id: regexmatch-icon.code,v 1.2 2004-11-08 08:15:19 bfulgham Exp $
</FONT></I><I><FONT COLOR="#B22222"># http://www.bagley.org/~doug/shootout/
</FONT></I><I><FONT COLOR="#B22222"># from Cheyenne Wills
</FONT></I>
<B><FONT COLOR="#A020F0">procedure </FONT></B><B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">main</FONT></I></B></FONT></B>(argv)
    n <B><FONT COLOR="#5F9EA0">:=</FONT></B> \argv[1] <B><FONT COLOR="#5F9EA0">|</FONT></B> 1

    lines <B><FONT COLOR="#5F9EA0">:=</FONT></B> []
    <B><FONT COLOR="#A020F0">while</FONT></B> <B><FONT COLOR="#A020F0">put</FONT></B>(lines,<B><FONT COLOR="#A020F0">read</FONT></B>())

    counter <B><FONT COLOR="#5F9EA0">:=</FONT></B> 0

    start <B><FONT COLOR="#5F9EA0">:=</FONT></B> <B><FONT COLOR="#BC8F8F">'('</FONT></B> <B><FONT COLOR="#5F9EA0">+</FONT></B><B><FONT COLOR="#5F9EA0">+</FONT></B> &amp;digits        <I><FONT COLOR="#B22222"># Define what starts a phone number
</FONT></I>
    <B><FONT COLOR="#A020F0">every</FONT></B> i <B><FONT COLOR="#5F9EA0">:=</FONT></B> 1 <B><FONT COLOR="#A020F0">to</FONT></B> n <B><FONT COLOR="#A020F0">do</FONT></B> {
        <B><FONT COLOR="#A020F0">every</FONT></B> line <B><FONT COLOR="#5F9EA0">:=</FONT></B> <B><FONT COLOR="#5F9EA0">!</FONT></B>lines <B><FONT COLOR="#A020F0">do</FONT></B> {
            line ? {
                <B><FONT COLOR="#A020F0">tab</FONT></B>(<B><FONT COLOR="#A020F0">upto</FONT></B>(start))   <I><FONT COLOR="#B22222"># Find a possible start...
</FONT></I>                    (

                     <I><FONT COLOR="#B22222">## Areacode
</FONT></I>                     (( <B><FONT COLOR="#5F9EA0">=</FONT></B><B><FONT COLOR="#BC8F8F">&quot;(&quot;</FONT></B> &amp; <B><FONT COLOR="#228B22">integer</FONT></B>(areacode <B><FONT COLOR="#5F9EA0">:=</FONT></B> <B><FONT COLOR="#A020F0">move</FONT></B>(3)) &amp; <B><FONT COLOR="#5F9EA0">=</FONT></B><B><FONT COLOR="#BC8F8F">&quot;)&quot;</FONT></B> ) <B><FONT COLOR="#5F9EA0">|</FONT></B>
                      (        <B><FONT COLOR="#228B22">integer</FONT></B>(areacode <B><FONT COLOR="#5F9EA0">:=</FONT></B> <B><FONT COLOR="#A020F0">move</FONT></B>(3)) )) &amp;
                     <B><FONT COLOR="#5F9EA0">=</FONT></B><B><FONT COLOR="#BC8F8F">&quot; &quot;</FONT></B> &amp;                         <I><FONT COLOR="#B22222"># followed by a space
</FONT></I>                     <I><FONT COLOR="#B22222">## Exchange
</FONT></I>                     <B><FONT COLOR="#228B22">integer</FONT></B>(exchange <B><FONT COLOR="#5F9EA0">:=</FONT></B> <B><FONT COLOR="#A020F0">move</FONT></B>(3)) &amp; <I><FONT COLOR="#B22222"># followed by 3 digits
</FONT></I>                     <B><FONT COLOR="#5F9EA0">=</FONT></B>(<B><FONT COLOR="#BC8F8F">&quot; &quot;</FONT></B> <B><FONT COLOR="#5F9EA0">|</FONT></B> <B><FONT COLOR="#BC8F8F">&quot;-&quot;</FONT></B>) &amp;                 <I><FONT COLOR="#B22222"># followed by space or dash
</FONT></I>                     <I><FONT COLOR="#B22222">## Number
</FONT></I>                     <B><FONT COLOR="#228B22">integer</FONT></B>(num <B><FONT COLOR="#5F9EA0">:=</FONT></B> <B><FONT COLOR="#A020F0">move</FONT></B>(4)) &amp;      <I><FONT COLOR="#B22222"># followed by 4 digits
</FONT></I>
                     ( <B><FONT COLOR="#5F9EA0">not</FONT></B> <B><FONT COLOR="#A020F0">any</FONT></B>(&amp;digits) <B><FONT COLOR="#5F9EA0">|</FONT></B> <B><FONT COLOR="#A020F0">pos</FONT></B>(0))   <I><FONT COLOR="#B22222"># followed by any non digit
</FONT></I>                                                    <I><FONT COLOR="#B22222"># or end of line
</FONT></I>                     ) &amp;
                         <B><FONT COLOR="#A020F0">if</FONT></B> i <B><FONT COLOR="#5F9EA0">=</FONT></B> n <B><FONT COLOR="#A020F0">then</FONT></B>              <I><FONT COLOR="#B22222"># Last time through??
</FONT></I>                             <B><FONT COLOR="#A020F0">write</FONT></B>(counter <B><FONT COLOR="#5F9EA0">+</FONT></B><B><FONT COLOR="#5F9EA0">:=</FONT></B> 1,   <I><FONT COLOR="#B22222"># then write the output
</FONT></I>                                   <B><FONT COLOR="#BC8F8F">&quot;: (&quot;</FONT></B>,areacode,<B><FONT COLOR="#BC8F8F">&quot;) &quot;</FONT></B>,exchange,<B><FONT COLOR="#BC8F8F">&quot;-&quot;</FONT></B>,num)
            }
        }
    }
<B><FONT COLOR="#A020F0">end</FONT></B></pre></td></tr></table>
