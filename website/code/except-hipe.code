<table width="100%" border="0" cellpadding="5" cellspacing="0"><tr><td bgcolor="#FFFFFF"><pre>
<I><FONT COLOR="#B22222">%% The Great Computer Language Shootout
</FONT></I><I><FONT COLOR="#B22222">%% contributed by Isaac Gouy (Erlang novice)
</FONT></I><I><FONT COLOR="#B22222">%%
</FONT></I><I><FONT COLOR="#B22222">%% http://shootout.alioth.debian.org/
</FONT></I><I><FONT COLOR="#B22222">%%
</FONT></I><I><FONT COLOR="#B22222">%% Used destructive assignment in the process dictionary 
</FONT></I><I><FONT COLOR="#B22222">%% to keep count of handled exceptions.
</FONT></I><I><FONT COLOR="#B22222">%%
</FONT></I><I><FONT COLOR="#B22222">%% Usage: start from command line with
</FONT></I><I><FONT COLOR="#B22222">%%     erlc except.erl
</FONT></I><I><FONT COLOR="#B22222">%%     erl -noinput -s except main 200000
</FONT></I>
<B><FONT COLOR="#5F9EA0">-module</FONT></B>(except). 
<B><FONT COLOR="#5F9EA0">-export</FONT></B>([main/1]). 


<B><FONT COLOR="#0000FF">blowup</FONT></B>(<FONT COLOR="#B8860B">N</FONT>) <B><FONT COLOR="#A020F0">when</FONT></B> <FONT COLOR="#B8860B">N</FONT> rem 2 == 0 -&gt; <B><FONT COLOR="#A020F0">throw</FONT></B>({lo_exception, <FONT COLOR="#B8860B">N</FONT>});
<B><FONT COLOR="#0000FF">blowup</FONT></B>(<FONT COLOR="#B8860B">N</FONT>) -&gt; <B><FONT COLOR="#A020F0">throw</FONT></B>({hi_exception, <FONT COLOR="#B8860B">N</FONT>}).


<B><FONT COLOR="#0000FF">lo_fun</FONT></B>(<FONT COLOR="#B8860B">N</FONT>) -&gt;
    <B><FONT COLOR="#A020F0">case</FONT></B> <B><FONT COLOR="#A020F0">catch</FONT></B> blowup(<FONT COLOR="#B8860B">N</FONT>) <B><FONT COLOR="#A020F0">of</FONT></B>
        {lo_exception, <FONT COLOR="#B8860B">N1</FONT>} -&gt; <B><FONT COLOR="#A020F0">put</FONT></B>(lo_count, <B><FONT COLOR="#A020F0">get</FONT></B>(lo_count) + 1);
        {hi_exception, <FONT COLOR="#B8860B">N2</FONT>} -&gt; <B><FONT COLOR="#A020F0">throw</FONT></B>({hi_exception, <FONT COLOR="#B8860B">N2</FONT>})
    <B><FONT COLOR="#A020F0">end</FONT></B>.


<B><FONT COLOR="#0000FF">hi_fun</FONT></B>(<FONT COLOR="#B8860B">N</FONT>) -&gt; 
    <B><FONT COLOR="#A020F0">case</FONT></B> <B><FONT COLOR="#A020F0">catch</FONT></B> lo_fun(<FONT COLOR="#B8860B">N</FONT>) <B><FONT COLOR="#A020F0">of</FONT></B>
        {hi_exception, <FONT COLOR="#B8860B">N1</FONT>} -&gt; <B><FONT COLOR="#A020F0">put</FONT></B>(hi_count, <B><FONT COLOR="#A020F0">get</FONT></B>(hi_count) + 1);
        <FONT COLOR="#B8860B">_</FONT> -&gt; true
    <B><FONT COLOR="#A020F0">end</FONT></B>.


<B><FONT COLOR="#0000FF">some_fun</FONT></B>(0) -&gt; true;
<B><FONT COLOR="#0000FF">some_fun</FONT></B>(<FONT COLOR="#B8860B">N</FONT>) -&gt;
    <B><FONT COLOR="#A020F0">case</FONT></B> <B><FONT COLOR="#A020F0">catch</FONT></B> hi_fun(<FONT COLOR="#B8860B">N</FONT>) <B><FONT COLOR="#A020F0">of</FONT></B>
        {lo_exception, <FONT COLOR="#B8860B">N1</FONT>} -&gt; io:fwrite(<B><FONT COLOR="#BC8F8F">&quot;~s~n&quot;</FONT></B>, [<B><FONT COLOR="#BC8F8F">&quot;lo_exception should not get here.&quot;</FONT></B>]);
        {hi_exception, <FONT COLOR="#B8860B">N2</FONT>} -&gt; io:fwrite(<B><FONT COLOR="#BC8F8F">&quot;~s~n&quot;</FONT></B>, [<B><FONT COLOR="#BC8F8F">&quot;hi_exception should not get here.&quot;</FONT></B>]);
        <FONT COLOR="#B8860B">_</FONT> -&gt; true
    <B><FONT COLOR="#A020F0">end</FONT></B>,
    some_fun(<FONT COLOR="#B8860B">N</FONT> - 1).


<B><FONT COLOR="#0000FF">main</FONT></B>([<FONT COLOR="#B8860B">Arg</FONT>]) -&gt;
    <FONT COLOR="#B8860B">Num</FONT> = <B><FONT COLOR="#A020F0">list_to_integer</FONT></B>(<B><FONT COLOR="#A020F0">atom_to_list</FONT></B>(<FONT COLOR="#B8860B">Arg</FONT>)),
    <B><FONT COLOR="#A020F0">put</FONT></B>(hi_count, 0),
    <B><FONT COLOR="#A020F0">put</FONT></B>(lo_count, 0),
    some_fun(<FONT COLOR="#B8860B">Num</FONT>),
    io:fwrite(<B><FONT COLOR="#BC8F8F">&quot;~s~w ~s~w~n&quot;</FONT></B>, [<B><FONT COLOR="#BC8F8F">&quot;Exceptions: HI=&quot;</FONT></B>, <B><FONT COLOR="#A020F0">get</FONT></B>(hi_count),<B><FONT COLOR="#BC8F8F">&quot;/ LO=&quot;</FONT></B>, <B><FONT COLOR="#A020F0">get</FONT></B>(lo_count)]),
    <B><FONT COLOR="#A020F0">halt</FONT></B>(0).



</pre></td></tr></table>
