<span class="slc">#!/usr/bin/tclsh
</span><span class="slc">#
</span><span class="slc"># $Id: wordfreq-tcl.code,v 1.6 2005-06-11 05:30:57 bfulgham Exp $
</span><span class="slc">#
</span><span class="slc"># http://shootout.alioth.debian.org/
</span><span class="slc"># with help from: Tom Wilkason and Branko Vesligaj
</span><span class="slc">#
</span><span class="slc"># Speed increase by Roy Terry
</span><span class="kwa">proc</span> main <span class="sym">{} {

</span>    <span class="kwa">set</span> punc <span class="sym">{</span>\<span class="sym">{</span>\<span class="sym">}</span><span class="str">&quot;'</span><span class="esc">\\</span><span class="str">!&#64;#$%^&amp;*()-_+=|[]:;,.~`?0123456789}
    foreach c [split $punc &quot;</span><span class="str">&quot;] {lappend map $c &quot;</span> <span class="str">&quot;}
    while {[set data [read stdin 4096]] != {}} {
        if {[gets stdin extra] != -1} {append data $extra}
        set line [string map $map $data]
        foreach word [string tolower $line] {
            if {[catch {incr count($word)}]} {set count($word) 1}
        }
    }
    foreach {word cnt}  [array get count] {
        lappend lines [format &quot;</span><span class="sym">%</span><span class="num">7d</span> <span class="sym">%</span>s<span class="str">&quot; $cnt $word]
    }
    puts [join [lsort -decreasing $lines] &quot;</span>\n<span class="str">&quot;]
}


main</span>
