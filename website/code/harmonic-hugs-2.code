<span class="com">{-# OPTIONS -fglasgow-exts #-}</span>
<span class="slc">-- The Great Computer Language Shootout</span>
<span class="slc">-- http://shootout.alioth.debian.org/</span>
<span class="slc">-- sum harmonic series</span>
<span class="slc">-- compile with:  ghc -O2 -o Harm Harm.hs</span>
<span class="slc">-- by Don Stewart</span>

<span class="kwa">import</span> System
<span class="kwa">import</span> Numeric
<span class="kwa">import</span> GHC.Base
<span class="kwa">import</span> GHC.<span class="kwb">Float</span>

main <span class="sym">=</span> <span class="kwa">do</span> <span class="sym">(</span>I# n<span class="sym">) &lt;-</span> getArgs <span class="sym">&gt;&gt;=</span> return . read . head
          putStrLn $ showFFloat <span class="sym">(</span>Just <span class="num">9</span><span class="sym">) (</span>D# <span class="sym">(</span>loop n <span class="num">0.0</span>##<span class="sym">)) []</span>

loop <span class="num">0</span># s <span class="sym">=</span> s
loop d  s <span class="sym">=</span> loop <span class="sym">(</span>d<span class="sym">-</span>#<span class="num">1</span>#<span class="sym">) (</span>s <span class="sym">+</span>## <span class="sym">(</span><span class="num">1.0</span>## <span class="sym">/</span>## int2Double# d<span class="sym">))</span>
