<span class="slc">#!/usr/bin/python
</span><span class="slc"># $Id: message-python.code,v 1.1 2005-03-18 06:26:31 bfulgham Exp $
</span><span class="slc"># http://shootout.alioth.debian.org/
</span><span class="slc">#
</span><span class="slc"># Contributed by Christos Georgiou
</span><span class="kwc">import</span> thread
<span class="kwc">from</span> Queue <span class="kwc">import</span> Queue

<span class="kwb">def</span> thread_fun<span class="sym">(</span>in_que<span class="sym">,</span> out_que<span class="sym">):
</span>    input_data <span class="sym">=</span> in_que<span class="sym">.</span>get<span class="sym">()
</span>    out_que<span class="sym">.</span>put<span class="sym">(</span>input_data<span class="sym">+</span><span class="num">1</span><span class="sym">)

</span>in_que <span class="sym">=</span> None
first_que <span class="sym">=</span> out_que <span class="sym">=</span> Queue<span class="sym">(</span><span class="num">1</span><span class="sym">)

</span><span class="kwb">for</span> i <span class="kwb">in</span> <span class="kwa">xrange</span><span class="sym">(</span><span class="num">3000</span><span class="sym">):
</span>    in_que<span class="sym">,</span> out_que <span class="sym">=</span> out_que<span class="sym">,</span> Queue<span class="sym">(</span><span class="num">1</span><span class="sym">)
</span>    thread<span class="sym">.</span>start_new_thread<span class="sym">(</span>thread_fun<span class="sym">, (</span>in_que<span class="sym">,</span> out_que<span class="sym">))

</span>last_que <span class="sym">=</span> out_que

first_que<span class="sym">.</span>put<span class="sym">(</span><span class="num">0</span><span class="sym">)
</span><span class="kwb">print</span> last_que<span class="sym">.</span>get<span class="sym">()
</span>
