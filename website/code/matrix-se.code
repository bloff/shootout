<table width="100%" border="0" cellpadding="5" cellspacing="0"><tr><td bgcolor="#FFFFFF"><pre>
<I><FONT COLOR="#B22222">-- -*- mode: eiffel -*-
</FONT></I><I><FONT COLOR="#B22222">-- $Id: matrix-se.code,v 1.2 2004-11-08 08:15:17 bfulgham Exp $
</FONT></I><I><FONT COLOR="#B22222">-- http://www.bagley.org/~doug/shootout/
</FONT></I><I><FONT COLOR="#B22222">-- from Steve Thompson
</FONT></I>
<I><FONT COLOR="#B22222">-- &lt;LOC-OFF&gt;
</FONT></I><B><FONT COLOR="#A020F0">indexing</FONT></B>
<B><FONT COLOR="#5F9EA0">   description: </FONT></B><B><FONT COLOR="#BC8F8F">&quot;This class performs the matrix multiplication test&quot;</FONT></B> 
<B><FONT COLOR="#5F9EA0">   author : </FONT></B>Steve Thompson
<B><FONT COLOR="#5F9EA0">   email  : </FONT></B><B><FONT COLOR="#BC8F8F">&quot;Steve_Thompson@prodigy.net&quot;</FONT></B>
<B><FONT COLOR="#5F9EA0">   date   : </FONT></B>February 18, 2001
<B><FONT COLOR="#5F9EA0">   compile: </FONT></B><B><FONT COLOR="#BC8F8F">&quot;compile -clean -boost -no_split -O3 main.e -o main&quot;</FONT></B>
<B><FONT COLOR="#5F9EA0">   run    : </FONT></B><B><FONT COLOR="#BC8F8F">&quot;main 300&quot;</FONT></B>
<I><FONT COLOR="#B22222">-- &lt;LOC-ON&gt;
</FONT></I>   
<B><FONT COLOR="#A020F0">class</FONT></B> MATRIX
   
<B><FONT COLOR="#A020F0">creation</FONT></B> make
   
<B><FONT COLOR="#A020F0">feature</FONT></B> <I><FONT COLOR="#B22222">-- Creation
</FONT></I>   
<B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">   make</FONT></I></B></FONT></B> <B><FONT COLOR="#A020F0">is</FONT></B>
      <B><FONT COLOR="#A020F0">local</FONT></B>
<B><FONT COLOR="#5F9EA0">	 index, count: </FONT></B><B><FONT COLOR="#228B22">INTEGER</FONT></B>
<B><FONT COLOR="#5F9EA0">	 m1, m2: </FONT></B><B><FONT COLOR="#A020F0">like</FONT></B> matrix
      <B><FONT COLOR="#A020F0">do</FONT></B>
	 <B><FONT COLOR="#A020F0">from</FONT></B>
	    <B><FONT COLOR="#A020F0">if</FONT></B> argument_count &lt; 1 <B><FONT COLOR="#A020F0">then</FONT></B> 
	       count <B><FONT COLOR="#5F9EA0">:=</FONT></B> 1
	    <B><FONT COLOR="#A020F0">else</FONT></B> 
	       count <B><FONT COLOR="#5F9EA0">:=</FONT></B> argument(1).to_integer
	    <B><FONT COLOR="#A020F0">end</FONT></B>
	    index <B><FONT COLOR="#5F9EA0">:=</FONT></B> 0
	    m1 <B><FONT COLOR="#5F9EA0">:=</FONT></B> new_matrix(30, 30) 
	    m2 <B><FONT COLOR="#5F9EA0">:=</FONT></B> new_matrix(30, 30) 
	    <B><FONT COLOR="#5F9EA0">!!</FONT></B>matrix.make(0, 29, 0, 29)
	 <B><FONT COLOR="#A020F0">until</FONT></B>
	    index <B><FONT COLOR="#5F9EA0">=</FONT></B> count
	 <B><FONT COLOR="#A020F0">loop</FONT></B>
	    mmult(30, 30, m1, m2)
	    index <B><FONT COLOR="#5F9EA0">:=</FONT></B> index + 1
	 <B><FONT COLOR="#A020F0">end</FONT></B> <I><FONT COLOR="#B22222">-- from
</FONT></I>	 print(matrix.item(0, 0).to_string + <B><FONT COLOR="#BC8F8F">&quot; &quot;</FONT></B> + matrix.item(2, 3).to_string + <B><FONT COLOR="#BC8F8F">&quot; &quot;</FONT></B> +
	       matrix.item(3, 2).to_string + <B><FONT COLOR="#BC8F8F">&quot; &quot;</FONT></B> + matrix.item(4, 4).to_string + <B><FONT COLOR="#BC8F8F">&quot;%N&quot;</FONT></B>)
      <B><FONT COLOR="#A020F0">end</FONT></B> <I><FONT COLOR="#B22222">-- make
</FONT></I>   
<B><FONT COLOR="#A020F0">feature</FONT></B> <I><FONT COLOR="#B22222">-- Queries
</FONT></I>   
<B><FONT COLOR="#5F9EA0">   matrix: </FONT></B><B><FONT COLOR="#228B22">ARRAY2</FONT></B>[<B><FONT COLOR="#228B22">INTEGER</FONT></B>]
   
<B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">   new_matrix</FONT></I></B></FONT></B>(rows, columns<B><FONT COLOR="#228B22">: INTEGER</FONT></B>)<B><FONT COLOR="#228B22">: like matrix</FONT></B><B><FONT COLOR="#A020F0"> is</FONT></B>
	 <I><FONT COLOR="#B22222">-- Create and populate a new matrix.
</FONT></I>      <B><FONT COLOR="#A020F0">local</FONT></B>
<B><FONT COLOR="#5F9EA0">	 i, j, count: </FONT></B><B><FONT COLOR="#228B22">INTEGER</FONT></B>
      <B><FONT COLOR="#A020F0">do</FONT></B>
	 <B><FONT COLOR="#5F9EA0">!!</FONT></B><B><FONT COLOR="#A020F0">Result</FONT></B>.make(0, rows - 1, 0, columns - 1)
	 <B><FONT COLOR="#A020F0">from</FONT></B> 
	    count <B><FONT COLOR="#5F9EA0">:=</FONT></B> 1
	    i <B><FONT COLOR="#5F9EA0">:=</FONT></B> 0
	 <B><FONT COLOR="#A020F0">until</FONT></B> i <B><FONT COLOR="#5F9EA0">=</FONT></B> rows <B><FONT COLOR="#A020F0">loop</FONT></B>
	    <B><FONT COLOR="#A020F0">from</FONT></B> j <B><FONT COLOR="#5F9EA0">:=</FONT></B> 0 <B><FONT COLOR="#A020F0">until</FONT></B> j <B><FONT COLOR="#5F9EA0">=</FONT></B> columns <B><FONT COLOR="#A020F0">loop</FONT></B>
	       <B><FONT COLOR="#A020F0">Result</FONT></B>.put(count, i, j)
	       count <B><FONT COLOR="#5F9EA0">:=</FONT></B> count + 1
	       j <B><FONT COLOR="#5F9EA0">:=</FONT></B> j + 1
	    <B><FONT COLOR="#A020F0">end</FONT></B> 
	    i <B><FONT COLOR="#5F9EA0">:=</FONT></B> i + 1
	 <B><FONT COLOR="#A020F0">end</FONT></B>
      <B><FONT COLOR="#A020F0">end</FONT></B> <I><FONT COLOR="#B22222">-- new_matrix
</FONT></I>   
<B><FONT COLOR="#A020F0">feature</FONT></B> <I><FONT COLOR="#B22222">-- Commands
</FONT></I>   
   zero_matrix(<B><FONT COLOR="#5F9EA0">rows, columns: </FONT></B><B><FONT COLOR="#228B22">INTEGER</FONT></B>;<B><FONT COLOR="#5F9EA0"> a_matrix: </FONT></B><B><FONT COLOR="#A020F0">like</FONT></B> matrix) <B><FONT COLOR="#A020F0">is</FONT></B>
	 <I><FONT COLOR="#B22222">-- Clear a matrix
</FONT></I>      <B><FONT COLOR="#A020F0">do</FONT></B>
	 matrix.make(0, rows - 1, 0, columns - 1)
      <B><FONT COLOR="#A020F0">end</FONT></B> <I><FONT COLOR="#B22222">-- zero_matrix
</FONT></I>   
   mmult(<B><FONT COLOR="#5F9EA0">rows, columns: </FONT></B><B><FONT COLOR="#228B22">INTEGER</FONT></B>;<B><FONT COLOR="#5F9EA0"> first, second: </FONT></B><B><FONT COLOR="#A020F0">like</FONT></B> matrix) <B><FONT COLOR="#A020F0">is</FONT></B>
	 <I><FONT COLOR="#B22222">-- Multiply two matrices.
</FONT></I>      <B><FONT COLOR="#A020F0">local</FONT></B>
<B><FONT COLOR="#5F9EA0">	 i, j, k, val: </FONT></B><B><FONT COLOR="#228B22">INTEGER</FONT></B>
      <B><FONT COLOR="#A020F0">do</FONT></B>
	 zero_matrix(rows, columns, matrix)
	 <B><FONT COLOR="#A020F0">from</FONT></B> i <B><FONT COLOR="#5F9EA0">:=</FONT></B> 0 <B><FONT COLOR="#A020F0">until</FONT></B> i <B><FONT COLOR="#5F9EA0">=</FONT></B> rows <B><FONT COLOR="#A020F0">loop</FONT></B>
	    <B><FONT COLOR="#A020F0">from</FONT></B> j <B><FONT COLOR="#5F9EA0">:=</FONT></B> 0 <B><FONT COLOR="#A020F0">until</FONT></B> j <B><FONT COLOR="#5F9EA0">=</FONT></B> columns <B><FONT COLOR="#A020F0">loop</FONT></B>
	       val <B><FONT COLOR="#5F9EA0">:=</FONT></B> 0
	       <B><FONT COLOR="#A020F0">from</FONT></B> k <B><FONT COLOR="#5F9EA0">:=</FONT></B> 0 <B><FONT COLOR="#A020F0">until</FONT></B> k <B><FONT COLOR="#5F9EA0">=</FONT></B> columns <B><FONT COLOR="#A020F0">loop</FONT></B>
		  val <B><FONT COLOR="#5F9EA0">:=</FONT></B> val + first.item(i, k) * second.item(k, j)
		  k <B><FONT COLOR="#5F9EA0">:=</FONT></B> k + 1
	       <B><FONT COLOR="#A020F0">end</FONT></B>
	       matrix.put(val, i, j)
	       j <B><FONT COLOR="#5F9EA0">:=</FONT></B> j + 1
	    <B><FONT COLOR="#A020F0">end</FONT></B>
	    i <B><FONT COLOR="#5F9EA0">:=</FONT></B> i + 1
	 <B><FONT COLOR="#A020F0">end</FONT></B> <I><FONT COLOR="#B22222">-- from
</FONT></I>      <B><FONT COLOR="#A020F0">end</FONT></B> <I><FONT COLOR="#B22222">-- mmult
</FONT></I>   
<B><FONT COLOR="#A020F0">end</FONT></B></pre></td></tr></table>
