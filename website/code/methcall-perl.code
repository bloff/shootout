<table width="100%" border="0" cellpadding="5" cellspacing="0"><tr><td bgcolor="#FFFFFF"><pre>
<I><FONT COLOR="#B22222">#!/usr/bin/perl
</FONT></I><I><FONT COLOR="#B22222"># $Id: methcall-perl.code,v 1.1 2004-11-02 08:52:36 bfulgham Exp $
</FONT></I><I><FONT COLOR="#B22222"># http://www.bagley.org/~doug/shootout/
</FONT></I><I><FONT COLOR="#B22222"># with help from Ben Tilly
</FONT></I>
<B><FONT COLOR="#A020F0">package</FONT></B> Toggle;

<B><FONT COLOR="#A020F0">sub</FONT></B> <B><FONT COLOR="#A020F0">new</FONT></B> {
    <B><FONT COLOR="#A020F0">my</FONT></B>($class, $start_state) = @_;
    <B><FONT COLOR="#A020F0">bless</FONT></B>( { Bool =&gt; $start_state }, $class );
}

<B><FONT COLOR="#A020F0">sub</FONT></B> value {
    (<B><FONT COLOR="#A020F0">shift</FONT></B>)-&gt;{Bool};
}

<B><FONT COLOR="#A020F0">sub</FONT></B> activate {
    <B><FONT COLOR="#A020F0">my</FONT></B> $self = <B><FONT COLOR="#A020F0">shift</FONT></B>;
    $self-&gt;{Bool} ^= 1;
    <B><FONT COLOR="#A020F0">return</FONT></B>($self);
}


<B><FONT COLOR="#A020F0">package</FONT></B> NthToggle;
our @ISA = <B><FONT COLOR="#A020F0">qw</FONT></B>(Toggle);

<B><FONT COLOR="#A020F0">sub</FONT></B> <B><FONT COLOR="#A020F0">new</FONT></B> {
    <B><FONT COLOR="#A020F0">my</FONT></B>($class, $start_state, $max_counter) = @_;
    <B><FONT COLOR="#A020F0">my</FONT></B> $self = $class-&gt;SUPER::<B><FONT COLOR="#A020F0">new</FONT></B>($start_state);
    $self-&gt;{CountMax} = $max_counter;
    $self-&gt;{Counter} = 0;
    <B><FONT COLOR="#A020F0">return</FONT></B>($self);
}

<B><FONT COLOR="#A020F0">sub</FONT></B> activate {
    <B><FONT COLOR="#A020F0">my</FONT></B> $self = <B><FONT COLOR="#A020F0">shift</FONT></B>;
    <B><FONT COLOR="#A020F0">if</FONT></B> (++$self-&gt;{Counter} &gt;= $self-&gt;{CountMax}) {
	$self-&gt;{Bool} ^= 1;
	$self-&gt;{Counter} = 0;
    }
    <B><FONT COLOR="#A020F0">return</FONT></B>($self);
}


<B><FONT COLOR="#A020F0">package</FONT></B> main;

<B><FONT COLOR="#A020F0">sub</FONT></B> main {
    <B><FONT COLOR="#A020F0">my</FONT></B> $NUM = $ARGV[0];
    $NUM = 1 <B><FONT COLOR="#A020F0">if</FONT></B> ($NUM &lt; 1);

    <B><FONT COLOR="#A020F0">my</FONT></B> $val = 1;
    <B><FONT COLOR="#A020F0">my</FONT></B> $toggle = Toggle-&gt;new($val);
    <B><FONT COLOR="#A020F0">for</FONT></B> (1..$NUM) {
	$val = $toggle-&gt;activate-&gt;value;
    }
    <B><FONT COLOR="#A020F0">print</FONT></B> (($val) ? <B><FONT COLOR="#BC8F8F">&quot;true\n&quot;</FONT></B> : <B><FONT COLOR="#BC8F8F">&quot;false\n&quot;</FONT></B>);

    $val = 1;
    <B><FONT COLOR="#A020F0">my</FONT></B> $ntoggle = NthToggle-&gt;new($val, 3);
    <B><FONT COLOR="#A020F0">for</FONT></B> (1..$NUM) {
	$val = $ntoggle-&gt;activate-&gt;value;
    }
    <B><FONT COLOR="#A020F0">print</FONT></B> (($val) ? <B><FONT COLOR="#BC8F8F">&quot;true\n&quot;</FONT></B> : <B><FONT COLOR="#BC8F8F">&quot;false\n&quot;</FONT></B>);
}

main();</pre></td></tr></table>
