<span class="slc">-- $Id: strcat-hugs-2.code,v 1.1 2005-05-23 06:14:25 bfulgham Exp $
</span><span class="slc">-- http://www.bagley.org/~doug/shootout/
</span><span class="slc">-- from Benedikt Rosenau
</span>
<span class="kwa">module</span> Main <span class="kwa">where
import</span> System<span class="sym">(</span>getArgs<span class="sym">,</span> getProgName<span class="sym">,</span> exitWith<span class="sym">,</span> ExitCode<span class="sym">(</span>..<span class="sym">))
</span><span class="kwa">import</span> Numeric<span class="sym">(</span>readDec<span class="sym">)

</span>nAppend <span class="sym">::</span> <span class="kwb">Int</span> <span class="sym">-&gt; [</span><span class="kwb">Char</span><span class="sym">] -&gt; [</span><span class="kwb">Char</span><span class="sym">] -&gt; [</span><span class="kwb">Char</span><span class="sym">]
</span>nAppend <span class="num">0</span> s1 _  <span class="sym">=</span> s1
nAppend n s1 s2 <span class="sym">=</span> nAppend <span class="sym">(</span>n <span class="num">- 1</span><span class="sym">) (</span>s1 <span class="sym">++</span> s2<span class="sym">)</span> s2

lengthNHellos <span class="sym">::</span> <span class="kwb">Int</span> <span class="sym">-&gt;</span> <span class="kwb">Int
</span>lengthNHellos n <span class="sym">=</span> length <span class="sym">(</span>nAppend n <span class="str">&quot;&quot;</span> <span class="str">&quot;hello\n&quot;</span><span class="sym">)

</span>main <span class="sym">=</span> <span class="kwa">do
</span>       arg <span class="sym">&lt;-</span> getArgs
       <span class="kwa">case</span> arg <span class="kwa">of
</span>         <span class="sym">[</span>number<span class="sym">] -&gt;</span> <span class="kwa">let</span> n <span class="sym">=</span> fst <span class="sym">(</span>head <span class="sym">(</span>readDec number<span class="sym">))</span> <span class="kwa">in
</span>                     putStrLn <span class="sym">(</span>show <span class="sym">(</span>lengthNHellos n<span class="sym">))
</span>         _        <span class="sym">-&gt;</span> <span class="kwa">do
</span>                     putStr <span class="str">&quot;Usage: &quot;</span>
                     getProgName <span class="sym">&gt;&gt;=</span> putStr
                     putStrLn <span class="str">&quot; number&quot;</span>
                     exitWith <span class="sym">(</span>ExitFailure <span class="num">1</span><span class="sym">)</span>
