<table width="100%" border="0" cellpadding="5" cellspacing="0"><tr><td bgcolor="#FFFFFF"><pre>
<I><FONT COLOR="#B22222">#!/usr/bin/ruby
</FONT></I><I><FONT COLOR="#B22222"># -*- mode: ruby -*-
</FONT></I><I><FONT COLOR="#B22222"># $Id: objinst-ruby.code,v 1.2 2004-11-08 08:15:18 bfulgham Exp $
</FONT></I><I><FONT COLOR="#B22222"># http://www.bagley.org/~doug/shootout/
</FONT></I><I><FONT COLOR="#B22222"># with help from Aristarkh Zagorodnikov
</FONT></I>
<B><FONT COLOR="#A020F0">class</FONT></B> Toggle
    <B><FONT COLOR="#A020F0">def</FONT></B> <B><FONT COLOR="#0000FF">initialize</FONT></B>(start_state)
	<FONT COLOR="#B8860B">@bool</FONT> = start_state
    <B><FONT COLOR="#A020F0">end</FONT></B>

    <B><FONT COLOR="#A020F0">def</FONT></B> <B><FONT COLOR="#0000FF">value
</FONT></B>	<FONT COLOR="#B8860B">@bool</FONT>
    <B><FONT COLOR="#A020F0">end</FONT></B>

    <B><FONT COLOR="#A020F0">def</FONT></B> <B><FONT COLOR="#0000FF">activate
</FONT></B>	<FONT COLOR="#B8860B">@bool</FONT> = !<FONT COLOR="#B8860B">@bool</FONT>
	<B><FONT COLOR="#DA70D6">self</FONT></B>
    <B><FONT COLOR="#A020F0">end</FONT></B>
<B><FONT COLOR="#A020F0">end</FONT></B>

<B><FONT COLOR="#A020F0">class</FONT></B> NthToggle &lt; Toggle
    <B><FONT COLOR="#A020F0">def</FONT></B> <B><FONT COLOR="#0000FF">initialize</FONT></B>(start_state, max_counter)
	<B><FONT COLOR="#DA70D6">super</FONT></B> start_state
	<FONT COLOR="#B8860B">@count_max</FONT> = max_counter
	<FONT COLOR="#B8860B">@counter</FONT> = 0
    <B><FONT COLOR="#A020F0">end</FONT></B>

    <B><FONT COLOR="#A020F0">def</FONT></B> <B><FONT COLOR="#0000FF">activate
</FONT></B>	<FONT COLOR="#B8860B">@counter</FONT> += 1
	<B><FONT COLOR="#A020F0">if</FONT></B> <FONT COLOR="#B8860B">@counter</FONT> <B><FONT COLOR="#5F9EA0">&gt;=</FONT></B> <FONT COLOR="#B8860B">@count_max</FONT>
	    <FONT COLOR="#B8860B">@bool</FONT> = !<FONT COLOR="#B8860B">@bool</FONT>
	    <FONT COLOR="#B8860B">@counter</FONT> = 0
	<B><FONT COLOR="#A020F0">end</FONT></B>
	<B><FONT COLOR="#DA70D6">self</FONT></B>
    <B><FONT COLOR="#A020F0">end</FONT></B>
<B><FONT COLOR="#A020F0">end</FONT></B>

n = (ARGV.shift || 1).to_i

toggle = Toggle.new 1
5.times <B><FONT COLOR="#A020F0">do</FONT></B>
    puts toggle.activate.value ? <B><FONT COLOR="#BC8F8F">'true'</FONT></B> : <B><FONT COLOR="#BC8F8F">'false'</FONT></B>
<B><FONT COLOR="#A020F0">end</FONT></B>
n.times <B><FONT COLOR="#A020F0">do</FONT></B>
    toggle = Toggle.new 1
<B><FONT COLOR="#A020F0">end</FONT></B>

puts

ntoggle = NthToggle.new 1, 3
8.times <B><FONT COLOR="#A020F0">do</FONT></B>
    puts ntoggle.activate.value ? <B><FONT COLOR="#BC8F8F">'true'</FONT></B> : <B><FONT COLOR="#BC8F8F">'false'</FONT></B>
<B><FONT COLOR="#A020F0">end</FONT></B>
n.times <B><FONT COLOR="#A020F0">do</FONT></B>
    ntoggle = NthToggle.new 1, 3
<B><FONT COLOR="#A020F0">end</FONT></B>
</pre></td></tr></table>
