<span class="slc">;;; The Great Computer Language Shootout
</span><span class="slc">;;; http://shootout.alioth.debian.org/
</span><span class="slc">;;; contributed by Dima Dorfman, 2005
</span>
<span class="sym">(</span><span class="kwa">defun</span> nsievebits <span class="sym">(</span>m<span class="sym">)
  (</span>declare <span class="sym">(</span>fixnum m<span class="sym">))
  (</span>let <span class="sym">((</span>a <span class="sym">(</span>make<span class="sym">-</span>array m <span class="sym">:</span>initial<span class="sym">-</span>element <span class="num">1
</span>		       <span class="sym">:</span>element<span class="sym">-</span><span class="kwa">type</span> <span class="str">'bit)))
    (flet ((clear (i)
	     (loop for j fixnum from (+ i i) to (1- m) by i
		   do (setf (aref a j) 0))))
      (loop for i fixnum from 2 to (1- m)
	    when (= 1 (aref a i)) do (clear i)
	    count (= 1 (aref a i))))))

(defun test (n)
  (let ((m (* 10000 (expt 2 n))))
    (format t &quot;Primes up to~T~8&lt;~d~&gt;~T~8&lt;~d~&gt;~%&quot; m (nsievebits m))))

(defun main ()
  (let* ((args #+sbcl sb-ext:*posix-argv*
	       #+cmu extensions:*command-line-strings*
	       #+gcl si::*command-args*)
	 (n (parse-integer (car (last args)))))
    (when (&gt;= n 0) (test n))
    (when (&gt;= n 1) (test (- n 1)))
    (when (&gt;= n 2) (test (- n 2)))))</span>
