<span class="line">    1 </span><span class="slc">-- $Id: hash-nhc98.code,v 1.4 2004-11-13 07:41:35 bfulgham Exp $
</span><span class="line">    2 </span><span class="slc"></span><span class="slc">-- http://shootout.alioth.debian.org/
</span><span class="line">    3 </span><span class="slc"></span><span class="slc">-- rewritten by Malcolm Wallace
</span><span class="line">    4 </span><span class="slc"></span>
<span class="line">    5 </span><span class="kwa">import</span> System <span class="sym">(</span>getArgs<span class="sym">)
</span><span class="line">    6 </span><span class="sym"></span><span class="kwa">import</span> Data.HashTable <span class="kwa">as</span> HT
<span class="line">    7 </span><span class="kwa">import</span> Numeric <span class="sym">(</span>showHex<span class="sym">)
</span><span class="line">    8 </span><span class="sym"></span><span class="kwa">import</span> Monad <span class="sym">(</span>liftM<span class="sym">)
</span><span class="line">    9 </span><span class="sym"></span><span class="kwa">import</span> Maybe <span class="sym">(</span>isJust<span class="sym">)
</span><span class="line">   10 </span><span class="sym">
</span><span class="line">   11 </span><span class="sym"></span>main <span class="sym">=</span> <span class="kwa">do</span> num <span class="sym">&lt;-</span> liftM <span class="sym">(</span>\a<span class="sym">-&gt;</span> <span class="kwa">case</span> a <span class="kwa">of</span> <span class="sym">[</span>n<span class="sym">]-&gt;</span> read n<span class="sym">;</span> _<span class="sym">-&gt;</span><span class="num">1</span><span class="sym">)</span> getArgs
<span class="line">   12 </span>          tbl <span class="sym">&lt;-</span> HT.fromList hashString
<span class="line">   13 </span>                             <span class="sym">(</span>map <span class="sym">(</span>\i<span class="sym">-&gt;(</span>showHex i <span class="str">&quot;&quot;</span><span class="sym">,</span> <span class="kwa">True</span><span class="sym">)) [(</span><span class="num">1</span><span class="sym">::</span><span class="kwb">Int</span><span class="sym">)</span>..num<span class="sym">])
</span><span class="line">   14 </span><span class="sym"></span>          res <span class="sym">&lt;-</span> mapM <span class="sym">(</span>HT.lookup tbl . show<span class="sym">) [</span>num<span class="sym">,(</span>num<span class="num">-1</span><span class="sym">)</span>.<span class="num">.1</span><span class="sym">]
</span><span class="line">   15 </span><span class="sym"></span>          print <span class="sym">(</span>length <span class="sym">(</span>filter isJust res<span class="sym">))</span>
