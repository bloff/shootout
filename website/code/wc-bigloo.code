<table width="100%" border="0" cellpadding="5" cellspacing="0"><tr><td bgcolor="#FFFFFF"><pre>
<I><FONT COLOR="#B22222">;;; -*- mode: scheme -*-
</FONT></I><I><FONT COLOR="#B22222">;;; $Id: wc-bigloo.code,v 1.1 2004-11-02 08:53:31 bfulgham Exp $
</FONT></I><I><FONT COLOR="#B22222">;;; http://www.bagley.org/~doug/shootout/
</FONT></I><I><FONT COLOR="#B22222">;;; from Sven Hartrumpf
</FONT></I>
(module wc
	(main main)
	(option (<B><FONT COLOR="#A020F0">set!</FONT></B> *genericity* #f)))

(<B><FONT COLOR="#A020F0">define</FONT></B> (<B><FONT COLOR="#0000FF">main</FONT></B> args)
  (<B><FONT COLOR="#A020F0">let*</FONT></B> ((num-char 0)
         (num-word 0)
         (num-line 0)
         (g (regular-grammar
             ()
             ((+ #\newline)
              (<B><FONT COLOR="#A020F0">set!</FONT></B> num-char (+ num-char (the-length)))
              (<B><FONT COLOR="#A020F0">set!</FONT></B> num-line (+ num-line (the-length)))
              (ignore))
             ((+ (in #\space #\tab))
              (<B><FONT COLOR="#A020F0">set!</FONT></B> num-char (+ num-char (the-length)))
              (ignore))
             ((+ (out #\newline #\space #\tab))
              (<B><FONT COLOR="#A020F0">set!</FONT></B> num-char (+ num-char (the-length)))
              (<B><FONT COLOR="#A020F0">set!</FONT></B> num-word (+ 1 num-word))
              (ignore)))))
    (read/rp g (current-input-port))
    (display* num-line <B><FONT COLOR="#BC8F8F">&quot; &quot;</FONT></B> num-word <B><FONT COLOR="#BC8F8F">&quot; &quot;</FONT></B> num-char #<B><FONT COLOR="#BC8F8F">&quot;\n&quot;</FONT></B>)))</pre></td></tr></table>
