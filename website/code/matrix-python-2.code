<span class="slc">#!/usr/bin/python
</span><span class="slc"># $Id: matrix-python-2.code,v 1.7 2005-04-04 14:56:49 bfulgham Exp $
</span><span class="slc"># http://shootout.alioth.debian.org/
</span>
<span class="slc"># This program based on the original from:
</span><span class="slc"># &quot;The What, Why, Who, and Where of Python&quot; By Aaron R. Watters
</span><span class="slc"># http://www.networkcomputing.com/unixworld/tutorial/005/005.html
</span>
<span class="slc"># modified to pass rows and cols, and avoid matrix size checks
</span><span class="slc"># and added one optimization to reduce subscripted references in
</span><span class="slc"># inner loop.
</span><span class="slc">#
</span><span class="slc"># Enhanced by Tupteq
</span>
<span class="kwc">import</span> sys

size <span class="sym">=</span> <span class="num">30

</span><span class="kwb">def</span> mkmatrix<span class="sym">(</span>rows<span class="sym">,</span> cols<span class="sym">):
</span>    xrc <span class="sym">=</span> <span class="kwa">xrange</span><span class="sym">(</span>cols<span class="sym">)
</span>    <span class="kwb">return</span> <span class="sym">[[</span>i <span class="sym">*</span> cols <span class="sym">+</span> j <span class="sym">+</span> <span class="num">1</span> <span class="kwb">for</span> j <span class="kwb">in</span> xrc<span class="sym">]</span> <span class="kwb">for</span> i <span class="kwb">in</span> <span class="kwa">xrange</span><span class="sym">(</span>rows<span class="sym">)]

</span><span class="kwb">def</span> mmult<span class="sym">(</span>rows<span class="sym">,</span> cols<span class="sym">,</span> m1<span class="sym">,</span> m2<span class="sym">):
</span>    xrc <span class="sym">=</span> <span class="kwa">xrange</span><span class="sym">(</span>cols<span class="sym">)
</span>    m3 <span class="sym">= [</span>None<span class="sym">] *</span> rows
    <span class="kwb">for</span> i <span class="kwb">in</span> <span class="kwa">xrange</span><span class="sym">(</span>rows<span class="sym">):
</span>        m3i <span class="sym">=</span> m3<span class="sym">[</span>i<span class="sym">] = [</span><span class="num">0</span><span class="sym">] *</span> cols
        m1i <span class="sym">=</span> m1<span class="sym">[</span>i<span class="sym">]
</span>        <span class="kwb">for</span> j <span class="kwb">in</span> xrc<span class="sym">:
</span>            val <span class="sym">=</span> <span class="num">0
</span>            <span class="kwb">for</span> k <span class="kwb">in</span> xrc<span class="sym">:
</span>                val <span class="sym">+=</span> m1i<span class="sym">[</span>k<span class="sym">] *</span> m2<span class="sym">[</span>k<span class="sym">][</span>j<span class="sym">]
</span>            m3i<span class="sym">[</span>j<span class="sym">] =</span> val

    <span class="kwb">return</span> m3

<span class="kwb">def</span> main<span class="sym">():
</span>    iter <span class="sym">=</span> <span class="kwa">int</span><span class="sym">(</span>sys<span class="sym">.</span>argv<span class="sym">[</span><span class="num">1</span><span class="sym">])
</span>    m1 <span class="sym">=</span> mkmatrix<span class="sym">(</span>size<span class="sym">,</span> size<span class="sym">)
</span>    m2 <span class="sym">=</span> mkmatrix<span class="sym">(</span>size<span class="sym">,</span> size<span class="sym">)
</span>    <span class="kwb">for</span> i <span class="kwb">in</span> <span class="kwa">xrange</span><span class="sym">(</span>iter<span class="sym">):
</span>        mm <span class="sym">=</span> mmult<span class="sym">(</span>size<span class="sym">,</span> size<span class="sym">,</span> m1<span class="sym">,</span> m2<span class="sym">)
</span>    <span class="kwb">print</span> mm<span class="sym">[</span><span class="num">0</span><span class="sym">][</span><span class="num">0</span><span class="sym">],</span> mm<span class="sym">[</span><span class="num">2</span><span class="sym">][</span><span class="num">3</span><span class="sym">],</span> mm<span class="sym">[</span><span class="num">3</span><span class="sym">][</span><span class="num">2</span><span class="sym">],</span> mm<span class="sym">[</span><span class="num">4</span><span class="sym">][</span><span class="num">4</span><span class="sym">]

</span>main<span class="sym">()</span>
