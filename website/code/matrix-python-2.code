<table width="100%" border="0" cellpadding="5" cellspacing="0"><tr><td bgcolor="#FFFFFF"><pre>
<I><FONT COLOR="#B22222">#!/usr/bin/python
</FONT></I><I><FONT COLOR="#B22222"># $Id: matrix-python-2.code,v 1.1 2004-11-08 14:59:29 bfulgham Exp $
</FONT></I><I><FONT COLOR="#B22222"># http://www.bagley.org/~doug/shootout/
</FONT></I>
<I><FONT COLOR="#B22222"># This program based on the original from:
</FONT></I><I><FONT COLOR="#B22222"># &quot;The What, Why, Who, and Where of Python&quot; By Aaron R. Watters
</FONT></I><I><FONT COLOR="#B22222"># http://www.networkcomputing.com/unixworld/tutorial/005/005.html
</FONT></I>
<I><FONT COLOR="#B22222"># modified to pass rows and cols, and avoid matrix size checks
</FONT></I><I><FONT COLOR="#B22222"># and added one optimization to reduce subscripted references in
</FONT></I><I><FONT COLOR="#B22222"># inner loop.
</FONT></I>
<B><FONT COLOR="#A020F0">import</FONT></B> sys

size = 30

<B><FONT COLOR="#A020F0">def</FONT></B> <B><FONT COLOR="#0000FF">mkmatrix</FONT></B>(rows, cols):
    count = 1
    mx = [ None ] * rows
    <B><FONT COLOR="#A020F0">for</FONT></B> i <B><FONT COLOR="#A020F0">in</FONT></B> range(rows):
        mx[i] = [0] * cols
        <B><FONT COLOR="#A020F0">for</FONT></B> j <B><FONT COLOR="#A020F0">in</FONT></B> range(cols):
            mx[i][j] = count
            count += 1
    <B><FONT COLOR="#A020F0">return</FONT></B> mx

<B><FONT COLOR="#A020F0">def</FONT></B> <B><FONT COLOR="#0000FF">mmult</FONT></B>(rows, cols, m1, m2):
    m3 = [ None ] * rows
    <B><FONT COLOR="#A020F0">for</FONT></B> i <B><FONT COLOR="#A020F0">in</FONT></B> range( rows ):
        m3[i] = [0] * cols
        <B><FONT COLOR="#A020F0">for</FONT></B> j <B><FONT COLOR="#A020F0">in</FONT></B> range( cols ):
            val = 0
            <B><FONT COLOR="#A020F0">for</FONT></B> k <B><FONT COLOR="#A020F0">in</FONT></B> range( cols ):
                val += m1[i][k] * m2[k][j]
            m3[i][j] = val
    <B><FONT COLOR="#A020F0">return</FONT></B> m3

<B><FONT COLOR="#A020F0">def</FONT></B> <B><FONT COLOR="#0000FF">mxprint</FONT></B>(m):
    <B><FONT COLOR="#A020F0">for</FONT></B> i <B><FONT COLOR="#A020F0">in</FONT></B> range(size):
        <B><FONT COLOR="#A020F0">for</FONT></B> j <B><FONT COLOR="#A020F0">in</FONT></B> range(size):
            <B><FONT COLOR="#A020F0">print</FONT></B> m[i][j],
        <B><FONT COLOR="#A020F0">print</FONT></B> <B><FONT COLOR="#BC8F8F">&quot;&quot;</FONT></B>

<B><FONT COLOR="#A020F0">def</FONT></B> <B><FONT COLOR="#0000FF">main</FONT></B>():
    iter = int(sys.argv[1])
    m1 = mkmatrix(size, size)
    m2 = mkmatrix(size, size)
    <B><FONT COLOR="#A020F0">for</FONT></B> i <B><FONT COLOR="#A020F0">in</FONT></B> xrange(iter):
        mm = mmult(size, size, m1, m2)
    <B><FONT COLOR="#A020F0">print</FONT></B> mm[0][0], mm[2][3], mm[3][2], mm[4][4]

main()</pre></td></tr></table>
