<table width="100%" border="0" cellpadding="5" cellspacing="0"><tr><td bgcolor="#FFFFFF"><pre>
/* The Great Computer Language Shootout 
   contributed by Isaac Gouy (Clean novice)
   Updated by John van Groningen

   http://shootout.alioth.debian.org/

To compile:	
   cleanIDE.exe <I><FONT COLOR="#B22222">--batch-force-build &quot;e:\shoot\contrib\clean\ary.prj&quot;
</FONT></I>
To run:
   ary.exe -con 7000
*/
      

<B><FONT COLOR="#A020F0">module</FONT></B> ary
<B><FONT COLOR="#A020F0">import</FONT></B> StdEnv, StdArrayExtensions, LanguageShootout

Start = toString y`.[0] +++ <B><FONT COLOR="#BC8F8F">&quot; &quot;</FONT></B> +++ toString y`.[n-1] +++ <B><FONT COLOR="#BC8F8F">&quot;\n&quot;</FONT></B>
   <B><FONT COLOR="#A020F0">where</FONT></B>
   y` = loop x y (n-1) 1000       
   
   n = argi    
   x = createX n  
   y = createUnboxedIntArr n 0
   
   loop <B><FONT COLOR="#228B22">:: !{#Int} !*{#Int} !Int !Int -&gt; .{#Int}   
</FONT></B>   loop x y n rep
      | rep==0   = y
                 = loop x (inc x y n) n (rep-1)            
                     		                     
   inc x y j
      | j &gt;= 0  #! yj = y.[j]
                = inc x {y &amp; [j] = yj + x.[j]} (j-1)
		= y
      	      		        	
createX <B><FONT COLOR="#228B22">:: !Int -&gt; {#Int}
</FONT></B>createX n = {i \\ i &lt;- [1..n]}                     </pre></td></tr></table>
