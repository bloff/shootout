<table width="100%" border="0" cellpadding="5" cellspacing="0"><tr><td bgcolor="#FFFFFF"><pre>
<I><FONT COLOR="#B22222">-- $Id: strcat-ghc-2.code,v 1.1 2004-11-08 14:59:29 bfulgham Exp $
</FONT></I><I><FONT COLOR="#B22222">-- http://www.bagley.org/~doug/shootout/
</FONT></I><I><FONT COLOR="#B22222">-- from Benedikt Rosenau
</FONT></I>
<B><FONT COLOR="#A020F0">module</FONT></B> Main <B><FONT COLOR="#A020F0">where</FONT></B>
<B><FONT COLOR="#A020F0">import</FONT></B> System(getArgs, getProgName, exitWith, ExitCode(..))
<B><FONT COLOR="#A020F0">import</FONT></B> Numeric(readDec)

nAppend <B><FONT COLOR="#228B22">:: Int -&gt; [Char] -&gt; [Char] -&gt; [Char]
</FONT></B>nAppend 0 s1 <B><FONT COLOR="#A020F0">_ </FONT></B> = s1
nAppend n s1 s2 = nAppend (n - 1) (s1 ++ s2) s2

lengthNHellos <B><FONT COLOR="#228B22">:: Int -&gt; Int
</FONT></B>lengthNHellos n = length (nAppend n <B><FONT COLOR="#BC8F8F">&quot;&quot;</FONT></B> <B><FONT COLOR="#BC8F8F">&quot;hello\n&quot;</FONT></B>)

main = do
       arg &lt;- getArgs
       <B><FONT COLOR="#A020F0">case</FONT></B> arg <B><FONT COLOR="#A020F0">of</FONT></B>
         [number] -&gt; <B><FONT COLOR="#A020F0">let</FONT></B> n = fst (head (readDec number)) <B><FONT COLOR="#A020F0">in</FONT></B>
                     putStrLn (show (lengthNHellos n))
         <B><FONT COLOR="#A020F0">_ </FONT></B>       -&gt; do
                     putStr <B><FONT COLOR="#BC8F8F">&quot;Usage: &quot;</FONT></B>
                     getProgName &gt;&gt;= putStr
                     putStrLn <B><FONT COLOR="#BC8F8F">&quot; number&quot;</FONT></B>
                     exitWith (ExitFailure 1)</pre></td></tr></table>
