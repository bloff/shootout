<table width="100%" border="0" cellpadding="5" cellspacing="0"><tr><td bgcolor="#FFFFFF"><pre>
<B><FONT COLOR="#BC8F8F">&quot;  The Great Computer Language Shootout
   contributed by Paolo Bonzini

   To run: gst -QI /usr/local/share/smalltalk/gst.im reversefile &lt; input.txt 
&quot;</FONT></B>

<B><FONT COLOR="#BC8F8F">&quot;
((FileStream stdin bufferSize: 4096) splitAt: Character nl)
   reverseDo: [ :each | stdout nextPutAll: each; nl ]!
&quot;</FONT></B>


| <B><FONT COLOR="#A020F0">s</FONT></B> <B><FONT COLOR="#A020F0">last</FONT></B> out ptr |
<B><FONT COLOR="#A020F0">s</FONT></B> := (FileStream stdin bufferSize: 4096) contents.
<B><FONT COLOR="#A020F0">last</FONT></B> := <B><FONT COLOR="#A020F0">s</FONT></B> size.
out := String <B><FONT COLOR="#A020F0">new</FONT></B>: <B><FONT COLOR="#A020F0">s</FONT></B> size.
ptr := 1.

<B><FONT COLOR="#A020F0">s</FONT></B> size - 1 to: 1 by: -1 <B><FONT COLOR="#A020F0">do</FONT></B>: [ :i |
   (<B><FONT COLOR="#A020F0">s</FONT></B> at: i) == <I><FONT COLOR="#B22222">##(Character nl) ifTrue: [
</FONT></I>   out
      replaceFrom: ptr
      to: ptr + (<B><FONT COLOR="#A020F0">last</FONT></B> - i - 1)
      with: <B><FONT COLOR="#A020F0">s</FONT></B>
      startingAt: i + 1.

   ptr := ptr + <B><FONT COLOR="#A020F0">last</FONT></B> - i.
   <B><FONT COLOR="#A020F0">last</FONT></B> := i.
   ]
].

out
   replaceFrom: ptr
   to: out size
   with: <B><FONT COLOR="#A020F0">s</FONT></B>
   startingAt: 1.

stdout nextPutAll: out !</pre></td></tr></table>
