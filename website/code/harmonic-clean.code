<span class="sym">/*</span> The Great Win32 Computer Language Shootout
   http<span class="sym">://</span>dada.perl.it<span class="sym">/</span>shootout<span class="sym">/

</span>   contributed by Isaac Gouy <span class="sym">(</span>Clean novice<span class="sym">)
*/


</span><span class="kwa">module</span> harmonic
<span class="kwa">import</span> StdEnv<span class="sym">,</span> LanguageShootout

Start <span class="sym">=</span> toStringWith <span class="num">9</span> <span class="sym">(</span>loop argi <span class="num">0.0 0.0</span><span class="sym">)

</span>loop <span class="sym">:: !</span><span class="kwb">Int</span> <span class="sym">!</span>Real <span class="sym">!</span>Real <span class="sym">-&gt;</span> Real
loop i d sum
  <span class="sym">|</span> i <span class="sym">&gt;</span> <span class="num">0</span>       <span class="sym">=</span> loop <span class="sym">(</span>i<span class="num">-1</span><span class="sym">)</span> d` <span class="sym">(</span>s <span class="sym">+ (</span><span class="num">1.0</span><span class="sym">/</span>d`<span class="sym">))
  |</span> otherwise   <span class="sym">=</span> sum
  <span class="kwa">where</span> d` <span class="sym">=</span> d <span class="sym">+</span> <span class="num">1.0</span>
