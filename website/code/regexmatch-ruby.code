<span class="line">    1 </span><span class="slc">#!/usr/bin/ruby
</span><span class="line">    2 </span><span class="slc"></span><span class="slc"># -*- mode: ruby -*-
</span><span class="line">    3 </span><span class="slc"></span><span class="slc"># $Id: regexmatch-ruby.code,v 1.3 2004-11-11 07:14:05 bfulgham Exp $
</span><span class="line">    4 </span><span class="slc"></span><span class="slc"># http://www.bagley.org/~doug/shootout/
</span><span class="line">    5 </span><span class="slc"></span>
<span class="line">    6 </span>re = Regexp.new<span class="sym">(
</span><span class="line">    7 </span><span class="sym"></span>    <span class="str">'(?:^|[^\d\(])'</span> <span class="sym">+</span>                        <span class="slc"># must be preceeded by non-digit
</span><span class="line">    8 </span><span class="slc"></span>    <span class="str">'(?:\((\d\d\d)\)|(\d\d\d))'</span> <span class="sym">+</span>        <span class="slc"># match 1 or 2: area code is 3 digits
</span><span class="line">    9 </span><span class="slc"></span>    <span class="str">'[ ]'</span> <span class="sym">+</span>                                <span class="slc"># area code followed by one space
</span><span class="line">   10 </span><span class="slc"></span>    <span class="str">'(\d\d\d)'</span> <span class="sym">+</span>                        <span class="slc"># match 3: prefix of 3 digits
</span><span class="line">   11 </span><span class="slc"></span>    <span class="str">'[ -]'</span> <span class="sym">+</span>                                <span class="slc"># separator is either space or dash
</span><span class="line">   12 </span><span class="slc"></span>    <span class="str">'(\d\d\d\d)'</span> <span class="sym">+</span>                        <span class="slc"># match 4: last 4 digits
</span><span class="line">   13 </span><span class="slc"></span>    <span class="str">'\D'</span>                                <span class="slc"># must be followed by a non-digit
</span><span class="line">   14 </span><span class="slc"></span><span class="sym">)
</span><span class="line">   15 </span><span class="sym">
</span><span class="line">   16 </span><span class="sym"></span>NUM = Integer<span class="sym">(</span><span class="kwa">ARGV</span><span class="sym">[</span><span class="num">0</span><span class="sym">] ||</span> <span class="num">1</span><span class="sym">)
</span><span class="line">   17 </span><span class="sym">
</span><span class="line">   18 </span><span class="sym"></span>phones = <span class="kwa">STDIN</span>.readlines
<span class="line">   19 </span>
<span class="line">   20 </span>count = m = line = iter = <span class="num">0
</span><span class="line">   21 </span><span class="num"></span><span class="kwa">for</span> iter <span class="kwa">in</span> <span class="num">1</span>..NUM
<span class="line">   22 </span>    <span class="kwa">for</span> line <span class="kwa">in</span> phones
<span class="line">   23 </span>        <span class="kwa">if</span> m = re.match<span class="sym">(</span>line<span class="sym">)
</span><span class="line">   24 </span><span class="sym"></span>            num = <span class="str">'('</span> <span class="sym">+ (</span>m<span class="sym">[</span><span class="num">1</span><span class="sym">] ||</span> m<span class="sym">[</span><span class="num">2</span><span class="sym">]) +</span> <span class="str">') '</span> <span class="sym">+</span> m<span class="sym">[</span><span class="num">3</span><span class="sym">] +</span> <span class="str">'-'</span> <span class="sym">+</span> m<span class="sym">[</span><span class="num">4</span><span class="sym">];
</span><span class="line">   25 </span><span class="sym"></span>            <span class="kwa">if</span> iter == NUM
<span class="line">   26 </span>                count <span class="sym">+</span>= <span class="num">1
</span><span class="line">   27 </span><span class="num"></span>                puts <span class="str">&quot;#{count}: #{num}&quot;</span>
<span class="line">   28 </span>            <span class="kwa">end
</span><span class="line">   29 </span><span class="kwa">        end
</span><span class="line">   30 </span><span class="kwa">    end
</span><span class="line">   31 </span><span class="kwa">end</span>
