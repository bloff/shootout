<table width="100%" border="0" cellpadding="5" cellspacing="0"><tr><td bgcolor="#FFFFFF"><pre>
<I><FONT COLOR="#B22222">\ -*- mode: forth -*-
</FONT></I><I><FONT COLOR="#B22222">\ $Id: wc-gforth.code,v 1.2 2004-11-08 08:15:54 bfulgham Exp $
</FONT></I><I><FONT COLOR="#B22222">\ http://www.bagley.org/~doug/shootout/
</FONT></I>
<B><FONT COLOR="#A020F0">variable</FONT></B>  nn       0       nn <B><FONT COLOR="#5F9EA0">!</FONT></B>       <I><FONT COLOR="#B22222">\ number of newlines
</FONT></I><B><FONT COLOR="#A020F0">variable</FONT></B>  nw       0       nw <B><FONT COLOR="#5F9EA0">!</FONT></B>       <I><FONT COLOR="#B22222">\ number of words
</FONT></I><B><FONT COLOR="#A020F0">variable</FONT></B>  nc       0       nc <B><FONT COLOR="#5F9EA0">!</FONT></B>       <I><FONT COLOR="#B22222">\ number of chars
</FONT></I><B><FONT COLOR="#A020F0">variable</FONT></B>  in_word  0       in_word <B><FONT COLOR="#5F9EA0">!</FONT></B>  <I><FONT COLOR="#B22222">\ flag: &quot;in word&quot;
</FONT></I>
10  <B><FONT COLOR="#A020F0">constant</FONT></B>  nl_ch
9   <B><FONT COLOR="#A020F0">constant</FONT></B>  tab_ch
32  <B><FONT COLOR="#A020F0">constant</FONT></B>  space_ch

4096 <B><FONT COLOR="#A020F0">constant</FONT></B> MAXREAD
create buff MAXREAD allot

<I><FONT COLOR="#B22222">\ scan the buffer and count lines, words, chars
</FONT></I><B><FONT COLOR="#A020F0">: </FONT></B><B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">scanbuff</FONT></I></B></FONT></B> ( n <B><FONT COLOR="#5F9EA0">-</FONT></B><B><FONT COLOR="#5F9EA0">-</FONT></B> )
    <B><FONT COLOR="#5F9EA0">dup</FONT></B> nc <B><FONT COLOR="#5F9EA0">+</FONT></B><B><FONT COLOR="#5F9EA0">!</FONT></B>                 <I><FONT COLOR="#B22222">\ update nc with amount of chars in buffer
</FONT></I>    buff <B><FONT COLOR="#5F9EA0">+</FONT></B> buff           <I><FONT COLOR="#B22222">\ from start of buff to buff + n
</FONT></I>    <B><FONT COLOR="#A020F0">do</FONT></B>
	i c@
	<B><FONT COLOR="#A020F0">case</FONT></B>
	    nl_ch    <B><FONT COLOR="#A020F0">of</FONT></B>  0 in_word <B><FONT COLOR="#5F9EA0">!</FONT></B>  1 nn <B><FONT COLOR="#5F9EA0">+</FONT></B><B><FONT COLOR="#5F9EA0">!</FONT></B>  <B><FONT COLOR="#A020F0">endof</FONT></B>
	    tab_ch   <B><FONT COLOR="#A020F0">of</FONT></B>  0 in_word <B><FONT COLOR="#5F9EA0">!</FONT></B>  <B><FONT COLOR="#A020F0">endof</FONT></B>
	    space_ch <B><FONT COLOR="#A020F0">of</FONT></B>  0 in_word <B><FONT COLOR="#5F9EA0">!</FONT></B>  <B><FONT COLOR="#A020F0">endof</FONT></B>
	    <I><FONT COLOR="#B22222">\ otherwise:
</FONT></I>	    in_word @ 0=
	    <B><FONT COLOR="#A020F0">if</FONT></B>
		1 in_word <B><FONT COLOR="#5F9EA0">!</FONT></B>
		1 nw <B><FONT COLOR="#5F9EA0">+</FONT></B><B><FONT COLOR="#5F9EA0">!</FONT></B>
	    <B><FONT COLOR="#A020F0">endif</FONT></B>
	<B><FONT COLOR="#A020F0">endcase</FONT></B>
    <B><FONT COLOR="#A020F0">loop</FONT></B> ;

<B><FONT COLOR="#A020F0">: </FONT></B><B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">wc</FONT></I></B></FONT></B> ( <B><FONT COLOR="#5F9EA0">-</FONT></B><B><FONT COLOR="#5F9EA0">-</FONT></B> )
    buff
    <B><FONT COLOR="#A020F0">begin</FONT></B>
        buff MAXREAD stdin read<B><FONT COLOR="#5F9EA0">-</FONT></B>file <B><FONT COLOR="#5F9EA0">throw</FONT></B> <B><FONT COLOR="#5F9EA0">dup</FONT></B>
    <B><FONT COLOR="#A020F0">while</FONT></B>
	scanbuff
    <B><FONT COLOR="#A020F0">repeat</FONT></B> ;

wc nn @ . nw @ . nc @ 1 u.r cr

<B><FONT COLOR="#5F9EA0">bye</FONT></B> <I><FONT COLOR="#B22222">\ th-th-that's all folks!
</FONT></I></pre></td></tr></table>
