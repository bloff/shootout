<span class="slc">%%% The Computer Language Shootout</span>
<span class="slc">%%% http://shootout.alioth.debian.org/</span>
<span class="slc">%%% Contributed by Isaac Gouy (Erlang novice)</span>

<span class="sym">-</span><span class="kwd">module</span><span class="sym">(</span>partialsums<span class="sym">)</span>.
<span class="sym">-</span><span class="kwd">export</span><span class="sym">([</span>main<span class="sym">/</span><span class="num">1</span><span class="sym">])</span>.
<span class="sym">-</span><span class="kwd">import</span><span class="sym">(</span><span class="kwb">math</span><span class="sym">,[</span><span class="kwb">pow</span><span class="sym">/</span><span class="num">2</span><span class="sym">,</span><span class="kwb">sin</span><span class="sym">/</span><span class="num">1</span><span class="sym">,</span><span class="kwb">cos</span><span class="sym">/</span><span class="num">1</span><span class="sym">])</span>.

<span class="kwd">main</span><span class="sym">([</span>Arg<span class="sym">]) -&gt;</span>
   N <span class="sym">=</span> <span class="kwb">list_to_integer</span><span class="sym">(</span>Arg<span class="sym">),</span>
   io<span class="sym">:</span><span class="kwd">fwrite</span><span class="sym">(</span><span class="str">&quot;~.9f</span><span class="esc">\t</span><span class="str">(2/3)^k~n&quot;</span><span class="sym">, [</span><span class="kwd">twothirds</span><span class="sym">(</span><span class="num">0</span><span class="sym">,</span>N<span class="sym">,</span><span class="num">0.0</span><span class="sym">)]),</span>
   io<span class="sym">:</span><span class="kwd">fwrite</span><span class="sym">(</span><span class="str">&quot;~.9f</span><span class="esc">\t</span><span class="str">k^-0.5~n&quot;</span><span class="sym">, [</span><span class="kwd">k05</span><span class="sym">(</span><span class="num">1</span><span class="sym">,</span>N<span class="sym">,</span><span class="num">0.0</span><span class="sym">)]),</span>
   io<span class="sym">:</span><span class="kwd">fwrite</span><span class="sym">(</span><span class="str">&quot;~.9f</span><span class="esc">\t</span><span class="str">1/k(k+1)~n&quot;</span><span class="sym">, [</span><span class="kwd">kk1</span><span class="sym">(</span><span class="num">1</span><span class="sym">,</span>N<span class="sym">,</span><span class="num">0.0</span><span class="sym">)]),</span>
   io<span class="sym">:</span><span class="kwd">fwrite</span><span class="sym">(</span><span class="str">&quot;~.9f</span><span class="esc">\t</span><span class="str">Flint Hills~n&quot;</span><span class="sym">, [</span><span class="kwd">flintHills</span><span class="sym">(</span><span class="num">1</span><span class="sym">,</span>N<span class="sym">,</span><span class="num">0.0</span><span class="sym">)]),</span>
   io<span class="sym">:</span><span class="kwd">fwrite</span><span class="sym">(</span><span class="str">&quot;~.9f</span><span class="esc">\t</span><span class="str">Cookson Hills~n&quot;</span><span class="sym">, [</span><span class="kwd">cooksonHills</span><span class="sym">(</span><span class="num">1</span><span class="sym">,</span>N<span class="sym">,</span><span class="num">0.0</span><span class="sym">)]),</span>
   io<span class="sym">:</span><span class="kwd">fwrite</span><span class="sym">(</span><span class="str">&quot;~.9f</span><span class="esc">\t</span><span class="str">Harmonic~n&quot;</span><span class="sym">, [</span><span class="kwd">harmonic</span><span class="sym">(</span><span class="num">1</span><span class="sym">,</span>N<span class="sym">,</span><span class="num">0.0</span><span class="sym">)]),</span>
   io<span class="sym">:</span><span class="kwd">fwrite</span><span class="sym">(</span><span class="str">&quot;~.9f</span><span class="esc">\t</span><span class="str">Riemann Zeta~n&quot;</span><span class="sym">, [</span><span class="kwd">riemannZeta</span><span class="sym">(</span><span class="num">1</span><span class="sym">,</span>N<span class="sym">,</span><span class="num">0.0</span><span class="sym">)]),</span>
   io<span class="sym">:</span><span class="kwd">fwrite</span><span class="sym">(</span><span class="str">&quot;~.9f</span><span class="esc">\t</span><span class="str">Alternating Harmonic~n&quot;</span><span class="sym">, [</span><span class="kwd">altHarmonic</span><span class="sym">(</span><span class="num">1</span><span class="sym">,</span>N<span class="sym">,</span><span class="num">1.0</span><span class="sym">,</span><span class="num">0.0</span><span class="sym">)]),</span>
   io<span class="sym">:</span><span class="kwd">fwrite</span><span class="sym">(</span><span class="str">&quot;~.9f</span><span class="esc">\t</span><span class="str">Gregory~n&quot;</span><span class="sym">, [</span><span class="kwd">gregory</span><span class="sym">(</span><span class="num">1</span><span class="sym">,</span>N<span class="sym">,</span><span class="num">1.0</span><span class="sym">,</span><span class="num">0.0</span><span class="sym">)]),</span>
   erlang<span class="sym">:</span><span class="kwb">halt</span><span class="sym">()</span>.

<span class="kwd">twothirds</span><span class="sym">(</span>K<span class="sym">,</span>N<span class="sym">,</span>Sum<span class="sym">)</span> <span class="kwa">when</span> K <span class="sym">&lt;</span> N <span class="sym">-&gt;</span> <span class="kwd">twothirds</span><span class="sym">(</span>K<span class="sym">+</span><span class="num">1</span><span class="sym">,</span>N<span class="sym">,</span>Sum<span class="sym">+(</span><span class="kwb">pow</span><span class="sym">(</span><span class="num">2.0</span><span class="sym">/</span><span class="num">3.0</span><span class="sym">,</span>K<span class="sym">)));</span>
<span class="kwd">twothirds</span><span class="sym">(</span>K<span class="sym">,</span>N<span class="sym">,</span>Sum<span class="sym">) -&gt;</span> Sum.

<span class="kwd">k05</span><span class="sym">(</span>K<span class="sym">,</span>N<span class="sym">,</span>Sum<span class="sym">)</span> <span class="kwa">when</span> K <span class="sym">=&lt;</span> N <span class="sym">-&gt;</span> <span class="kwd">k05</span><span class="sym">(</span>K<span class="sym">+</span><span class="num">1</span><span class="sym">,</span>N<span class="sym">,</span>Sum<span class="sym">+</span><span class="kwb">pow</span><span class="sym">(</span>K<span class="sym">,-</span><span class="num">0.5</span><span class="sym">));</span>
<span class="kwd">k05</span><span class="sym">(</span>K<span class="sym">,</span>N<span class="sym">,</span>Sum<span class="sym">) -&gt;</span> Sum.

<span class="kwd">kk1</span><span class="sym">(</span>K<span class="sym">,</span>N<span class="sym">,</span>Sum<span class="sym">)</span> <span class="kwa">when</span> K <span class="sym">=&lt;</span> N <span class="sym">-&gt;</span> <span class="kwd">kk1</span><span class="sym">(</span>K<span class="sym">+</span><span class="num">1</span><span class="sym">,</span>N<span class="sym">,</span>Sum<span class="sym">+(</span><span class="num">1.0</span><span class="sym">/(</span>K<span class="sym">*(</span>K<span class="sym">+</span><span class="num">1</span><span class="sym">))));</span>
<span class="kwd">kk1</span><span class="sym">(</span>K<span class="sym">,</span>N<span class="sym">,</span>Sum<span class="sym">) -&gt;</span> Sum.

<span class="kwd">flintHills</span><span class="sym">(</span>K<span class="sym">,</span>N<span class="sym">,</span>Sum<span class="sym">)</span> <span class="kwa">when</span> K <span class="sym">=&lt;</span> N <span class="sym">-&gt;</span>
   <span class="kwd">flintHills</span><span class="sym">(</span>K<span class="sym">+</span><span class="num">1</span><span class="sym">,</span>N<span class="sym">,</span>Sum<span class="sym">+(</span><span class="num">1.0</span><span class="sym">/(</span><span class="kwb">pow</span><span class="sym">(</span>K<span class="sym">,</span><span class="num">3</span><span class="sym">)*</span><span class="kwb">pow</span><span class="sym">(</span><span class="kwb">sin</span><span class="sym">(</span>K<span class="sym">),</span><span class="num">2</span><span class="sym">))));</span>
<span class="kwd">flintHills</span><span class="sym">(</span>K<span class="sym">,</span>N<span class="sym">,</span>Sum<span class="sym">) -&gt;</span> Sum.

<span class="kwd">cooksonHills</span><span class="sym">(</span>K<span class="sym">,</span>N<span class="sym">,</span>Sum<span class="sym">)</span> <span class="kwa">when</span> K <span class="sym">=&lt;</span> N <span class="sym">-&gt;</span>
   <span class="kwd">cooksonHills</span><span class="sym">(</span>K<span class="sym">+</span><span class="num">1</span><span class="sym">,</span>N<span class="sym">,</span>Sum<span class="sym">+(</span><span class="num">1.0</span><span class="sym">/(</span><span class="kwb">pow</span><span class="sym">(</span>K<span class="sym">,</span><span class="num">3</span><span class="sym">)*</span><span class="kwb">pow</span><span class="sym">(</span><span class="kwb">cos</span><span class="sym">(</span>K<span class="sym">),</span><span class="num">2</span><span class="sym">))));</span>
<span class="kwd">cooksonHills</span><span class="sym">(</span>K<span class="sym">,</span>N<span class="sym">,</span>Sum<span class="sym">) -&gt;</span> Sum.

<span class="kwd">harmonic</span><span class="sym">(</span>K<span class="sym">,</span>N<span class="sym">,</span>Sum<span class="sym">)</span> <span class="kwa">when</span> K <span class="sym">=&lt;</span> N <span class="sym">-&gt;</span> <span class="kwd">harmonic</span><span class="sym">(</span>K<span class="sym">+</span><span class="num">1</span><span class="sym">,</span>N<span class="sym">,</span>Sum<span class="sym">+(</span><span class="num">1.0</span><span class="sym">/</span>K<span class="sym">));</span>
<span class="kwd">harmonic</span><span class="sym">(</span>K<span class="sym">,</span>N<span class="sym">,</span>Sum<span class="sym">) -&gt;</span> Sum.

<span class="kwd">riemannZeta</span><span class="sym">(</span>K<span class="sym">,</span>N<span class="sym">,</span>Sum<span class="sym">)</span> <span class="kwa">when</span> K <span class="sym">=&lt;</span> N <span class="sym">-&gt;</span> <span class="kwd">riemannZeta</span><span class="sym">(</span>K<span class="sym">+</span><span class="num">1</span><span class="sym">,</span>N<span class="sym">,</span>Sum<span class="sym">+(</span><span class="num">1.0</span><span class="sym">/</span><span class="kwb">pow</span><span class="sym">(</span>K<span class="sym">,</span><span class="num">2</span><span class="sym">)));</span>
<span class="kwd">riemannZeta</span><span class="sym">(</span>K<span class="sym">,</span>N<span class="sym">,</span>Sum<span class="sym">) -&gt;</span> Sum.

<span class="kwd">altHarmonic</span><span class="sym">(</span>K<span class="sym">,</span>N<span class="sym">,</span>A<span class="sym">,</span>Sum<span class="sym">)</span> <span class="kwa">when</span> K <span class="sym">=&lt;</span> N <span class="sym">-&gt;</span> <span class="kwd">altHarmonic</span><span class="sym">(</span>K<span class="sym">+</span><span class="num">1</span><span class="sym">,</span>N<span class="sym">,-</span>A<span class="sym">,</span>Sum<span class="sym">+(</span>A<span class="sym">/</span>K<span class="sym">));</span>
<span class="kwd">altHarmonic</span><span class="sym">(</span>K<span class="sym">,</span>N<span class="sym">,</span>A<span class="sym">,</span>Sum<span class="sym">) -&gt;</span> Sum.

<span class="kwd">gregory</span><span class="sym">(</span>K<span class="sym">,</span>N<span class="sym">,</span>A<span class="sym">,</span>Sum<span class="sym">)</span> <span class="kwa">when</span> K <span class="sym">=&lt;</span> N <span class="sym">-&gt;</span> <span class="kwd">gregory</span><span class="sym">(</span>K<span class="sym">+</span><span class="num">1</span><span class="sym">,</span>N<span class="sym">,-</span>A<span class="sym">,</span>Sum<span class="sym">+(</span>A<span class="sym">/(</span><span class="num">2</span><span class="sym">*</span>K<span class="sym">-</span><span class="num">1</span><span class="sym">)));</span>
<span class="kwd">gregory</span><span class="sym">(</span>K<span class="sym">,</span>N<span class="sym">,</span>A<span class="sym">,</span>Sum<span class="sym">) -&gt;</span> Sum.
