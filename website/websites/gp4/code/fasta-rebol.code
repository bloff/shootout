rebol<span class="sym">[</span>
	Title<span class="sym">:</span>  <span class="str">&quot;fasta&quot;</span>
	Author<span class="sym">:</span> <span class="str">&quot;Tom Conlin&quot;</span>
	Date<span class="sym">:</span>    <span class="num">2005</span><span class="sym">-</span><span class="num">11</span><span class="sym">-</span><span class="num">29</span>
	purpose<span class="sym">: {</span>	The Great Computer Language Shootout
	            http<span class="sym">:</span><span class="slc">//shootout.alioth.debian.org/gp4/benchmark.php?test=fasta</span>
	         <span class="sym">}</span>
	summary<span class="sym">: [</span>rebol fasta tom conlin <span class="num">2005</span><span class="sym">-</span><span class="num">11</span><span class="sym">-</span><span class="num">29</span><span class="sym">]</span>
    version<span class="sym">:</span> <span class="num">0.1</span>
<span class="sym">]</span>

ALU<span class="sym">: {</span>GGCCGGGCGCGGTGGCTCACGCCTGTAATCCCAGCACTTTGG
GAGGCCGAGGCGGGCGGATCACCTGAGGTCAGGAGTTCGAGA
CCAGCCTGGCCAACATGGTGAAACCCCGTCTCTACTAAAAAT
ACAAAAATTAGCCGGGCGTGGTGGCGCGCGCCTGTAATCCCA
GCTACTCGGGAGGCTGAGGCAGGAGAATCGCTTGAACCCGGG
AGGCGGAGGTTGCAGTGAGCCGAGATCGCGCCACTGCACTCC
AGCCTGGGCGACAGAGCGAGACTCCGTCTCAAAAA<span class="sym">}</span>

IUB<span class="sym">: [</span><span class="num">0.27 0.12 0.12 0.27</span><span class="sym">]</span> loop <span class="num">11</span><span class="sym">[</span>insert tail IUB <span class="num">0.02</span><span class="sym">]</span>
HomoSap<span class="sym">: [</span><span class="num">0.3029549426680 0.1979883004921 0.1975473066391 0.3015094502008</span><span class="sym">]</span>

repeat<span class="sym">-</span>fasta<span class="sym">:</span> func <span class="sym">[</span>n <span class="sym">[</span>integer<span class="sym">!]</span> seq<span class="sym">[</span>series<span class="sym">!] /</span>local rest<span class="sym">][</span>
	seq<span class="sym">:</span> replace<span class="sym">/</span>all seq <span class="str">&quot;^/&quot;</span> <span class="str">&quot;&quot;</span>
	loop to integer<span class="sym">!(</span>n <span class="sym">/</span> <span class="num">60</span><span class="sym">)[</span>
		either <span class="num">60</span> <span class="sym">&lt;</span> length? seq
			<span class="sym">[</span>print copy<span class="sym">/</span>part seq <span class="num">60</span>
			 seq<span class="sym">:</span> skip seq <span class="num">60</span>
			<span class="sym">][</span>rest<span class="sym">:</span> <span class="num">60</span> <span class="sym">-</span> length? seq
			 print head insert tail copy seq copy<span class="sym">/</span>part head seq rest
			 seq<span class="sym">:</span> skip head seq rest
			<span class="sym">]</span>
	<span class="sym">]</span>
	<span class="kwa">if not</span> zero? rest<span class="sym">:</span> n <span class="slc">// 60 [</span>
		either rest <span class="sym">&lt;=</span> length? seq
			<span class="sym">[</span>print copy<span class="sym">/</span>part seq rest<span class="sym">]</span>
			<span class="sym">[</span>print head insert tail copy seq copy<span class="sym">/</span>part head seq rest <span class="sym">-</span> length? seq<span class="sym">]</span>
	<span class="sym">]</span>
<span class="sym">]</span>

rand<span class="sym">-</span>fasta<span class="sym">:</span> func <span class="sym">[</span>n<span class="sym">[</span>integer<span class="sym">!]</span> probs<span class="sym">[</span>block<span class="sym">!] /</span>local prev line<span class="sym">][</span>
	symbol<span class="sym">: [</span><span class="str">&quot;a&quot;</span> <span class="str">&quot;c&quot;</span> <span class="str">&quot;g&quot;</span> <span class="str">&quot;t&quot;</span> <span class="str">&quot;B&quot;</span> <span class="str">&quot;D&quot;</span> <span class="str">&quot;H&quot;</span> <span class="str">&quot;K&quot;</span> <span class="str">&quot;M&quot;</span> <span class="str">&quot;N&quot;</span> <span class="str">&quot;R&quot;</span> <span class="str">&quot;S&quot;</span> <span class="str">&quot;V&quot;</span> <span class="str">&quot;W&quot;</span> <span class="str">&quot;Y&quot;</span><span class="sym">]</span>
	line<span class="sym">:</span> make string<span class="sym">!</span> <span class="num">60</span>
	probs<span class="sym">:</span> next probs
	forall probs<span class="sym">[</span>change probs add first back probs first probs<span class="sym">]</span>
	probs<span class="sym">:</span> head probs
	loop to integer<span class="sym">! (</span>n <span class="sym">/</span> <span class="num">60</span><span class="sym">)[</span>
		loop <span class="num">60</span> <span class="sym">[</span>insert tail line pick symbol bin<span class="sym">-</span>srch probs gen<span class="sym">-</span>rand<span class="sym">]</span>
		print line clear line
	<span class="sym">]</span>
	loop n <span class="slc">// 60[insert tail line pick symbol bin-srch probs gen-rand]</span>
	<span class="kwa">if not</span> empty? line <span class="sym">[</span>print line<span class="sym">]</span>
<span class="sym">]</span>

gen<span class="sym">-</span>rand<span class="sym">:</span> does<span class="sym">[</span>
	prev<span class="sym">:</span> prev <span class="sym">*</span> <span class="num">3877</span> <span class="sym">+</span> <span class="num">29573</span> <span class="slc">// 139968</span>
	<span class="num">.00000714449016918152720622</span> <span class="sym">*</span> prev
<span class="sym">]</span>
bin<span class="sym">-</span>srch<span class="sym">:</span> func<span class="sym">[</span>b k <span class="sym">/</span>local l m h<span class="sym">][</span>
	l<span class="sym">:</span> <span class="num">1</span> h<span class="sym">:</span> length? b m<span class="sym">:</span> to integer<span class="sym">!(</span>h <span class="sym">-</span> l <span class="sym">/</span> <span class="num">2</span><span class="sym">)+</span> l
	<span class="kwa">while</span><span class="sym">[</span>l <span class="sym">&lt;=</span> h<span class="sym">][</span>either k <span class="sym">=</span> b<span class="sym">/:</span>m <span class="sym">[</span><span class="kwa">return</span> m<span class="sym">]</span>
		<span class="sym">[</span>either k <span class="sym">&gt;</span> b<span class="sym">/:</span>m<span class="sym">[</span>l<span class="sym">:</span> m <span class="sym">+</span> <span class="num">1</span><span class="sym">][</span>h<span class="sym">:</span> m <span class="sym">-</span> <span class="num">1</span><span class="sym">]]</span>
		m<span class="sym">:</span> to integer<span class="sym">!(</span>h <span class="sym">-</span> l <span class="sym">/</span> <span class="num">2</span><span class="sym">)+</span> l
	<span class="sym">]</span> <span class="num">1</span> <span class="sym">+</span> m
<span class="sym">]</span>

n<span class="sym">:</span> either n<span class="sym">:</span> system<span class="sym">/</span>script<span class="sym">/</span>args<span class="sym">[</span>to integer<span class="sym">!</span> n<span class="sym">][</span><span class="num">1000</span><span class="sym">]</span>
print <span class="str">&quot;&gt;ONE Homo sapiens alu&quot;</span>
repeat<span class="sym">-</span>fasta <span class="num">2</span> <span class="sym">*</span> n ALU
prev<span class="sym">:</span> <span class="num">42</span>
print <span class="str">&quot;&gt;TWO IUB ambiguity codes&quot;</span>
rand<span class="sym">-</span>fasta  <span class="num">3</span> <span class="sym">*</span> n IUB
print <span class="str">&quot;&gt;THREE Homo sapiens frequency&quot;</span>
rand<span class="sym">-</span>fasta  <span class="num">5</span> <span class="sym">*</span> n HomoSap
