<span class="com">/* The Computer Language Shootout</span>
<span class="com">   http://shootout.alioth.debian.org/</span>
<span class="com"></span>
<span class="com">   transliterated Mirko Rahns GHC program</span>
<span class="com">   contributed by Isaac Gouy (Clean novice)</span>
<span class="com">*/</span>

<span class="kwa">module</span> harmonic
<span class="kwa">import</span> StdEnv<span class="sym">,</span> LanguageShootout

Start <span class="sym">=</span> toStringWith <span class="num">9</span> <span class="sym">(</span>loop <span class="sym">(</span>toReal argi<span class="sym">)</span> <span class="num">0.0</span><span class="sym">) +++</span> <span class="str">&quot;\n&quot;</span>

loop d sum
  <span class="sym">|</span> d &gt; <span class="num">0.0</span>     <span class="sym">=</span> loop <span class="sym">(</span>d<span class="sym">-</span><span class="num">1.0</span><span class="sym">) (</span>sum <span class="sym">+ (</span><span class="num">1.0</span><span class="sym">/</span>d<span class="sym">))</span>
  <span class="sym">|</span> otherwise   <span class="sym">=</span> sum
