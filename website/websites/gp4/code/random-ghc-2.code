<span class="sym">&lt;!</span>DOCTYPE HTML PUBLIC <span class="str">&quot;-//W3C//DTD HTML 4.0 Transitional//EN&quot;</span><span class="sym">&gt;&lt;</span>HTML<span class="sym">&gt;</span>
<span class="sym">&lt;</span>HEAD<span class="sym">&gt;</span>
<span class="sym">&lt;!</span><span class="slc">-- hennerik CVSweb $Revision: 1.2 $ --&gt;</span>
<span class="sym">&lt;</span>TITLE<span class="sym">&gt;</span>shootout<span class="sym">/</span>bench<span class="sym">/</span>random<span class="sym">/</span>random.ghc <span class="sym">-</span> view <span class="sym">-</span> <span class="num">1.5</span><span class="sym">&lt;/</span>TITLE<span class="sym">&gt;&lt;/</span>HEAD<span class="sym">&gt;</span>
<span class="sym">&lt;</span>BODY BGCOLOR<span class="sym">=</span><span class="str">&quot;#eeeeee&quot;</span><span class="sym">&gt;</span>
<span class="sym">&lt;</span>table width<span class="sym">=</span><span class="str">&quot;100%&quot;</span> border<span class="sym">=</span><span class="num">0</span> cellspacing<span class="sym">=</span><span class="num">0</span> cellpadding<span class="sym">=</span><span class="num">1</span> bgcolor<span class="sym">=</span><span class="str">&quot;#9999ee&quot;</span><span class="sym">&gt;&lt;</span>tr valign<span class="sym">=</span>bottom<span class="sym">&gt;&lt;</span>td<span class="sym">&gt;&lt;</span>a href<span class="sym">=</span><span class="str">&quot;random.ghc?cvsroot=shootout#rev1.5&quot;</span><span class="sym">&gt;&lt;</span>IMG SRC<span class="sym">=</span><span class="str">&quot;/icons/back.png&quot;</span> ALT<span class="sym">=</span><span class="str">&quot;[BACK]&quot;</span> BORDER<span class="sym">=</span><span class="str">&quot;0&quot;</span> WIDTH<span class="sym">=</span><span class="str">&quot;20&quot;</span> HEIGHT<span class="sym">=</span><span class="str">&quot;22&quot;</span><span class="sym">&gt;&lt;/</span>a<span class="sym">&gt; &lt;</span>b<span class="sym">&gt;</span>Return to <span class="sym">&lt;</span>A HREF<span class="sym">=</span><span class="str">&quot;random.ghc?cvsroot=shootout#rev1.5&quot;</span><span class="sym">&gt;</span>random.ghc<span class="sym">&lt;/</span>A<span class="sym">&gt;</span>
 CVS log<span class="sym">&lt;/</span>b<span class="sym">&gt; &lt;</span>IMG SRC<span class="sym">=</span><span class="str">&quot;/icons/text.png&quot;</span> ALT<span class="sym">=</span><span class="str">&quot;[TXT]&quot;</span> BORDER<span class="sym">=</span><span class="str">&quot;0&quot;</span> WIDTH<span class="sym">=</span><span class="str">&quot;20&quot;</span> HEIGHT<span class="sym">=</span><span class="str">&quot;22&quot;</span><span class="sym">&gt;&lt;/</span>td<span class="sym">&gt;&lt;</span>td align<span class="sym">=</span>right<span class="sym">&gt;&lt;</span>IMG SRC<span class="sym">=</span><span class="str">&quot;/icons/dir.png&quot;</span> ALT<span class="sym">=</span><span class="str">&quot;[DIR]&quot;</span> BORDER<span class="sym">=</span><span class="str">&quot;0&quot;</span> WIDTH<span class="sym">=</span><span class="str">&quot;20&quot;</span> HEIGHT<span class="sym">=</span><span class="str">&quot;22&quot;</span><span class="sym">&gt; &lt;</span>b<span class="sym">&gt;</span>Up to  <span class="sym">&lt;</span>a href<span class="sym">=</span><span class="str">&quot;/cgi-bin/cvsweb.cgi/?cvsroot=shootout#dirlist&quot;</span><span class="sym">&gt;[</span>GForge<span class="sym">-</span>CVS<span class="sym">]&lt;/</span>a<span class="sym">&gt; / &lt;</span>a href<span class="sym">=</span><span class="str">&quot;/cgi-bin/cvsweb.cgi/shootout/?cvsroot=shootout#dirlist&quot;</span><span class="sym">&gt;</span>shootout<span class="sym">&lt;/</span>a<span class="sym">&gt; / &lt;</span>a href<span class="sym">=</span><span class="str">&quot;/cgi-bin/cvsweb.cgi/shootout/bench/?cvsroot=shootout#dirlist&quot;</span><span class="sym">&gt;</span>bench<span class="sym">&lt;/</span>a<span class="sym">&gt; / &lt;</span>a href<span class="sym">=</span><span class="str">&quot;/cgi-bin/cvsweb.cgi/shootout/bench/random/?cvsroot=shootout#dirlist&quot;</span><span class="sym">&gt;</span>random<span class="sym">&lt;/</span>a<span class="sym">&gt;&lt;/</span>b<span class="sym">&gt;&lt;/</span>td<span class="sym">&gt;&lt;/</span>tr<span class="sym">&gt;&lt;/</span>table<span class="sym">&gt;&lt;</span>HR noshade<span class="sym">&gt;&lt;</span>table width<span class="sym">=</span><span class="str">&quot;100%&quot;</span><span class="sym">&gt;&lt;</span>tr<span class="sym">&gt;&lt;</span>td bgcolor<span class="sym">=</span><span class="str">&quot;#ffffff&quot;</span><span class="sym">&gt;</span>File<span class="sym">:  &lt;</span>a href<span class="sym">=</span><span class="str">&quot;/cgi-bin/cvsweb.cgi/?cvsroot=shootout#dirlist&quot;</span><span class="sym">&gt;[</span>GForge<span class="sym">-</span>CVS<span class="sym">]&lt;/</span>a<span class="sym">&gt; / &lt;</span>a href<span class="sym">=</span><span class="str">&quot;/cgi-bin/cvsweb.cgi/shootout/?cvsroot=shootout#dirlist&quot;</span><span class="sym">&gt;</span>shootout<span class="sym">&lt;/</span>a<span class="sym">&gt; / &lt;</span>a href<span class="sym">=</span><span class="str">&quot;/cgi-bin/cvsweb.cgi/shootout/bench/?cvsroot=shootout#dirlist&quot;</span><span class="sym">&gt;</span>bench<span class="sym">&lt;/</span>a<span class="sym">&gt; / &lt;</span>a href<span class="sym">=</span><span class="str">&quot;/cgi-bin/cvsweb.cgi/shootout/bench/random/?cvsroot=shootout#dirlist&quot;</span><span class="sym">&gt;</span>random<span class="sym">&lt;/</span>a<span class="sym">&gt; / &lt;</span>a href<span class="sym">=</span><span class="str">&quot;/cgi-bin/cvsweb.cgi/shootout/bench/random/random.ghc?cvsroot=shootout&quot;</span><span class="sym">&gt;</span>random.ghc<span class="sym">&lt;/</span>a<span class="sym">&gt;&amp;</span>nbsp<span class="sym">;(&lt;</span>A HREF<span class="sym">=</span><span class="str">&quot;/cgi-bin/cvsweb.cgi/~checkout~/shootout/bench/random/random.ghc?rev=1.5&amp;amp;cvsroot=shootout&quot;</span> target<span class="sym">=</span><span class="str">&quot;cvs_checkout&quot;</span> onClick<span class="sym">=</span><span class="str">&quot;window.open('/cgi-bin/cvsweb.cgi/~checkout~/shootout/bench/random/random.ghc?rev=1.5','cvs_checkout','resizeable,scrollbars');&quot;</span><span class="sym">&gt;&lt;</span>b<span class="sym">&gt;</span>download<span class="sym">&lt;/</span>b<span class="sym">&gt;&lt;/</span>A<span class="sym">&gt;)&lt;</span>BR<span class="sym">&gt;</span>
Revision <span class="sym">&lt;</span>B<span class="sym">&gt;</span><span class="num">1.5</span><span class="sym">&lt;/</span>B<span class="sym">&gt;, &lt;</span>i<span class="sym">&gt;</span>Sun May <span class="num">15 08</span><span class="sym">:</span><span class="num">54</span><span class="sym">:</span><span class="num">24 2005</span> UTC<span class="sym">&lt;/</span>i<span class="sym">&gt; (</span><span class="num">8</span> months ago<span class="sym">)</span> by <span class="sym">&lt;</span>i<span class="sym">&gt;</span>ekarttun<span class="sym">-</span>guest<span class="sym">&lt;/</span>i<span class="sym">&gt;</span>
<span class="sym">&lt;</span>BR<span class="sym">&gt;</span>Changes since <span class="sym">&lt;</span>b<span class="sym">&gt;</span><span class="num">1.4</span><span class="sym">: +</span><span class="num">2</span> <span class="sym">-</span><span class="num">1</span>
 lines<span class="sym">&lt;/</span>b<span class="sym">&gt;&lt;</span>PRE<span class="sym">&gt;</span>
Force rerun <span class="sym">(</span>linker errors<span class="sym">,</span> which should just go away<span class="sym">)</span>.
<span class="sym">&lt;/</span>PRE<span class="sym">&gt;</span>
<span class="sym">&lt;/</span>td<span class="sym">&gt;&lt;/</span>tr<span class="sym">&gt;&lt;/</span>table<span class="sym">&gt;&lt;</span>HR noshade<span class="sym">&gt;&lt;</span>PRE<span class="sym">&gt;</span><span class="slc">-- $Id: random-ghc-2.code,v 1.2 2006-01-14 18:02:20 igouy-guest Exp $</span>
<span class="slc">-- &lt;A HREF=&quot;http://shootout.alioth.debian.org&quot;&gt;http://shootout.alioth.debian.org&lt;/A&gt;</span>
<span class="slc">--</span>
<span class="slc">-- Original by Simon Marlow</span>
<span class="slc">-- Heavily modified by Einar Karttunen</span>


<span class="kwa">import</span> System<span class="sym">(</span>getArgs<span class="sym">)</span>
<span class="kwa">import</span> Numeric<span class="sym">(</span>showFFloat<span class="sym">)</span>

main <span class="sym">=</span> <span class="kwa">do</span> ~<span class="sym">[</span>n<span class="sym">] &amp;</span>lt<span class="sym">;-</span> getArgs
 <span class="sym">&amp;</span>nbsp<span class="sym">; &amp;</span>nbsp<span class="sym">; &amp;</span>nbsp<span class="sym">; &amp;</span>nbsp<span class="sym">; &amp;</span>nbsp<span class="sym">;</span>putStrLn <span class="sym">(</span>showFFloat <span class="sym">(</span>Just <span class="num">9</span><span class="sym">) (</span>randl <span class="num">100</span> <span class="sym">((</span>read n<span class="sym">)-</span><span class="num">1</span><span class="sym">)</span> <span class="num">42</span><span class="sym">) &amp;</span>quot<span class="sym">;&amp;</span>quot<span class="sym">;)</span>

randl <span class="sym">::</span> <span class="kwb">Double</span> <span class="sym">-&amp;</span>gt<span class="sym">;</span> <span class="kwb">Int</span> <span class="sym">-&amp;</span>gt<span class="sym">;</span> <span class="kwb">Int</span> <span class="sym">-&amp;</span>gt<span class="sym">;</span> <span class="kwb">Double</span>
randl max n seed <span class="sym">=</span> newseed `seq` newrand `seq`
 <span class="sym">&amp;</span>nbsp<span class="sym">;</span>if n <span class="sym">==</span> <span class="num">0</span> <span class="kwa">then</span> newrand <span class="kwa">else</span> randl max <span class="sym">(</span>n<span class="sym">-</span><span class="num">1</span><span class="sym">)</span> newseed
 <span class="sym">&amp;</span>nbsp<span class="sym">; &amp;</span>nbsp<span class="sym">;</span><span class="kwa">where</span> newseed <span class="sym">= (</span>seed <span class="sym">*</span> ia <span class="sym">+</span> ic<span class="sym">)</span> `mod` im
 <span class="sym">&amp;</span>nbsp<span class="sym">; &amp;</span>nbsp<span class="sym">; &amp;</span>nbsp<span class="sym">; &amp;</span>nbsp<span class="sym">; &amp;</span>nbsp<span class="sym">;</span>newrand <span class="sym">= (</span>fromIntegral newseed<span class="sym">) * (</span>max <span class="sym">/</span> fromIntegral im<span class="sym">)</span>
 <span class="sym">&amp;</span>nbsp<span class="sym">; &amp;</span>nbsp<span class="sym">; &amp;</span>nbsp<span class="sym">; &amp;</span>nbsp<span class="sym">; &amp;</span>nbsp<span class="sym">;</span>im <span class="sym">=</span> <span class="num">139968</span>
 <span class="sym">&amp;</span>nbsp<span class="sym">; &amp;</span>nbsp<span class="sym">; &amp;</span>nbsp<span class="sym">; &amp;</span>nbsp<span class="sym">; &amp;</span>nbsp<span class="sym">;</span>ia <span class="sym">=</span> <span class="num">3877</span>
 <span class="sym">&amp;</span>nbsp<span class="sym">; &amp;</span>nbsp<span class="sym">; &amp;</span>nbsp<span class="sym">; &amp;</span>nbsp<span class="sym">; &amp;</span>nbsp<span class="sym">;</span>ic <span class="sym">=</span> <span class="num">29573</span>
<span class="sym">&lt;/</span>PRE<span class="sym">&gt;</span>
