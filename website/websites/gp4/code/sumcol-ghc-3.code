<span class="slc">--</span>
<span class="slc">-- The Computer Language Shootout</span>
<span class="slc">-- http://shootout.alioth.debian.org</span>
<span class="slc">--</span>
<span class="slc">-- compile with : ghc -O Sumcol.hs -o sumcol</span>
<span class="slc">--</span>
<span class="slc">-- Contributed by Bryan Donlan</span>
<span class="slc">-- Modified by Spencer Janssen</span>

<span class="kwa">import qualified</span> Data.ByteString.Lazy.Char8 <span class="kwa">as</span> BS

main <span class="sym">=</span> print . sum' <span class="num">0</span> . BS.lines <span class="sym">=&lt;&lt;</span> BS.getContents
    <span class="kwa">where</span>
        sum' n <span class="sym">[] =</span> n
        sum' n <span class="sym">(</span>x<span class="sym">:</span>xs<span class="sym">) =</span> sum' <span class="sym">(</span>n <span class="sym">+</span> readInt x<span class="sym">)</span> xs
        readInt bs <span class="sym">=</span>
            <span class="kwa">case</span> BS.readInt bs <span class="kwa">of</span>
                Just <span class="sym">(</span>i<span class="sym">,</span> _<span class="sym">) -&gt;</span> i
