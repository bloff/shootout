<table width="100%" border="0" cellpadding="5" cellspacing="0"><tr><td bgcolor="#FFFFFF"><pre>
<I><FONT COLOR="#B22222">\ -*- mode: forth -*-
</FONT></I><I><FONT COLOR="#B22222">\ $Id: random-gforth.code,v 1.2 2005-10-29 23:09:24 igouy-guest Exp $
</FONT></I><I><FONT COLOR="#B22222">\ http://www.bagley.org/~doug/shootout/
</FONT></I><I><FONT COLOR="#B22222">\ from Jorge Acereda Maciá
</FONT></I>
0. argc @ 1<B><FONT COLOR="#5F9EA0">-</FONT></B> arg <B><FONT COLOR="#5F9EA0">&gt;</FONT></B>number <B><FONT COLOR="#5F9EA0">2drop</FONT></B> <B><FONT COLOR="#5F9EA0">drop</FONT></B> <B><FONT COLOR="#A020F0">constant</FONT></B> NUM

<B><FONT COLOR="#A020F0">: </FONT></B><B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">FIM</FONT></I></B></FONT></B> 1e 139968e f<B><FONT COLOR="#5F9EA0">/</FONT></B> POSTPONE FLITERAL ; immediate
<B><FONT COLOR="#A020F0">: </FONT></B><B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">IA</FONT></I></B></FONT></B> 3877 POSTPONE LITERAL ; immediate
<B><FONT COLOR="#A020F0">: </FONT></B><B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">IC</FONT></I></B></FONT></B> 29573 POSTPONE LITERAL ; immediate
<B><FONT COLOR="#A020F0">: </FONT></B><B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">IM</FONT></I></B></FONT></B> 139968 POSTPONE LITERAL ; immediate
42 value seed

<I><FONT COLOR="#B22222">\ n = the uth power of n1
</FONT></I><B><FONT COLOR="#A020F0">: </FONT></B><B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">pow</FONT></I></B></FONT></B> ( n1 u <B><FONT COLOR="#5F9EA0">-</FONT></B><B><FONT COLOR="#5F9EA0">-</FONT></B> n )
  1 <B><FONT COLOR="#5F9EA0">swap</FONT></B> 0 u<B><FONT COLOR="#5F9EA0">+</FONT></B><B><FONT COLOR="#A020F0">do</FONT></B> <B><FONT COLOR="#5F9EA0">over</FONT></B> <B><FONT COLOR="#5F9EA0">*</FONT></B> <B><FONT COLOR="#A020F0">loop</FONT></B> <B><FONT COLOR="#5F9EA0">nip</FONT></B> ;

<I><FONT COLOR="#B22222">\ print float r with n fixed decimal points
</FONT></I><B><FONT COLOR="#A020F0">: </FONT></B><B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">ffix</FONT></I></B></FONT></B> ( r n <B><FONT COLOR="#5F9EA0">-</FONT></B><B><FONT COLOR="#5F9EA0">-</FONT></B> )
  <B><FONT COLOR="#5F9EA0">dup</FONT></B> 10 <B><FONT COLOR="#5F9EA0">swap</FONT></B> pow 0 d<B><FONT COLOR="#5F9EA0">&gt;</FONT></B>f f<B><FONT COLOR="#5F9EA0">*</FONT></B> 0.5e0 f<B><FONT COLOR="#5F9EA0">+</FONT></B> f<B><FONT COLOR="#5F9EA0">&gt;</FONT></B>d
  &lt;&lt;# <B><FONT COLOR="#5F9EA0">rot</FONT></B> 0 ?<B><FONT COLOR="#A020F0">do</FONT></B> # <B><FONT COLOR="#A020F0">loop</FONT></B> [<B><FONT COLOR="#228B22">char</FONT></B>] . <B><FONT COLOR="#A020F0">hold</FONT></B> #s #<B><FONT COLOR="#5F9EA0">&gt;</FONT></B> type #<B><FONT COLOR="#5F9EA0">&gt;</FONT></B><B><FONT COLOR="#5F9EA0">&gt;</FONT></B> ;

<B><FONT COLOR="#A020F0">: </FONT></B><B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">gen-random</FONT></I></B></FONT></B> 
    s<B><FONT COLOR="#BC8F8F">&quot; seed IA * IC + IM mod dup to seed &quot;</FONT></B> evaluate
    s<B><FONT COLOR="#BC8F8F">&quot; 0 d&gt;f f* FIM f* &quot;</FONT></B> evaluate ; immediate 

<B><FONT COLOR="#A020F0">: </FONT></B><B><FONT COLOR="#0000FF"><B><I><FONT COLOR="#000000">main
</FONT></I></B></FONT></B>    10 SET<B><FONT COLOR="#5F9EA0">-</FONT></B>PRECISION
    0e NUM 0 <B><FONT COLOR="#A020F0">do</FONT></B> <B><FONT COLOR="#5F9EA0">fdrop</FONT></B> 100e gen<B><FONT COLOR="#5F9EA0">-</FONT></B>random <B><FONT COLOR="#A020F0">loop</FONT></B> 9 ffix cr ;

main <B><FONT COLOR="#5F9EA0">bye</FONT></B></pre></td></tr></table>
