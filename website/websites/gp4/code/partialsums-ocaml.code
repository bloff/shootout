<span class="com">(* The Computer Language Shootout</span>
<span class="com">   http://shootout.alioth.debian.org/</span>
<span class="com"></span>
<span class="com">   contributed by Johannes Wei√ül (OCaml version of Isaac Gouy's clean version)</span>
<span class="com">*)</span>

<span class="kwa">let rec</span> twoThirds k n sum <span class="sym">=</span>
  <span class="kwa">if</span> k <span class="sym">&lt;</span> n <span class="kwa">then</span>
    <span class="kwd">twoThirds</span><span class="sym">(</span>k <span class="sym">+</span>. <span class="num">1.0</span><span class="sym">)</span> <span class="kwd">n</span> <span class="sym">(</span>sum <span class="sym">+</span>. <span class="sym">((</span><span class="num">2.0</span> <span class="sym">/</span>. <span class="num">3.0</span><span class="sym">) **</span> k<span class="sym">))</span>
  <span class="kwa">else</span>
    sum

<span class="kwa">let rec</span> k05 k n sum <span class="sym">=</span>
  <span class="kwa">if</span> k <span class="sym">&lt;=</span> n <span class="kwa">then</span>
    <span class="kwd">k05</span> <span class="sym">(</span>k <span class="sym">+</span>. <span class="num">1.0</span><span class="sym">)</span> <span class="kwd">n</span> <span class="sym">(</span>sum <span class="sym">+</span>. <span class="sym">(</span>k <span class="sym">** (-</span><span class="num">0.5</span><span class="sym">)))</span>
  <span class="kwa">else</span>
    sum

<span class="kwa">let rec</span> kk1 k n sum <span class="sym">=</span>
  <span class="kwa">if</span> k <span class="sym">&lt;=</span> n <span class="kwa">then</span>
    <span class="kwd">kk1</span> <span class="sym">(</span>k <span class="sym">+</span>. <span class="num">1.0</span><span class="sym">)</span> <span class="kwd">n</span> <span class="sym">(</span>sum <span class="sym">+</span>. <span class="num">1.0</span> <span class="sym">/</span>. <span class="sym">(</span>k <span class="sym">*</span>. <span class="sym">(</span>k <span class="sym">+</span>. <span class="num">1.0</span><span class="sym">)))</span>
  <span class="kwa">else</span>
    sum

<span class="kwa">let rec</span> flintHills k n sum <span class="sym">=</span>
  <span class="kwa">if</span> k <span class="sym">&lt;=</span> n <span class="kwa">then</span>
    <span class="kwd">flintHills</span> <span class="sym">(</span>k <span class="sym">+</span>. <span class="num">1.0</span><span class="sym">)</span> <span class="kwd">n</span> <span class="sym">(</span>sum <span class="sym">+</span>. <span class="num">1.0</span> <span class="sym">/</span>. <span class="sym">((</span>k <span class="sym">**</span> <span class="num">3.0</span><span class="sym">) *</span>. <span class="sym">((</span>sin k<span class="sym">) **</span> <span class="num">2.0</span><span class="sym">)))</span>
  <span class="kwa">else</span>
    sum

<span class="kwa">let rec</span> cooksonHills k n sum <span class="sym">=</span>
  <span class="kwa">if</span> k <span class="sym">&lt;=</span> n <span class="kwa">then</span>
    <span class="kwd">cooksonHills</span> <span class="sym">(</span>k <span class="sym">+</span>. <span class="num">1.0</span><span class="sym">)</span> <span class="kwd">n</span> <span class="sym">(</span>sum <span class="sym">+</span>. <span class="num">1.0</span> <span class="sym">/</span>. <span class="sym">((</span>k <span class="sym">**</span> <span class="num">3.0</span><span class="sym">) *</span>. <span class="sym">((</span>cos k<span class="sym">) **</span> <span class="num">2.0</span><span class="sym">)))</span>
  <span class="kwa">else</span>
    sum

<span class="kwa">let rec</span> harmonic k n sum <span class="sym">=</span>
  <span class="kwa">if</span> k <span class="sym">&lt;=</span> n <span class="kwa">then</span>
    <span class="kwd">harmonic</span> <span class="sym">(</span>k <span class="sym">+</span>. <span class="num">1.0</span><span class="sym">)</span> <span class="kwd">n</span> <span class="sym">(</span>sum <span class="sym">+</span>. <span class="num">1.0</span> <span class="sym">/</span>. k<span class="sym">)</span>
  <span class="kwa">else</span>
    sum

<span class="kwa">let rec</span> riemannZeta k n sum <span class="sym">=</span>
  <span class="kwa">if</span> k <span class="sym">&lt;=</span> n <span class="kwa">then</span>
    <span class="kwd">riemannZeta</span> <span class="sym">(</span>k <span class="sym">+</span>. <span class="num">1.0</span><span class="sym">)</span> <span class="kwd">n</span> <span class="sym">(</span>sum <span class="sym">+</span>. <span class="num">1.0</span> <span class="sym">/</span>. <span class="sym">(</span>k <span class="sym">**</span> <span class="num">2.0</span><span class="sym">))</span>
  <span class="kwa">else</span>
    sum

<span class="kwa">let rec</span> altHarmonic k n a sum <span class="sym">=</span>
  <span class="kwa">if</span> k <span class="sym">&lt;=</span> n <span class="kwa">then</span>
    <span class="kwd">altHarmonic</span> <span class="sym">(</span>k <span class="sym">+</span>. <span class="num">1.0</span><span class="sym">)</span> <span class="kwd">n</span> <span class="sym">(-</span>.a<span class="sym">) (</span>sum <span class="sym">+</span>. a <span class="sym">/</span>. k<span class="sym">)</span>
  <span class="kwa">else</span>
    sum

<span class="kwa">let rec</span> gregory k n a sum <span class="sym">=</span>
  <span class="kwa">if</span> k <span class="sym">&lt;=</span> n <span class="kwa">then</span>
    <span class="kwd">gregory</span> <span class="sym">(</span>k <span class="sym">+</span>. <span class="num">1.0</span><span class="sym">)</span> <span class="kwd">n</span> <span class="sym">(-</span>.a<span class="sym">) (</span>sum <span class="sym">+</span>. a <span class="sym">/</span>. <span class="sym">(</span><span class="num">2.0</span> <span class="sym">*</span>. k <span class="sym">-</span>. <span class="num">1.0</span><span class="sym">))</span>
  <span class="kwa">else</span>
    sum
<span class="sym">;;</span>

<span class="kwa">if</span> Array.length Sys.argv <span class="sym">&gt;</span> <span class="num">1</span> <span class="kwa">then</span>
  <span class="kwa">let</span> n <span class="sym">=</span> float_of_string Sys.argv.<span class="sym">(</span><span class="num">1</span><span class="sym">)</span> <span class="kwa">in</span>
  Printf.printf <span class="str">&quot;%.9f</span><span class="esc">\t</span><span class="str">(2/3)^k</span><span class="esc">\n</span><span class="str">&quot;</span> <span class="sym">(</span>twoThirds <span class="num">0.0</span> n <span class="num">0.0</span><span class="sym">) ;</span>
  Printf.printf <span class="str">&quot;%.9f</span><span class="esc">\t</span><span class="str">k^-0.5</span><span class="esc">\n</span><span class="str">&quot;</span> <span class="sym">(</span>k05 <span class="num">1.0</span> n <span class="num">0.0</span><span class="sym">) ;</span>
  Printf.printf <span class="str">&quot;%.9f</span><span class="esc">\t</span><span class="str">1/k(k+1)</span><span class="esc">\n</span><span class="str">&quot;</span> <span class="sym">(</span>kk1 <span class="num">1.0</span> n <span class="num">0.0</span><span class="sym">) ;</span>
  Printf.printf <span class="str">&quot;%.9f</span><span class="esc">\t</span><span class="str">Flint Hills</span><span class="esc">\n</span><span class="str">&quot;</span> <span class="sym">(</span>flintHills <span class="num">1.0</span> n <span class="num">0.0</span><span class="sym">) ;</span>
  Printf.printf <span class="str">&quot;%.9f</span><span class="esc">\t</span><span class="str">Cookson Hills</span><span class="esc">\n</span><span class="str">&quot;</span> <span class="sym">(</span>cooksonHills <span class="num">1.0</span> n <span class="num">0.0</span><span class="sym">) ;</span>
  Printf.printf <span class="str">&quot;%.9f</span><span class="esc">\t</span><span class="str">Harmonic</span><span class="esc">\n</span><span class="str">&quot;</span> <span class="sym">(</span>harmonic <span class="num">1.0</span> n <span class="num">0.0</span><span class="sym">) ;</span>
  Printf.printf <span class="str">&quot;%.9f</span><span class="esc">\t</span><span class="str">Riemann Zeta</span><span class="esc">\n</span><span class="str">&quot;</span> <span class="sym">(</span>riemannZeta <span class="num">1.0</span> n <span class="num">0.0</span><span class="sym">) ;</span>
  Printf.printf <span class="str">&quot;%.9f</span><span class="esc">\t</span><span class="str">Alternating Harmonic</span><span class="esc">\n</span><span class="str">&quot;</span> <span class="sym">(</span>altHarmonic <span class="num">1.0</span> n <span class="num">1.0 0.0</span><span class="sym">) ;</span>
  Printf.printf <span class="str">&quot;%.9f</span><span class="esc">\t</span><span class="str">Gregory</span><span class="esc">\n</span><span class="str">&quot;</span> <span class="sym">(</span>gregory <span class="num">1.0</span> n <span class="num">1.0 0.0</span><span class="sym">)</span>
