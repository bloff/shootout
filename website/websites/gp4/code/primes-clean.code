<span class="hl kwa">module</span> primes
<span class="hl kwa">import</span> StdEnv<span class="hl sym">,</span> LanguageShootout

Start
   <span class="hl sym">=</span> lines <span class="hl sym">(</span><span class="hl num">10</span><span class="hl sym">*</span>argi<span class="hl sym">)(</span><span class="hl num">50</span><span class="hl sym">*</span>argi<span class="hl sym">)(</span><span class="hl num">10</span><span class="hl sym">*</span>argi<span class="hl sym">)</span>
        <span class="hl sym">(</span><span class="hl str">&quot;1st prime is &quot;</span> <span class="hl sym">+++</span> primeString <span class="hl num">1</span> <span class="hl sym">+++</span> <span class="hl str">&quot;2nd prime is &quot;</span> <span class="hl sym">+++</span> primeString <span class="hl num">2</span><span class="hl sym">)</span>

   <span class="hl kwa">where</span>
   primeString i <span class="hl sym">=</span> toString <span class="hl sym">(</span>prime i<span class="hl sym">) +++</span> <span class="hl str">&quot;\n&quot;</span>
   lines i n j s
      <span class="hl sym">|</span> i <span class="hl sym">&lt;=</span> n   <span class="hl sym">=</span> lines <span class="hl sym">(</span>i<span class="hl sym">+</span>j<span class="hl sym">)</span> n j
         <span class="hl sym">(</span>s <span class="hl sym">+++ (</span>toString i <span class="hl sym">+++</span> <span class="hl str">&quot;th prime is &quot;</span> <span class="hl sym">+++</span> primeString i<span class="hl sym">))</span>
      <span class="hl sym">=</span> s

isPrime k
   <span class="hl sym">|</span> k <span class="hl sym">&lt;</span> <span class="hl num">2</span>         <span class="hl sym">=</span> <span class="hl kwa">False</span>
   <span class="hl sym">|</span> k <span class="hl sym">&lt;</span> <span class="hl num">4</span>         <span class="hl sym">=</span> <span class="hl kwa">True</span>
   <span class="hl sym">|</span> isEven k      <span class="hl sym">=</span> <span class="hl kwa">False</span>
   <span class="hl sym">|</span> isWrongForm   <span class="hl sym">=</span> <span class="hl kwa">False</span>
                   <span class="hl sym">=</span> oddloop <span class="hl num">3</span>

   <span class="hl kwa">where</span>
   isWrongForm <span class="hl sym">= (</span>k<span class="hl sym">+</span><span class="hl num">1</span><span class="hl sym">)</span> rem <span class="hl num">6</span> <span class="hl sym">&lt;&gt;</span> <span class="hl num">0</span> <span class="hl sym">&amp;&amp; (</span>k<span class="hl sym">-</span><span class="hl num">1</span><span class="hl sym">)</span> rem <span class="hl num">6</span> <span class="hl sym">&lt;&gt;</span> <span class="hl num">0</span>
   limit      <span class="hl sym">=</span> toInt <span class="hl sym">(</span>sqrt <span class="hl sym">(</span>toReal k<span class="hl sym">))</span>
   oddloop i
      <span class="hl sym">|</span> k rem i <span class="hl sym">==</span> <span class="hl num">0</span>   <span class="hl sym">=</span> <span class="hl kwa">False</span>
      <span class="hl sym">|</span> i <span class="hl sym">&lt;=</span> limit     <span class="hl sym">=</span> oddloop <span class="hl sym">(</span>i<span class="hl sym">+</span><span class="hl num">2</span><span class="hl sym">)</span>
                       <span class="hl sym">=</span> <span class="hl kwa">True</span>


prime n <span class="hl sym">=</span> loop <span class="hl num">0 1</span>
   <span class="hl kwa">where</span>
   loop count k
      <span class="hl sym">|</span> count <span class="hl sym">&lt;</span> n
         <span class="hl sym">|</span> isPrime k   <span class="hl sym">=</span> loop <span class="hl sym">(</span>count<span class="hl sym">+</span><span class="hl num">1</span><span class="hl sym">) (</span>k<span class="hl sym">+</span><span class="hl num">1</span><span class="hl sym">)</span>
                       <span class="hl sym">=</span> loop  count    <span class="hl sym">(</span>k<span class="hl sym">+</span><span class="hl num">1</span><span class="hl sym">)</span>
      <span class="hl sym">=</span> k<span class="hl sym">-</span><span class="hl num">1</span>
