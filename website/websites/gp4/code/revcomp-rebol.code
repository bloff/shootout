rebol<span class="sym">[</span>
	Title<span class="sym">:</span>  <span class="str">&quot;reverse-complement&quot;</span>
	Author<span class="sym">:</span> <span class="str">&quot;Tom Conlin&quot;</span>
	Date<span class="sym">:</span>    <span class="num">2005</span><span class="sym">-</span><span class="num">12</span><span class="sym">-</span><span class="num">2</span>
	purpose<span class="sym">: {</span>	The Computer Language Shootout
	            http<span class="sym">:</span><span class="slc">//shootout.alioth.debian.org/gp4/benchmark.php?test=knucleotide&amp;lang=rebol&amp;id=0</span>
	         <span class="sym">}</span>
	summary<span class="sym">: [</span>rebol reverse<span class="sym">-</span>complement tom conlin <span class="num">2005</span><span class="sym">-</span><span class="num">12</span><span class="sym">-</span><span class="num">2</span><span class="sym">]</span>
    version<span class="sym">:</span> <span class="num">0.1</span>
<span class="sym">]</span>
flip<span class="sym">:</span> does <span class="sym">[</span>
    reverse<span class="sym">/</span>part <span class="sym">:</span>there <span class="sym">:</span>here
    there<span class="sym">:</span> skip <span class="sym">:</span>there <span class="num">60</span>
    word<span class="sym">: :</span>there
    forskip word <span class="num">61</span><span class="sym">[</span>
        there<span class="sym">: :</span>word
        insert <span class="sym">:</span>there <span class="str">&quot;^/&quot;</span>
        there<span class="sym">:</span> next <span class="sym">:</span>there
        all<span class="sym">[</span><span class="kwa">not</span> tail? <span class="sym">:</span>here
            here<span class="sym">:</span> next <span class="sym">:</span>here
            <span class="sym">:</span>there <span class="sym">&lt;= :</span>here <span class="kwa">break</span>
        <span class="sym">]</span>
    <span class="sym">]</span>
    either tail? <span class="sym">:</span>here
        <span class="sym">[</span>insert <span class="sym">:</span>here <span class="str">&quot;^/&quot;</span><span class="sym">]</span>
        <span class="sym">[</span>   <span class="kwa">if not</span> find<span class="sym">/</span>match back <span class="sym">:</span>here <span class="str">&quot;^/&quot;</span><span class="sym">[</span>
               insert back <span class="sym">:</span>here <span class="str">&quot;^/&quot;</span> here<span class="sym">:</span> next <span class="sym">:</span>here
            <span class="sym">]</span>
        <span class="sym">]</span>
<span class="sym">]</span>
rule<span class="sym">: [</span>
    here<span class="sym">:</span>
    <span class="sym">[</span><span class="str">&quot;A&quot;</span> <span class="sym">(</span>change <span class="sym">:</span>here <span class="str">&quot;T&quot;</span><span class="sym">)] | [</span><span class="str">&quot;C&quot;</span> <span class="sym">(</span>change <span class="sym">:</span>here <span class="str">&quot;G&quot;</span><span class="sym">)]|</span>
    <span class="sym">[</span><span class="str">&quot;G&quot;</span> <span class="sym">(</span>change <span class="sym">:</span>here <span class="str">&quot;C&quot;</span><span class="sym">)] | [</span><span class="str">&quot;T&quot;</span> <span class="sym">(</span>change <span class="sym">:</span>here <span class="str">&quot;A&quot;</span><span class="sym">)]|</span>
    <span class="sym">[</span><span class="str">&quot;^/&quot;</span><span class="sym">(</span>remove <span class="sym">:</span>here<span class="sym">) :</span>here<span class="sym">]|</span>
    <span class="sym">[</span><span class="str">&quot;U&quot;</span> <span class="sym">(</span>change <span class="sym">:</span>here <span class="str">&quot;A&quot;</span><span class="sym">)] | [</span><span class="str">&quot;M&quot;</span> <span class="sym">(</span>change <span class="sym">:</span>here <span class="str">&quot;K&quot;</span><span class="sym">)]|</span>
    <span class="sym">[</span><span class="str">&quot;R&quot;</span> <span class="sym">(</span>change <span class="sym">:</span>here <span class="str">&quot;Y&quot;</span><span class="sym">)] | [</span><span class="str">&quot;Y&quot;</span> <span class="sym">(</span>change <span class="sym">:</span>here <span class="str">&quot;R&quot;</span><span class="sym">)]|</span>
    <span class="sym">[</span><span class="str">&quot;K&quot;</span> <span class="sym">(</span>change <span class="sym">:</span>here <span class="str">&quot;M&quot;</span><span class="sym">)] | [</span><span class="str">&quot;V&quot;</span> <span class="sym">(</span>change <span class="sym">:</span>here <span class="str">&quot;B&quot;</span><span class="sym">)]|</span>
    <span class="sym">[</span><span class="str">&quot;H&quot;</span> <span class="sym">(</span>change <span class="sym">:</span>here <span class="str">&quot;D&quot;</span><span class="sym">)] | [</span><span class="str">&quot;D&quot;</span> <span class="sym">(</span>change <span class="sym">:</span>here <span class="str">&quot;H&quot;</span><span class="sym">)]|</span>
    <span class="sym">[</span><span class="str">&quot;B&quot;</span> <span class="sym">(</span>change <span class="sym">:</span>here <span class="str">&quot;V&quot;</span><span class="sym">)] |</span>  <span class="str">&quot;W&quot;</span> <span class="sym">|</span> <span class="str">&quot;S&quot;</span> <span class="sym">|</span> <span class="str">&quot;N&quot;</span> <span class="sym">|</span>
    <span class="sym">[</span><span class="str">&quot;&gt;&quot;</span> <span class="sym">(</span>all<span class="sym">[:</span>here <span class="sym">&lt;&gt; :</span>there flip<span class="sym">]</span>
          all<span class="sym">[</span><span class="kwa">not</span> tail? <span class="sym">:</span>here here<span class="sym">:</span> find<span class="sym">/</span>tail next <span class="sym">:</span>here <span class="str">&quot;^/&quot;</span><span class="sym">]</span>
         <span class="sym">):</span>here there<span class="sym">:</span>
    <span class="sym">]</span>
<span class="sym">]</span>
set<span class="sym">-</span>modes system<span class="sym">/</span>ports<span class="sym">/</span>input<span class="sym">[</span>lines<span class="sym">:</span> <span class="kwa">false</span> binary<span class="sym">:</span> <span class="kwa">false</span><span class="sym">]</span>
fasta<span class="sym">:</span> copy system<span class="sym">/</span>ports<span class="sym">/</span>input
parse fasta<span class="sym">[</span>there<span class="sym">:</span> some <span class="kwd">rule</span> <span class="sym">(</span>flip<span class="sym">)]</span>
insert system<span class="sym">/</span>ports<span class="sym">/</span>output fasta
