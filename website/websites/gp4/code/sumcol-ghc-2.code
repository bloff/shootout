<span class="slc">--</span>
<span class="slc">-- The Computer Language Shootout</span>
<span class="slc">-- http://shootout.alioth.debian.org/</span>
<span class="slc">--</span>
<span class="slc">-- compile with : ghc -O2 -o SumF SumF.hs</span>
<span class="slc">-- To get better performance set default heap size to 10MB</span>
<span class="slc">-- i.e. invoke as : ./SumF +RTS -H10M &lt;input_file.txt</span>
<span class="slc">-- contributed by Greg Buchholz</span>
<span class="slc">-- modified by Mirko Rahn</span>
<span class="slc">--</span>

<span class="kwa">import</span> <span class="kwb">Char</span><span class="sym">(</span> ord <span class="sym">)</span>

main <span class="sym">::</span> IO <span class="sym">()</span>
main <span class="sym">=</span> getContents <span class="sym">&gt;&gt;=</span> print . accP <span class="num">0 0</span>

accP <span class="sym">::</span> <span class="kwb">Int</span> <span class="sym">-&gt;</span> <span class="kwb">Int</span> <span class="sym">-&gt;</span> String <span class="sym">-&gt;</span> <span class="kwb">Int</span>
accP before this  <span class="sym">[]       =</span>       before<span class="sym">+</span>this
accP before this <span class="sym">(</span><span class="str">'\n'</span><span class="sym">:</span>xs<span class="sym">) =</span> accP <span class="sym">(</span>before<span class="sym">+</span>this<span class="sym">)</span> <span class="num">0</span>                        xs
accP before this <span class="sym">(</span><span class="str">'-'</span> <span class="sym">:</span>xs<span class="sym">) =</span> accN  before       this                     xs
accP before this <span class="sym">(</span>x   <span class="sym">:</span>xs<span class="sym">) =</span> accP  before      <span class="sym">(</span>this<span class="sym">*</span><span class="num">10</span><span class="sym">+</span>ord<span class="sym">(</span>x<span class="sym">)-</span>ord<span class="sym">(</span><span class="str">'0'</span><span class="sym">))</span> xs

accN <span class="sym">::</span> <span class="kwb">Int</span> <span class="sym">-&gt;</span> <span class="kwb">Int</span> <span class="sym">-&gt;</span> String <span class="sym">-&gt;</span> <span class="kwb">Int</span>
accN before this  <span class="sym">[]       =</span>       before<span class="sym">-</span>this
accN before this <span class="sym">(</span><span class="str">'\n'</span><span class="sym">:</span>xs<span class="sym">) =</span> accP <span class="sym">(</span>before<span class="sym">-</span>this<span class="sym">)</span> <span class="num">0</span>                        xs
accN before this <span class="sym">(</span>x   <span class="sym">:</span>xs<span class="sym">) =</span> accN  before      <span class="sym">(</span>this<span class="sym">*</span><span class="num">10</span><span class="sym">+</span>ord<span class="sym">(</span>x<span class="sym">)-</span>ord<span class="sym">(</span><span class="str">'0'</span><span class="sym">))</span> xs
