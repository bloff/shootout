<span class="hl kwa">import</span> System
<span class="hl kwa">import</span> Data.List<span class="hl sym">(</span>foldl<span class="hl str">')</span>
<span class="hl str">import GHC.Base</span>
<span class="hl str"></span>
<span class="hl str">{-  The Computer Language Shootout</span>
<span class="hl str">    http://shootout.alioth.debian.org/</span>
<span class="hl str">    contributed by Sebastian Sylvan</span>
<span class="hl str">-}</span>
<span class="hl str"></span>
<span class="hl str">{-# INLINE rotate #-}</span>
<span class="hl str">rotate n (x:xs) = let (a,b) = splitAt (n-1) xs in a ++ x : b</span>
<span class="hl str"></span>
<span class="hl str">{-# INLINE perms #-}</span>
<span class="hl str">perms l = foldr perm'</span> <span class="hl sym">[</span>l<span class="hl sym">] [</span><span class="hl num">2</span>..length l<span class="hl sym">]</span>
    <span class="hl kwa">where</span> perm<span class="hl str">' n ls = concat [take n (iterate (rotate n) l) | l &lt;- ls]</span>
<span class="hl str"></span>
<span class="hl str">{-# INLINE flop #-}</span>
<span class="hl str">flop (1:_) = 0</span>
<span class="hl str">flop xs = 1 + flop (rev xs)</span>
<span class="hl str"></span>
<span class="hl str">{-# INLINE rev #-}</span>
<span class="hl str">rev (x:xs) = reverse a ++ x : b</span>
<span class="hl str">      where (a,b) = splitAt (x-1) xs</span>
<span class="hl str"></span>
<span class="hl str">fannuch xs = foldl'</span> max <span class="hl num">0</span> $ map flop xs

main <span class="hl sym">=</span> <span class="hl kwa">do</span> <span class="hl sym">[</span>n<span class="hl sym">] &lt;-</span> getArgs
          <span class="hl kwa">let</span> xs <span class="hl sym">=</span> perms <span class="hl sym">[</span><span class="hl num">1</span>..read n<span class="hl sym">]</span>
          putStr $ unlines $ map <span class="hl sym">(</span>concatMap show<span class="hl sym">)</span> $ take <span class="hl num">30</span> xs
          putStrLn $ <span class="hl str">&quot;Pfannkuchen(&quot;</span> <span class="hl sym">++</span> n <span class="hl sym">++</span> <span class="hl str">&quot;) = &quot;</span> <span class="hl sym">++</span> show <span class="hl sym">(</span>fannuch xs<span class="hl sym">)</span>
