<span class="sym">/*</span> The Computer Language Shootout
   http<span class="sym">://</span>shootout.alioth.debian.org<span class="sym">/</span>
   contributed by Isaac Gouy <span class="sym">(</span>Clean novice<span class="sym">) */</span>

<span class="kwa">module</span> partialsums
<span class="kwa">import</span> StdEnv<span class="sym">,</span> LanguageShootout

Start <span class="sym">=</span>
   toString <span class="sym">(</span>twoThirds <span class="num">0.0</span> n <span class="num">0.0</span><span class="sym">)</span>        <span class="str">&quot;(2/3)^k&quot;</span> <span class="sym">+++</span>
   toString <span class="sym">(</span>k05 <span class="num">1.0</span> n <span class="num">0.0</span><span class="sym">)</span>              <span class="str">&quot;k^-0.5&quot;</span> <span class="sym">+++</span>
   toString <span class="sym">(</span>kk1 <span class="num">1.0</span> n <span class="num">0.0</span><span class="sym">)</span>              <span class="str">&quot;1/k(k+1)&quot;</span> <span class="sym">+++</span>
   toString <span class="sym">(</span>flintHills <span class="num">1.0</span> n <span class="num">0.0</span><span class="sym">)</span>       <span class="str">&quot;Flint Hills&quot;</span> <span class="sym">+++</span>
   toString <span class="sym">(</span>cooksonHills <span class="num">1.0</span> n <span class="num">0.0</span><span class="sym">)</span>     <span class="str">&quot;Cookson Hills&quot;</span> <span class="sym">+++</span>
   toString <span class="sym">(</span>harmonic <span class="num">1.0</span> n <span class="num">0.0</span><span class="sym">)</span>         <span class="str">&quot;Harmonic&quot;</span> <span class="sym">+++</span>
   toString <span class="sym">(</span>riemannZeta <span class="num">1.0</span> n <span class="num">0.0</span><span class="sym">)</span>      <span class="str">&quot;Riemann Zeta&quot;</span> <span class="sym">+++</span>
   toString <span class="sym">(</span>altHarmonic <span class="num">1.0</span> n <span class="num">1.0 0.0</span><span class="sym">)</span>  <span class="str">&quot;Alternating Harmonic&quot;</span> <span class="sym">+++</span>
   toString <span class="sym">(</span>gregory <span class="num">1.0</span> n <span class="num">1.0 0.0</span><span class="sym">)</span>      <span class="str">&quot;Gregory&quot;</span>
   <span class="kwa">where</span>
      n <span class="sym">=</span> toReal argi
      toString a s <span class="sym">=</span> toStringWith <span class="num">9</span> a <span class="sym">+++</span> <span class="str">&quot;\t&quot;</span> <span class="sym">+++</span> s <span class="sym">+++</span> <span class="str">&quot;\n&quot;</span>

twoThirds k n sum
   <span class="sym">|</span> k <span class="sym">&lt;</span> n    <span class="sym">=</span> twoThirds<span class="sym">(</span>k<span class="sym">+</span><span class="num">1.0</span><span class="sym">)</span> n <span class="sym">(</span>sum <span class="sym">+ ((</span><span class="num">2.0</span><span class="sym">/</span><span class="num">3.0</span><span class="sym">)</span>^k<span class="sym">))</span>
              <span class="sym">=</span> sum

k05 k n sum
   <span class="sym">|</span> k <span class="sym">&lt;=</span> n   <span class="sym">=</span> k05<span class="sym">(</span>k<span class="sym">+</span><span class="num">1.0</span><span class="sym">)</span> n <span class="sym">(</span>sum <span class="sym">+ (</span>k^ ~<span class="num">0.5</span><span class="sym">))</span>
              <span class="sym">=</span> sum

kk1 k n sum
   <span class="sym">|</span> k <span class="sym">&lt;=</span> n   <span class="sym">=</span> kk1<span class="sym">(</span>k<span class="sym">+</span><span class="num">1.0</span><span class="sym">)</span> n <span class="sym">(</span>sum <span class="sym">+</span> <span class="num">1.0</span><span class="sym">/(</span>k<span class="sym">*(</span>k<span class="sym">+</span><span class="num">1.0</span><span class="sym">)))</span>
              <span class="sym">=</span> sum

flintHills k n sum
   <span class="sym">|</span> k <span class="sym">&lt;=</span> n   <span class="sym">=</span> flintHills<span class="sym">(</span>k<span class="sym">+</span><span class="num">1.0</span><span class="sym">)</span> n <span class="sym">(</span>sum <span class="sym">+</span> <span class="num">1.0</span><span class="sym">/((</span>k^<span class="num">3.0</span><span class="sym">)*((</span>sin k<span class="sym">)</span>^<span class="num">2.0</span><span class="sym">)))</span>
              <span class="sym">=</span> sum

cooksonHills k n sum
   <span class="sym">|</span> k <span class="sym">&lt;=</span> n   <span class="sym">=</span> cooksonHills<span class="sym">(</span>k<span class="sym">+</span><span class="num">1.0</span><span class="sym">)</span> n <span class="sym">(</span>sum <span class="sym">+</span> <span class="num">1.0</span><span class="sym">/((</span>k^<span class="num">3.0</span><span class="sym">)*((</span>cos k<span class="sym">)</span>^<span class="num">2.0</span><span class="sym">)))</span>
              <span class="sym">=</span> sum

harmonic k n sum
   <span class="sym">|</span> k <span class="sym">&lt;=</span> n   <span class="sym">=</span> harmonic<span class="sym">(</span>k<span class="sym">+</span><span class="num">1.0</span><span class="sym">)</span> n <span class="sym">(</span>sum <span class="sym">+</span> <span class="num">1.0</span><span class="sym">/</span>k<span class="sym">)</span>
              <span class="sym">=</span> sum

riemannZeta k n sum
   <span class="sym">|</span> k <span class="sym">&lt;=</span> n   <span class="sym">=</span> riemannZeta<span class="sym">(</span>k<span class="sym">+</span><span class="num">1.0</span><span class="sym">)</span> n <span class="sym">(</span>sum <span class="sym">+</span> <span class="num">1.0</span><span class="sym">/(</span>k^<span class="num">2.0</span><span class="sym">))</span>
              <span class="sym">=</span> sum

altHarmonic <span class="sym">:: !</span>Real <span class="sym">!</span>Real <span class="sym">!</span>Real <span class="sym">!</span>Real <span class="sym">-&gt;</span> Real
altHarmonic k n a sum
   <span class="sym">|</span> k <span class="sym">&lt;=</span> n   <span class="sym">=</span> altHarmonic<span class="sym">(</span>k<span class="sym">+</span><span class="num">1.0</span><span class="sym">)</span> n <span class="sym">(</span>~a<span class="sym">)(</span>sum <span class="sym">+</span> a<span class="sym">/</span>k<span class="sym">)</span>
              <span class="sym">=</span> sum

gregory <span class="sym">:: !</span>Real <span class="sym">!</span>Real <span class="sym">!</span>Real <span class="sym">!</span>Real <span class="sym">-&gt;</span> Real
gregory k n a sum
   <span class="sym">|</span> k <span class="sym">&lt;=</span> n   <span class="sym">=</span> gregory<span class="sym">(</span>k<span class="sym">+</span><span class="num">1.0</span><span class="sym">)</span> n <span class="sym">(</span>~a<span class="sym">)(</span>sum <span class="sym">+</span> a<span class="sym">/(</span><span class="num">2.0</span><span class="sym">*</span>k <span class="sym">-</span> <span class="num">1.0</span><span class="sym">))</span>
              <span class="sym">=</span> sum


