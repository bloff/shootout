<span class="hl com">&quot;* The Computer Language Benchmark Games</span>
<span class="hl com">    http://shootout.alioth.debian.org/</span>
<span class="hl com">    contributed by Isaac Gouy</span>
<span class="hl com">    modified by Eliot Miranda *&quot;</span><span class="hl sym">!</span>

<span class="hl com">&quot;* SPLITFILE=Tests.st *&quot;</span><span class="hl sym">!</span>

Object subclass<span class="hl sym">:#</span>Tests
   instanceVariableNames<span class="hl sym">:</span><span class="hl str">''</span>
   classVariableNames<span class="hl sym">:</span><span class="hl str">''</span>
   poolDictionaries<span class="hl sym">:</span><span class="hl str">''</span>
   category<span class="hl sym">:</span><span class="hl str">'benchmarks-game'</span><span class="hl sym">!</span>

<span class="hl sym">!</span>Tests class methodsFor<span class="hl sym">:</span> <span class="hl str">'benchmarks-game'</span><span class="hl sym">!</span>
partialsums<span class="hl sym">:</span> n to<span class="hl sym">:</span> output   <span class="hl sym">|</span> a1 a2 a3 a4 a5 a6 a7 a8 a9 twothirds alt <span class="hl sym">|</span>   a1 <span class="hl sym">:=</span> a2 <span class="hl sym">:=</span> a3 <span class="hl sym">:=</span> a4 <span class="hl sym">:=</span> a5 <span class="hl sym">:=</span> a6 <span class="hl sym">:=</span> a7 <span class="hl sym">:=</span> a8 <span class="hl sym">:=</span> a9 <span class="hl sym">:=</span> <span class="hl num">0.0</span><span class="hl sym">.</span>   twothirds <span class="hl sym">:=</span> <span class="hl num">2.0</span><span class="hl sym">/</span><span class="hl num">3.0</span><span class="hl sym">.</span>   alt <span class="hl sym">:= -</span><span class="hl num">1.0</span><span class="hl sym">.</span>   <span class="hl num">1.0</span> to<span class="hl sym">:</span> n do<span class="hl sym">: [:</span>k<span class="hl sym">| |</span> k2 k3 sk ck <span class="hl sym">|</span>      k2 <span class="hl sym">:=</span> k<span class="hl sym">*</span>k<span class="hl sym">.</span>      k3 <span class="hl sym">:=</span> k2<span class="hl sym">*</span>k<span class="hl sym">.</span>      sk <span class="hl sym">:=</span> k sin<span class="hl sym">.</span>      ck <span class="hl sym">:=</span> k cos<span class="hl sym">.</span>      alt <span class="hl sym">:= -</span><span class="hl num">1.0</span> <span class="hl sym">*</span> alt<span class="hl sym">.</span>      a1 <span class="hl sym">:=</span> a1 <span class="hl sym">+ ([</span>twothirds raisedTo<span class="hl sym">:</span> k <span class="hl sym">-</span> <span class="hl num">1.0</span><span class="hl sym">]</span> on<span class="hl sym">:</span> GenericException do<span class="hl sym">: [</span><span class="hl num">0.0</span><span class="hl sym">]).</span>      a2 <span class="hl sym">:=</span> a2 <span class="hl sym">+ (</span>k raisedTo<span class="hl sym">: -</span><span class="hl num">0.5</span><span class="hl sym">).</span>      a3 <span class="hl sym">:=</span> a3 <span class="hl sym">+ (</span><span class="hl num">1.0</span><span class="hl sym">/(</span>k<span class="hl sym">*(</span>k<span class="hl sym">+</span><span class="hl num">1.0</span><span class="hl sym">))).</span>      a4 <span class="hl sym">:=</span> a4 <span class="hl sym">+ (</span><span class="hl num">1.0</span><span class="hl sym">/(</span>k3<span class="hl sym">*</span>sk<span class="hl sym">*</span>sk<span class="hl sym">)).</span>      a5 <span class="hl sym">:=</span> a5 <span class="hl sym">+ (</span><span class="hl num">1.0</span><span class="hl sym">/(</span>k3<span class="hl sym">*</span>ck<span class="hl sym">*</span>ck<span class="hl sym">)).</span>      a6 <span class="hl sym">:=</span> a6 <span class="hl sym">+ (</span><span class="hl num">1.0</span><span class="hl sym">/</span>k<span class="hl sym">).</span>      a7 <span class="hl sym">:=</span> a7 <span class="hl sym">+ (</span><span class="hl num">1.0</span><span class="hl sym">/</span>k2<span class="hl sym">).</span>      a8 <span class="hl sym">:=</span> a8 <span class="hl sym">+ (</span>alt<span class="hl sym">/</span>k<span class="hl sym">).</span>      a9 <span class="hl sym">:=</span> a9 <span class="hl sym">+ (</span>alt<span class="hl sym">/(</span><span class="hl num">2.0</span><span class="hl sym">*</span>k <span class="hl sym">-</span> <span class="hl num">1.0</span><span class="hl sym">))].</span>

   <span class="hl kwa">self</span> print<span class="hl sym">:</span> a1 withName<span class="hl sym">:</span> <span class="hl str">'(2/3)^k'</span> to<span class="hl sym">:</span> output<span class="hl sym">.</span>
   <span class="hl kwa">self</span> print<span class="hl sym">:</span> a2 withName<span class="hl sym">:</span> <span class="hl str">'k^-0.5'</span> to<span class="hl sym">:</span> output<span class="hl sym">.</span>
   <span class="hl kwa">self</span> print<span class="hl sym">:</span> a3 withName<span class="hl sym">:</span> <span class="hl str">'1/k(k+1)'</span> to<span class="hl sym">:</span> output<span class="hl sym">.</span>
   <span class="hl kwa">self</span> print<span class="hl sym">:</span> a4 withName<span class="hl sym">:</span> <span class="hl str">'Flint Hills'</span> to<span class="hl sym">:</span> output<span class="hl sym">.</span>
   <span class="hl kwa">self</span> print<span class="hl sym">:</span> a5 withName<span class="hl sym">:</span> <span class="hl str">'Cookson Hills'</span> to<span class="hl sym">:</span> output<span class="hl sym">.</span>
   <span class="hl kwa">self</span> print<span class="hl sym">:</span> a6 withName<span class="hl sym">:</span> <span class="hl str">'Harmonic'</span> to<span class="hl sym">:</span> output<span class="hl sym">.</span>
   <span class="hl kwa">self</span> print<span class="hl sym">:</span> a7 withName<span class="hl sym">:</span> <span class="hl str">'Riemann Zeta'</span> to<span class="hl sym">:</span> output<span class="hl sym">.</span>
   <span class="hl kwa">self</span> print<span class="hl sym">:</span> a8 withName<span class="hl sym">:</span> <span class="hl str">'Alternating Harmonic'</span> to<span class="hl sym">:</span> output<span class="hl sym">.</span>
   <span class="hl kwa">self</span> print<span class="hl sym">:</span> a9 withName<span class="hl sym">:</span> <span class="hl str">'Gregory'</span> to<span class="hl sym">:</span> output
<span class="hl sym">!</span>

print<span class="hl sym">:</span> number withName<span class="hl sym">:</span> name to<span class="hl sym">:</span> output
   output nextPutAll<span class="hl sym">: (</span>number printfPrintString<span class="hl sym">:</span><span class="hl str">'%0.9f'</span><span class="hl sym">);</span> tab<span class="hl sym">;</span> nextPutAll<span class="hl sym">:</span> name<span class="hl sym">;</span> cr
<span class="hl sym">!</span>
main   <span class="hl kwa">self</span> partialsums<span class="hl sym">:</span> Smalltalk commandLineArguments last asFloat to<span class="hl sym">:</span> Stdout
<span class="hl sym">! !</span>
