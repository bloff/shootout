<span class="hl slc">%%% The Computer Language Shootout</span>
<span class="hl slc">%%% http://shootout.alioth.debian.org/</span>
<span class="hl slc">%%% Contributed by Isaac Gouy (Erlang novice)</span>

<span class="hl sym">-</span><span class="hl kwd">module</span><span class="hl sym">(</span>partialsums<span class="hl sym">)</span>.
<span class="hl sym">-</span><span class="hl kwd">export</span><span class="hl sym">([</span>main<span class="hl sym">/</span><span class="hl num">1</span><span class="hl sym">])</span>.
<span class="hl sym">-</span><span class="hl kwd">import</span><span class="hl sym">(</span><span class="hl kwb">math</span><span class="hl sym">,[</span><span class="hl kwb">pow</span><span class="hl sym">/</span><span class="hl num">2</span><span class="hl sym">,</span><span class="hl kwb">sin</span><span class="hl sym">/</span><span class="hl num">1</span><span class="hl sym">,</span><span class="hl kwb">cos</span><span class="hl sym">/</span><span class="hl num">1</span><span class="hl sym">])</span>.
<span class="hl sym">-</span><span class="hl kwd">import</span><span class="hl sym">(</span>lists<span class="hl sym">,[</span>foreach<span class="hl sym">/</span><span class="hl num">2</span><span class="hl sym">,</span>zipwith<span class="hl sym">/</span><span class="hl num">3</span><span class="hl sym">])</span>.

<span class="hl kwd">main</span><span class="hl sym">([</span>Arg<span class="hl sym">]) -&gt;</span>
   N <span class="hl sym">=</span> <span class="hl kwb">list_to_integer</span><span class="hl sym">(</span>Arg<span class="hl sym">),</span>
   Names <span class="hl sym">= [</span><span class="hl str">&quot;(2/3)^k&quot;</span><span class="hl sym">,</span> <span class="hl str">&quot;k^-0.5&quot;</span><span class="hl sym">,</span> <span class="hl str">&quot;1/k(k+1)&quot;</span><span class="hl sym">,</span> <span class="hl str">&quot;Flint Hills&quot;</span><span class="hl sym">,</span> <span class="hl str">&quot;Cookson Hills&quot;</span><span class="hl sym">,</span>
            <span class="hl str">&quot;Harmonic&quot;</span><span class="hl sym">,</span> <span class="hl str">&quot;Riemann Zeta&quot;</span><span class="hl sym">,</span> <span class="hl str">&quot;Alternating Harmonic&quot;</span><span class="hl sym">,</span> <span class="hl str">&quot;Gregory&quot;</span><span class="hl sym">],</span>
   Sums <span class="hl sym">=</span> <span class="hl kwd">loop</span><span class="hl sym">(</span><span class="hl num">1</span><span class="hl sym">,</span> N<span class="hl sym">,</span> <span class="hl num">1.0</span><span class="hl sym">,</span> <span class="hl num">0.0</span><span class="hl sym">,</span> <span class="hl num">0.0</span><span class="hl sym">,</span> <span class="hl num">0.0</span><span class="hl sym">,</span> <span class="hl num">0.0</span><span class="hl sym">,</span> <span class="hl num">0.0</span><span class="hl sym">,</span> <span class="hl num">0.0</span><span class="hl sym">,</span> <span class="hl num">0.0</span><span class="hl sym">,</span> <span class="hl num">0.0</span><span class="hl sym">,</span> <span class="hl num">0.0</span><span class="hl sym">),</span>
   <span class="hl kwd">foreach</span><span class="hl sym">(</span>
      <span class="hl kwa">fun</span><span class="hl sym">(</span>L<span class="hl sym">) -&gt;</span> io<span class="hl sym">:</span><span class="hl kwd">format</span><span class="hl sym">(</span><span class="hl str">&quot;~.9f</span><span class="hl esc">\t</span><span class="hl str">~s~n&quot;</span><span class="hl sym">,</span> L<span class="hl sym">)</span> <span class="hl kwa">end</span><span class="hl sym">,</span>
      <span class="hl kwd">zipwith</span><span class="hl sym">(</span><span class="hl kwa">fun</span><span class="hl sym">(</span>X<span class="hl sym">,</span> Y<span class="hl sym">) -&gt; [</span>X<span class="hl sym">,</span>Y<span class="hl sym">]</span> <span class="hl kwa">end</span><span class="hl sym">,</span> Sums<span class="hl sym">,</span> Names<span class="hl sym">) ),</span>
   erlang<span class="hl sym">:</span><span class="hl kwb">halt</span><span class="hl sym">()</span>.


<span class="hl kwd">loop</span><span class="hl sym">(</span>K<span class="hl sym">,</span>N<span class="hl sym">,</span>Alt<span class="hl sym">,</span>A1<span class="hl sym">,</span>A2<span class="hl sym">,</span>A3<span class="hl sym">,</span>A4<span class="hl sym">,</span>A5<span class="hl sym">,</span>A6<span class="hl sym">,</span>A7<span class="hl sym">,</span>A8<span class="hl sym">,</span>A9<span class="hl sym">)</span> <span class="hl kwa">when</span> K <span class="hl sym">=&lt;</span> N <span class="hl sym">-&gt;</span>
   SK <span class="hl sym">=</span> <span class="hl kwb">sin</span><span class="hl sym">(</span>K<span class="hl sym">),</span>
   CK <span class="hl sym">=</span> <span class="hl kwb">cos</span><span class="hl sym">(</span>K<span class="hl sym">),</span>
   K3 <span class="hl sym">=</span> <span class="hl kwb">pow</span><span class="hl sym">(</span>K<span class="hl sym">,</span><span class="hl num">3</span><span class="hl sym">),</span>

   <span class="hl kwd">loop</span><span class="hl sym">(</span>K<span class="hl sym">+</span><span class="hl num">1</span><span class="hl sym">,</span>N<span class="hl sym">,-</span>Alt<span class="hl sym">,</span>
      A1 <span class="hl sym">+</span> <span class="hl kwb">pow</span><span class="hl sym">(</span><span class="hl num">2.0</span><span class="hl sym">/</span><span class="hl num">3.0</span><span class="hl sym">,</span>K<span class="hl sym">-</span><span class="hl num">1</span><span class="hl sym">),</span>
      A2 <span class="hl sym">+</span> <span class="hl kwb">pow</span><span class="hl sym">(</span>K<span class="hl sym">,-</span><span class="hl num">0.5</span><span class="hl sym">),</span>
      A3 <span class="hl sym">+ (</span><span class="hl num">1.0</span><span class="hl sym">/(</span>K<span class="hl sym">*(</span>K<span class="hl sym">+</span><span class="hl num">1</span><span class="hl sym">))),</span>
      A4 <span class="hl sym">+ (</span><span class="hl num">1.0</span><span class="hl sym">/(</span>K3<span class="hl sym">*</span>SK<span class="hl sym">*</span>SK<span class="hl sym">)),</span>
      A5 <span class="hl sym">+ (</span><span class="hl num">1.0</span><span class="hl sym">/(</span>K3<span class="hl sym">*</span>CK<span class="hl sym">*</span>CK<span class="hl sym">)),</span>
      A6 <span class="hl sym">+ (</span><span class="hl num">1.0</span><span class="hl sym">/</span>K<span class="hl sym">),</span>
      A7 <span class="hl sym">+ (</span><span class="hl num">1.0</span><span class="hl sym">/</span><span class="hl kwb">pow</span><span class="hl sym">(</span>K<span class="hl sym">,</span><span class="hl num">2</span><span class="hl sym">)),</span>
      A8 <span class="hl sym">+ (</span>Alt<span class="hl sym">/</span>K<span class="hl sym">),</span>
      A9 <span class="hl sym">+ (</span>Alt<span class="hl sym">/(</span><span class="hl num">2</span><span class="hl sym">*</span>K<span class="hl sym">-</span><span class="hl num">1</span><span class="hl sym">)));</span>

<span class="hl kwd">loop</span><span class="hl sym">(</span>K<span class="hl sym">,</span>N<span class="hl sym">,</span>Alt<span class="hl sym">,</span>A1<span class="hl sym">,</span>A2<span class="hl sym">,</span>A3<span class="hl sym">,</span>A4<span class="hl sym">,</span>A5<span class="hl sym">,</span>A6<span class="hl sym">,</span>A7<span class="hl sym">,</span>A8<span class="hl sym">,</span>A9<span class="hl sym">) -&gt; [</span>A1<span class="hl sym">,</span>A2<span class="hl sym">,</span>A3<span class="hl sym">,</span>A4<span class="hl sym">,</span>A5<span class="hl sym">,</span>A6<span class="hl sym">,</span>A7<span class="hl sym">,</span>A8<span class="hl sym">,</span>A9<span class="hl sym">]</span>.

