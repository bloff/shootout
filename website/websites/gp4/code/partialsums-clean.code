<span class="sym">/*</span> The Computer Language Shootout
   http<span class="sym">://</span>shootout.alioth.debian.org<span class="sym">/</span>
   contributed by Isaac Gouy <span class="sym">(</span>Clean novice<span class="sym">) */</span>

<span class="kwa">module</span> partialsums
<span class="kwa">import</span> StdEnv<span class="sym">,</span> LanguageShootout

Start <span class="sym">=</span>
   toStringWith <span class="num">9</span> <span class="sym">(</span>twoThirds n <span class="num">0.0</span><span class="sym">) +++</span> <span class="str">&quot;\t(2/3)^k\n&quot;</span> <span class="sym">+++</span>
   toStringWith <span class="num">9</span> <span class="sym">(</span>k05 n <span class="num">0.0</span><span class="sym">) +++</span> <span class="str">&quot;\tk^-0.5\n&quot;</span> <span class="sym">+++</span>
   toStringWith <span class="num">9</span> <span class="sym">(</span>kk1 n <span class="num">0.0</span><span class="sym">) +++</span> <span class="str">&quot;\t1/k(k+1)\n&quot;</span> <span class="sym">+++</span>
   toStringWith <span class="num">9</span> <span class="sym">(</span>flintHills n <span class="num">0.0</span><span class="sym">) +++</span> <span class="str">&quot;\tFlint Hills\n&quot;</span> <span class="sym">+++</span>
   toStringWith <span class="num">9</span> <span class="sym">(</span>cooksonHills n <span class="num">0.0</span><span class="sym">) +++</span> <span class="str">&quot;\tCookson Hills\n&quot;</span> <span class="sym">+++</span>
   toStringWith <span class="num">9</span> <span class="sym">(</span>harmonic n <span class="num">0.0</span><span class="sym">) +++</span> <span class="str">&quot;\tHarmonic\n&quot;</span> <span class="sym">+++</span>
   toStringWith <span class="num">9</span> <span class="sym">(</span>riemannZeta n <span class="num">0.0</span><span class="sym">) +++</span> <span class="str">&quot;\tRiemann Zeta\n&quot;</span> <span class="sym">+++</span>
   toStringWith <span class="num">9</span> <span class="sym">(</span>altHarmonic n <span class="sym">-</span><span class="num">1.0 0.0</span><span class="sym">) +++</span> <span class="str">&quot;\tAlternating Harmonic\n&quot;</span> <span class="sym">+++</span>
   toStringWith <span class="num">9</span> <span class="sym">(</span>gregory n <span class="sym">-</span><span class="num">1.0 0.0</span><span class="sym">) +++</span> <span class="str">&quot;\tGregory\n&quot;</span>
   <span class="kwa">where</span> n <span class="sym">=</span> toReal argi

twoThirds k sum
   <span class="sym">|</span> k <span class="sym">&gt; -</span><span class="num">1.0</span>  <span class="sym">=</span> twoThirds<span class="sym">(</span>k<span class="sym">-</span><span class="num">1.0</span><span class="sym">)(</span>sum <span class="sym">+ ((</span><span class="num">2.0</span><span class="sym">/</span><span class="num">3.0</span><span class="sym">)</span>^k<span class="sym">))</span>
   <span class="sym">|</span> otherwise <span class="sym">=</span> sum

k05 k sum
   <span class="sym">|</span> k <span class="sym">&gt;</span> <span class="num">0.0</span>  <span class="sym">=</span> k05<span class="sym">(</span>k<span class="sym">-</span><span class="num">1.0</span><span class="sym">)(</span>sum <span class="sym">+ (</span>k^ ~<span class="num">0.5</span><span class="sym">))</span>
   <span class="sym">|</span> otherwise <span class="sym">=</span> sum

kk1 k sum
   <span class="sym">|</span> k <span class="sym">&gt;</span> <span class="num">0.0</span>  <span class="sym">=</span> kk1<span class="sym">(</span>k<span class="sym">-</span><span class="num">1.0</span><span class="sym">)(</span>sum <span class="sym">+</span> <span class="num">1.0</span><span class="sym">/(</span>k<span class="sym">*(</span>k<span class="sym">+</span><span class="num">1.0</span><span class="sym">)))</span>
   <span class="sym">|</span> otherwise <span class="sym">=</span> sum

flintHills k sum
   <span class="sym">|</span> k <span class="sym">&gt;</span> <span class="num">0.0</span>   <span class="sym">=</span> flintHills<span class="sym">(</span>k<span class="sym">-</span><span class="num">1.0</span><span class="sym">)(</span>sum <span class="sym">+</span> <span class="num">1.0</span><span class="sym">/((</span>k^<span class="num">3.0</span><span class="sym">)*((</span>sin k<span class="sym">)</span>^<span class="num">2.0</span><span class="sym">)))</span>
   <span class="sym">|</span> otherwise <span class="sym">=</span> sum

cooksonHills k sum
   <span class="sym">|</span> k <span class="sym">&gt;</span> <span class="num">0.0</span>   <span class="sym">=</span> cooksonHills<span class="sym">(</span>k<span class="sym">-</span><span class="num">1.0</span><span class="sym">)(</span>sum <span class="sym">+</span> <span class="num">1.0</span><span class="sym">/((</span>k^<span class="num">3.0</span><span class="sym">)*((</span>cos k<span class="sym">)</span>^<span class="num">2.0</span><span class="sym">)))</span>
   <span class="sym">|</span> otherwise <span class="sym">=</span> sum

harmonic k sum
   <span class="sym">|</span> k <span class="sym">&gt;</span> <span class="num">0.0</span>   <span class="sym">=</span> harmonic<span class="sym">(</span>k<span class="sym">-</span><span class="num">1.0</span><span class="sym">)(</span>sum <span class="sym">+</span> <span class="num">1.0</span><span class="sym">/</span>k<span class="sym">)</span>
   <span class="sym">|</span> otherwise <span class="sym">=</span> sum

riemannZeta k sum
   <span class="sym">|</span> k <span class="sym">&gt;</span> <span class="num">0.0</span>   <span class="sym">=</span> riemannZeta<span class="sym">(</span>k<span class="sym">-</span><span class="num">1.0</span><span class="sym">)(</span>sum <span class="sym">+</span> <span class="num">1.0</span><span class="sym">/(</span>k^<span class="num">2.0</span><span class="sym">))</span>
   <span class="sym">|</span> otherwise <span class="sym">=</span> sum

altHarmonic <span class="sym">:: !</span>Real <span class="sym">!</span>Real <span class="sym">!</span>Real <span class="sym">-&gt;</span> Real
altHarmonic k a sum
   <span class="sym">|</span> k <span class="sym">&gt;</span> <span class="num">0.0</span>   <span class="sym">=</span> altHarmonic<span class="sym">(</span>k<span class="sym">-</span><span class="num">1.0</span><span class="sym">)(</span>~a<span class="sym">)(</span>sum <span class="sym">+</span> a<span class="sym">/</span>k<span class="sym">)</span>
   <span class="sym">|</span> otherwise <span class="sym">=</span> sum

gregory <span class="sym">:: !</span>Real <span class="sym">!</span>Real <span class="sym">!</span>Real <span class="sym">-&gt;</span> Real
gregory k a sum
   <span class="sym">|</span> k <span class="sym">&gt;</span> <span class="num">0.0</span>   <span class="sym">=</span> gregory<span class="sym">(</span>k<span class="sym">-</span><span class="num">1.0</span><span class="sym">)(</span>~a<span class="sym">)(</span>sum <span class="sym">+</span> a<span class="sym">/(</span><span class="num">2.0</span><span class="sym">*</span>k <span class="sym">-</span> <span class="num">1.0</span><span class="sym">))</span>
   <span class="sym">|</span> otherwise <span class="sym">=</span> sum
