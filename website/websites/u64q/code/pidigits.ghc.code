<source>
<def></def><com>{-# OPTIONS -O2 -optc-O3 #-}</com><def></def><br />
<slc>--</slc><br />
<def></def><slc>-- The Great Computer Language Shootout</slc><br />
<def></def><slc>-- http://shootout.alioth.debian.org/</slc><br />
<def></def><slc>-- by Don Stewart, Einar Karttunen, Branimir Maksimovic and Bertram Felgenhauer</slc><br />
<def></def><slc>--</slc><br />
<def></def><br />
<kwa>import</kwa> <def>System</def><br />
<br />
<kwa>data</kwa> <def>F</def> <sym>=</sym> <def>F</def> <sym>!</sym><def>Integer</def> <sym>!</sym><def>Integer</def> <sym>!</sym><def>Integer</def> <sym>!</sym><def>Integer<br />
<br />
main</def> <sym>=</sym> <def>loop</def> <num>10 0</num> <def>. flip take</def> <sym>(</sym><def>str</def> <sym>(</sym><def>F</def> <num>1 0 0 1</num><def></def><sym>)</sym> <def>ns</def><sym>)</sym> <def>. read . head</def> <sym>=&lt;&lt;</sym> <def>getArgs<br />
<br />
ns</def> <sym>= [</sym> <def>F k</def> <sym>(</sym><def></def><num>4</num><def></def><sym>*</sym><def>k</def><sym>+</sym><def></def><num>2</num><def></def><sym>)</sym> <def></def><num>0</num> <def></def><sym>(</sym><def></def><num>2</num><def></def><sym>*</sym><def>k</def><sym>+</sym><def></def><num>1</num><def></def><sym>) |</sym> <def>k</def> <sym>&lt;- [</sym><def></def><num>1</num><def>..</def><sym>] ]</sym><br />
<def><br />
loop n s</def> <sym>[]     =</sym> <def>putStrLn $ replicate n ' '</def> <sym>++</sym> <def></def><str>&quot;\t:&quot;</str><def></def> <sym>++</sym> <def>show s<br />
loop</def> <num>0</num> <def>s xs</def>     <sym>=</sym> <def>putStrLn</def> <sym>(</sym><def></def><str>&quot;\t:&quot;</str><def></def><sym>++</sym><def>show s</def><sym>) &gt;&gt;</sym> <def>loop</def> <num>10</num> <def>s xs<br />
loop n s</def> <sym>(</sym><def>x</def><sym>:</sym><def>xs</def><sym>) =</sym> <def>putStr</def> <sym>(</sym><def>show x</def><sym>)          &gt;&gt;</sym> <def>loop</def> <sym>(</sym><def>n</def><sym>-</sym><def></def><num>1</num><def></def><sym>) (</sym><def>s</def><sym>+</sym><def></def><num>1</num><def></def><sym>)</sym> <def>xs<br />
<br />
flr  x</def>           <sym>(</sym><def>F q r s t</def><sym>) = (</sym><def>q</def><sym>*</sym><def>x</def> <sym>+</sym> <def>r</def><sym>)</sym> <def>`div`</def> <sym>(</sym><def>s</def><sym>*</sym><def>x</def> <sym>+</sym> <def>t</def><sym>)</sym><br />
<def>comp1</def> <sym>(</sym><def>F q r s t</def><sym>) (</sym><def>F u v w x</def><sym>) =</sym> <def>F</def> <sym>(</sym><def>q</def><sym>*</sym><def>u</def><sym>+</sym><def>r</def><sym>*</sym><def>w</def><sym>) (</sym><def>q</def><sym>*</sym><def>v</def><sym>+</sym><def>r</def><sym>*</sym><def>x</def><sym>) (</sym><def>t</def><sym>*</sym><def>w</def><sym>) (</sym><def>t</def><sym>*</sym><def>x</def><sym>)</sym><br />
<def>comp2</def> <sym>(</sym><def>F q r s t</def><sym>) (</sym><def>F u v w x</def><sym>) =</sym> <def>F</def> <sym>(</sym><def>q</def><sym>*</sym><def>u</def><sym>) (</sym><def>q</def><sym>*</sym><def>v</def><sym>+</sym><def>r</def><sym>*</sym><def>x</def><sym>) (</sym><def>s</def><sym>*</sym><def>u</def><sym>) (</sym><def>s</def><sym>*</sym><def>v</def><sym>+</sym><def>t</def><sym>*</sym><def>x</def><sym>)</sym><br />
<def><br />
str z</def> <sym>(</sym><def>x</def><sym>:</sym><def>xs</def><sym>) |</sym> <def>y</def> <sym>==</sym> <def>flr</def> <num>4</num> <def>z</def> <sym>=</sym> <def>y</def> <sym>:</sym> <def>str</def> <sym>(</sym><def>comp1</def> <sym>(</sym><def>F</def> <num>10</num> <def></def><sym>(-</sym><def></def><num>10</num><def></def><sym>*</sym><def>y</def><sym>)</sym> <def></def><num>0 1</num><def></def><sym>)</sym> <def>z</def><sym>) (</sym><def>x</def><sym>:</sym><def>xs</def><sym>)</sym><br />
<def></def>             <sym>|</sym> <def>otherwise</def>    <sym>=</sym>     <def>str</def> <sym>(</sym><def>comp2 z x</def><sym>)</sym> <def>xs</def>     <kwa>where</kwa> <def>y</def> <sym>=</sym> <def>flr</def> <num>3</num> <def>z</def><br />
</source>
