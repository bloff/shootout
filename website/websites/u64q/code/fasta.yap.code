<source>
<def></def><slc>% ----------------------------------------------------------------------</slc><br />
<def></def><slc>% The Computer Language Benchmarks Game</slc><br />
<def></def><slc>% http://shootout.alioth.debian.org/</slc><br />
<def></def><slc>% Contributed by Anthony Borla</slc><br />
<def></def><slc>% Modified to run with YAP by Glendon Holst</slc><br />
<def></def><slc>% ----------------------------------------------------------------------</slc><br />
<def></def><br />
<sym>:-</sym> <def>yap_flag</def><sym>(</sym><def>unknown</def><sym>,</sym><def>error</def><sym>).</sym><br />
<def></def><br />
<sym>:-</sym> <def>initialization</def><sym>(</sym><def>main</def><sym>).</sym><br />
<def><br />
main</def> <sym>:-</sym><br />
<def>  unix</def><sym>(</sym> <def>argv</def><sym>([</sym><def>H</def><sym>|</sym><def>_</def><sym>]) ),</sym> <def>number_atom</def><sym>(</sym><def>N</def><sym>,</sym><def>H</def><sym>),</sym><br />
<def><br />
  init_fasta</def><sym>(</sym><def>ALU</def><sym>,</sym> <def>IUB</def><sym>,</sym> <def>HOMOSAPIENS</def><sym>,</sym> <def>RAND0</def><sym>),</sym><br />
<def><br />
  N1</def> <kwa>is</kwa> <def>N</def> <sym>*</sym> <def></def><num>2</num><def></def><sym>,</sym><br />
<def>  N2</def> <kwa>is</kwa> <def>N</def> <sym>*</sym> <def></def><num>3</num><def></def><sym>,</sym><br />
<def>  N3</def> <kwa>is</kwa> <def>N</def> <sym>*</sym> <def></def><num>5</num><def></def><sym>,</sym><br />
<def><br />
  repeat_fasta</def><sym>(</sym><def></def><str>'ONE'</str><def></def><sym>,</sym> <def></def><str>'Homo sapiens alu'</str><def></def><sym>,</sym> <def>N1</def><sym>,</sym> <def>ALU</def><sym>),</sym><br />
<def><br />
  make_cumulative</def><sym>(</sym><def>IUB</def><sym>,</sym> <def>CVIUB</def><sym>),</sym><br />
<def><br />
  random_fasta</def><sym>(</sym><def></def><str>'TWO'</str><def></def><sym>,</sym> <def></def><str>'IUB ambiguity codes'</str><def></def><sym>,</sym> <def>N2</def><sym>,</sym> <def>CVIUB</def><sym>,</sym> <def>RAND0</def><sym>,</sym> <def>RAND1</def><sym>),</sym><br />
<def><br />
  make_cumulative</def><sym>(</sym><def>HOMOSAPIENS</def><sym>,</sym> <def>CVHOMOSAPIENS</def><sym>),</sym><br />
<def><br />
  random_fasta</def><sym>(</sym><def></def><str>'THREE'</str><def></def><sym>,</sym> <def></def><str>'Homo sapiens frequency'</str><def></def><sym>,</sym> <def>N3</def><sym>,</sym> <def>CVHOMOSAPIENS</def><sym>,</sym> <def>RAND1</def><sym>,</sym> <def>RAND</def><sym>).</sym><br />
<def></def><br />
<slc>% ------------------------------- %</slc><br />
<def><br />
init_fasta</def><sym>(</sym><def>ALU</def><sym>,</sym> <def>IUB</def><sym>,</sym> <def>HOMOSAP</def><sym>,</sym> <def>RAND</def><sym>) :-</sym><br />
<def>  ALU</def> <sym>=</sym> <def></def><str>'GGCCGGGCGCGGTGGCTCACGCCTGTAATCCCAGCACTTTGGGAGGCCGAGGCGGGCGGATCACCTGAGGTCAGGAGTTCGAGACCAGCCTGGCCAACATGGTGAAACCCCGTCTCTACTAAAAATACAAAAATTAGCCGGGCGTGGTGGCGCGCGCCTGTAATCCCAGCTACTCGGGAGGCTGAGGCAGGAGAATCGCTTGAACCCGGGAGGCGGAGGTTGCAGTGAGCCGAGATCGCGCCACTGCACTCCAGCCTGGGCGACAGAGCGAGACTCCGTCTCAAAAA'</str><def></def><sym>,</sym><br />
<def>  IUB</def> <sym>= [</sym><def>a</def><sym>:</sym><def></def><num>0.27</num><def></def><sym>,</sym> <def>c</def><sym>:</sym><def></def><num>0.12</num><def></def><sym>,</sym> <def>g</def><sym>:</sym><def></def><num>0.12</num><def></def><sym>,</sym> <def>t</def><sym>:</sym><def></def><num>0.27</num><def></def><sym>,</sym><br />
<def></def>		<str>'B'</str><def></def><sym>:</sym><def></def><num>0.02</num><def></def><sym>,</sym> <def></def><str>'D'</str><def></def><sym>:</sym><def></def><num>0.02</num><def></def><sym>,</sym> <def></def><str>'H'</str><def></def><sym>:</sym><def></def><num>0.02</num><def></def><sym>,</sym> <def></def><str>'K'</str><def></def><sym>:</sym><def></def><num>0.02</num><def></def><sym>,</sym> <def></def><str>'M'</str><def></def><sym>:</sym><def></def><num>0.02</num><def></def><sym>,</sym><br />
<def></def>		<str>'N'</str><def></def><sym>:</sym><def></def><num>0.02</num><def></def><sym>,</sym> <def></def><str>'R'</str><def></def><sym>:</sym><def></def><num>0.02</num><def></def><sym>,</sym> <def></def><str>'S'</str><def></def><sym>:</sym><def></def><num>0.02</num><def></def><sym>,</sym> <def></def><str>'V'</str><def></def><sym>:</sym><def></def><num>0.02</num><def></def><sym>,</sym> <def></def><str>'W'</str><def></def><sym>:</sym><def></def><num>0.02</num><def></def><sym>,</sym> <def></def><str>'Y'</str><def></def><sym>:</sym><def></def><num>0.02</num><def></def><sym>],</sym><br />
<def>  HOMOSAP</def> <sym>= [</sym><def>a</def><sym>:</sym><def></def><num>0.3029549426680</num><def></def><sym>,</sym> <def>c</def><sym>:</sym><def></def><num>0.1979883004921</num><def></def><sym>,</sym><br />
<def>			g</def><sym>:</sym><def></def><num>0.1975473066391</num><def></def><sym>,</sym> <def>t</def><sym>:</sym><def></def><num>0.3015094502008</num><def></def><sym>],</sym><br />
<def>  init_gen_random</def><sym>(</sym><def></def><num>42</num><def></def><sym>,</sym> <def>RAND</def><sym>).</sym><br />
<def></def><br />
<slc>% ------------------------------- %</slc><br />
<def><br />
repeat_fasta</def><sym>(</sym><def>Id</def><sym>,</sym> <def>Desc</def><sym>,</sym> <def>N</def><sym>,</sym> <def>ALU</def><sym>) :-</sym><br />
<def>  LineLength</def> <sym>=</sym> <def></def><num>60</num><def></def><sym>,</sym><br />
<def></def>  <kwb>atom_length</kwb><def></def><sym>(</sym><def>ALU</def><sym>,</sym> <def>ALULength</def><sym>),</sym><br />
<def></def>  <kwb>write</kwb><def></def><sym>(</sym><def></def><str>'&gt;'</str><def></def><sym>),</sym> <def></def><kwb>write</kwb><def></def><sym>(</sym><def>Id</def><sym>),</sym> <def>tab</def><sym>(</sym><def></def><num>1</num><def></def><sym>),</sym> <def></def><kwb>write</kwb><def></def><sym>(</sym><def>Desc</def><sym>),</sym> <def></def><kwa>nl</kwa><def></def><sym>,</sym><br />
<def>  repeat_fasta_</def><sym>(</sym><def>N</def><sym>,</sym> <def></def><num>0</num><def></def><sym>,</sym> <def>LineLength</def><sym>,</sym> <def>ALU</def><sym>,</sym> <def>ALULength</def><sym>).</sym><br />
<def></def><br />
<slc>% ------------- %</slc><br />
<def><br />
repeat_fasta_</def><sym>(</sym><def>N</def><sym>,</sym> <def>_</def><sym>,</sym> <def>_</def><sym>,</sym> <def>_</def><sym>,</sym> <def>_</def><sym>) :-</sym> <def>N</def> <sym>=&lt;</sym> <def></def><num>0</num><def></def><sym>, !.</sym><br />
<def><br />
repeat_fasta_</def><sym>(</sym><def>N</def><sym>,</sym> <def>Q</def><sym>,</sym> <def>L</def><sym>,</sym> <def>ALU</def><sym>,</sym> <def>ALULength</def><sym>) :-</sym><br />
<def></def>  <sym>(</sym><def>N</def> <sym>&lt;</sym> <def>L</def> <sym>-&gt;</sym> <def>L1</def> <sym>=</sym> <def>N</def> <sym>;</sym> <def>L1</def> <sym>=</sym> <def>L</def><sym>),</sym><br />
<def></def>  <sym>(</sym><def>L1</def> <sym>+</sym> <def>Q</def> <sym>&lt;</sym> <def>ALULength</def> <sym>-&gt;</sym><br />
<def></def>    <kwb>sub_atom</kwb><def></def><sym>(</sym><def>ALU</def><sym>,</sym> <def>Q</def><sym>,</sym> <def>L1</def><sym>,</sym> <def>Lineout</def><sym>),</sym> <def>Q1</def> <kwa>is</kwa> <def>L1</def> <sym>+</sym> <def>Q</def><sym>,</sym><br />
<def></def>    <kwb>write</kwb><def></def><sym>(</sym><def>Lineout</def><sym>),</sym> <def></def><kwa>nl</kwa><br />
<def></def>  <sym>;</sym><br />
<def>    Rest</def> <kwa>is</kwa> <def>ALULength</def> <sym>-</sym> <def>Q</def><sym>,</sym> <def></def><kwb>sub_atom</kwb><def></def><sym>(</sym><def>ALU</def><sym>,</sym> <def>Q</def><sym>,</sym> <def>Rest</def><sym>,</sym> <def>Prefix</def><sym>),</sym><br />
<def></def>    <kwb>atom_length</kwb><def></def><sym>(</sym><def>Prefix</def><sym>,</sym> <def>PrefixLength</def><sym>),</sym> <def>Q1</def> <kwa>is</kwa> <def>L1</def> <sym>-</sym> <def>PrefixLength</def><sym>,</sym><br />
<def></def>    <kwb>sub_atom</kwb><def></def><sym>(</sym><def>ALU</def><sym>,</sym> <def></def><num>0</num><def></def><sym>,</sym> <def>Q1</def><sym>,</sym> <def>Segment</def><sym>),</sym><br />
<def></def>	<kwb>write</kwb><def></def><sym>(</sym><def>Prefix</def><sym>),</sym> <def></def><kwb>write</kwb><def></def><sym>(</sym><def>Segment</def><sym>),</sym> <def></def><kwa>nl</kwa><def></def><sym>),</sym><br />
<def><br />
  N1</def> <kwa>is</kwa> <def>N</def> <sym>-</sym> <def>L1</def><sym>, !,</sym> <def>repeat_fasta_</def><sym>(</sym><def>N1</def><sym>,</sym> <def>Q1</def><sym>,</sym> <def>L1</def><sym>,</sym> <def>ALU</def><sym>,</sym> <def>ALULength</def><sym>).</sym><br />
<def></def><br />
<slc>% ------------------------------- %</slc><br />
<def><br />
random_fasta</def><sym>(</sym><def>Id</def><sym>,</sym> <def>Desc</def><sym>,</sym> <def>N</def><sym>,</sym> <def>CumTbl</def><sym>,</sym> <def>RAND0</def><sym>,</sym> <def>RAND</def><sym>) :-</sym><br />
<def>  LineLength</def> <sym>=</sym> <def></def><num>60</num><def></def><sym>,</sym><br />
<def></def>  <kwb>write</kwb><def></def><sym>(</sym><def></def><str>'&gt;'</str><def></def><sym>),</sym> <def></def><kwb>write</kwb><def></def><sym>(</sym><def>Id</def><sym>),</sym> <def>tab</def><sym>(</sym><def></def><num>1</num><def></def><sym>),</sym> <def></def><kwb>write</kwb><def></def><sym>(</sym><def>Desc</def><sym>),</sym> <def></def><kwa>nl</kwa><def></def><sym>,</sym><br />
<def>  random_fasta_</def><sym>(</sym><def>N</def><sym>,</sym> <def>LineLength</def><sym>,</sym> <def>CumTbl</def><sym>,</sym> <def>RAND0</def><sym>,</sym> <def>RAND</def><sym>).</sym><br />
<def></def><br />
<slc>% ------------- %</slc><br />
<def><br />
random_fasta_</def><sym>(</sym><def>N</def><sym>,</sym> <def>_</def><sym>,</sym> <def>_</def><sym>,</sym> <def>RAND</def><sym>,</sym> <def>RAND</def><sym>) :-</sym> <def>N</def> <sym>=&lt;</sym> <def></def><num>0</num><def></def><sym>, !.</sym><br />
<def><br />
random_fasta_</def><sym>(</sym><def>N</def><sym>,</sym> <def>L</def><sym>,</sym> <def>CumTbl</def><sym>,</sym> <def>RAND0</def><sym>,</sym> <def>RAND</def><sym>) :-</sym><br />
<def></def>  <sym>(</sym><def>N</def> <sym>&lt;</sym> <def>L</def> <sym>-&gt;</sym> <def>L1</def> <sym>=</sym> <def>N</def> <sym>;</sym> <def>L1</def> <sym>=</sym> <def>L</def><sym>),</sym><br />
<def>  gen_line</def><sym>(</sym><def>L1</def><sym>,</sym> <def>CumTbl</def><sym>,</sym> <def>Codesout</def><sym>,</sym> <def>RAND0</def><sym>,</sym> <def>RAND1</def><sym>),</sym><br />
<def></def>  <kwb>atom_chars</kwb><def></def><sym>(</sym><def>Lineout</def><sym>,</sym> <def>Codesout</def><sym>),</sym> <def></def><kwb>write</kwb><def></def><sym>(</sym><def>Lineout</def><sym>),</sym> <def></def><kwa>nl</kwa><def></def><sym>,</sym><br />
<def>  N1</def> <kwa>is</kwa> <def>N</def> <sym>-</sym> <def>L1</def><sym>, !,</sym> <def>random_fasta_</def><sym>(</sym><def>N1</def><sym>,</sym> <def>L1</def><sym>,</sym> <def>CumTbl</def><sym>,</sym> <def>RAND1</def><sym>,</sym> <def>RAND</def><sym>).</sym><br />
<def></def><br />
<slc>% ------------- %</slc><br />
<def><br />
gen_line</def><sym>(</sym><def></def><num>0</num><def></def><sym>,</sym> <def>_</def><sym>, [],</sym> <def>RAND</def><sym>,</sym> <def>RAND</def><sym>).</sym><br />
<def>gen_line</def><sym>(</sym><def>N</def><sym>,</sym> <def>CumTbl</def><sym>,</sym> <def>K</def><sym>,</sym> <def>RAND0</def><sym>,</sym> <def>RAND</def><sym>) :-</sym><br />
<def>  select_random</def><sym>(</sym><def>CumTbl</def><sym>,</sym> <def>C</def><sym>,</sym> <def>RAND0</def><sym>,</sym> <def>RAND1</def><sym>),</sym><br />
<def></def>  <kwb>char_code</kwb><def></def><sym>(</sym><def>C</def><sym>,</sym> <def>C1</def><sym>),</sym> <def>K</def> <sym>= [</sym><def>C1</def><sym>|</sym><def>T1</def><sym>],</sym> <def>N1</def> <kwa>is</kwa> <def>N</def> <sym>-</sym> <def></def><num>1</num><def></def><sym>, !,</sym><br />
<def>  gen_line</def><sym>(</sym><def>N1</def><sym>,</sym> <def>CumTbl</def><sym>,</sym> <def>T1</def><sym>,</sym> <def>RAND1</def><sym>,</sym> <def>RAND</def><sym>).</sym><br />
<def></def><br />
<slc>% ------------------------------- %</slc><br />
<def><br />
make_cumulative</def><sym>(</sym><def>L</def><sym>,</sym> <def>RL</def><sym>) :-</sym> <def>make_cumulative_</def><sym>(</sym><def>L</def><sym>,</sym> <def>RL</def><sym>,</sym> <def></def><num>0</num><def></def><sym>).</sym><br />
<def><br />
make_cumulative_</def><sym>([], [],</sym> <def>_</def><sym>) :- !.</sym><br />
<def>make_cumulative_</def><sym>([</sym><def>K</def><sym>:</sym><def>V</def><sym>|</sym><def>T</def><sym>],</sym> <def>L</def><sym>,</sym> <def>CV</def><sym>) :-</sym><br />
<def>	CV1</def> <kwa>is</kwa> <def>CV</def> <sym>+</sym> <def>V</def><sym>,</sym> <def>L</def> <sym>= [</sym><def>K</def><sym>:</sym><def>CV1</def><sym>|</sym><def>T1</def><sym>], !,</sym> <def>make_cumulative_</def><sym>(</sym><def>T</def><sym>,</sym> <def>T1</def><sym>,</sym> <def>CV1</def><sym>).</sym><br />
<def></def><br />
<slc>% ------------- %</slc><br />
<def><br />
select_random</def><sym>(</sym><def>L</def><sym>,</sym> <def>RK</def><sym>,</sym> <def>RAND0</def><sym>,</sym> <def>RAND</def><sym>) :-</sym><br />
<def>	gen_random</def><sym>(</sym><def></def><num>1.0</num><def></def><sym>,</sym> <def>R</def><sym>,</sym> <def>RAND0</def><sym>,</sym> <def>RAND</def><sym>),</sym><br />
<def>	select_random_</def><sym>(</sym><def>L</def><sym>,</sym> <def>R</def><sym>,</sym> <def>RK</def><sym>).</sym><br />
<def><br />
select_random_</def><sym>([],</sym> <def>_</def><sym>,</sym> <def>_</def><sym>) :- !.</sym><br />
<def>select_random_</def><sym>([</sym><def>K</def><sym>:</sym><def>V</def><sym>|</sym><def>T</def><sym>],</sym> <def>R</def><sym>,</sym> <def>RK</def><sym>) :-</sym><br />
<def></def>	<sym>(</sym><def>R</def> <sym>&lt;</sym> <def>V</def> <sym>-&gt;</sym> <def>RK</def> <sym>=</sym> <def>K</def> <sym>; !,</sym> <def>select_random_</def><sym>(</sym><def>T</def><sym>,</sym> <def>R</def><sym>,</sym> <def>RK</def><sym>)).</sym><br />
<def></def><br />
<slc>% ------------------------------- %</slc><br />
<def><br />
init_gen_random</def><sym>(</sym><def>Seed</def><sym>, [</sym><def></def><num>3877</num><def></def><sym>,</sym> <def></def><num>29573</num><def></def><sym>,</sym> <def></def><num>139968</num><def></def><sym>,</sym> <def>Seed</def><sym>]).</sym><br />
<def></def><br />
<slc>% ------------- %</slc><br />
<def><br />
gen_random</def><sym>(</sym><def>UB</def><sym>,</sym> <def>R</def><sym>,</sym> <def>RAND0</def><sym>,</sym> <def>RAND</def><sym>) :-</sym><br />
<def>  RAND0</def> <sym>= [</sym><def>IA</def><sym>,</sym> <def>IC</def><sym>,</sym> <def>IM</def><sym>,</sym> <def>LAST</def><sym>],</sym><br />
<def>  LAST1</def> <kwa>is</kwa> <def></def><sym>(</sym><def>LAST</def> <sym>*</sym> <def>IA</def> <sym>+</sym> <def>IC</def><sym>)</sym> <def></def><kwa>mod</kwa> <def>IM</def><sym>,</sym><br />
<def>  RAND</def> <sym>= [</sym><def>IA</def><sym>,</sym> <def>IC</def><sym>,</sym> <def>IM</def><sym>,</sym> <def>LAST1</def><sym>],</sym><br />
<def>  R</def> <kwa>is</kwa> <def>UB</def> <sym>*</sym> <def>LAST1</def> <sym>/</sym> <def>IM</def><sym>.</sym><br />
<def></def><br />
<slc>% ------------------------------- %</slc><br />
<def></def><slc>% BUG FIX - sub_atom/5 errors out if Size = 0.</slc><br />
<def></def><br />
<kwb>sub_atom</kwb><def></def><sym>(</sym><def>_</def><sym>,</sym><def>_</def><sym>,</sym><def></def><num>0</num><def></def><sym>,</sym><def></def><str>''</str><def></def><sym>) :- !.</sym><br />
<def></def><kwb>sub_atom</kwb><def></def><sym>(</sym><def>A</def><sym>,</sym><def>Bef</def><sym>,</sym><def>Size</def><sym>,</sym><def>Aout</def><sym>) :-</sym> <def></def><kwb>sub_atom</kwb><def></def><sym>(</sym><def>A</def><sym>,</sym><def>Bef</def><sym>,</sym><def>Size</def><sym>,</sym><def>_</def><sym>,</sym><def>Aout</def><sym>).</sym><br />
<def></def><br />
</source>
