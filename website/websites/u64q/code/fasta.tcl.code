<source>
<def></def><slc>#!/usr/bin/tclsh</slc><br />
<def></def><br />
<slc># Fasta benchmark</slc><br />
<def></def><slc>#</slc><br />
<def></def><slc># Contributed by Michael Schlenker</slc><br />
<def></def><br />
<kwa>foreach</kwa> <def></def><sym>{</sym><def>IM IA IC last</def><sym>} {</sym><def></def><num>139968 3877 29573 42</num><def></def><sym>}</sym> <def></def><kwa>break</kwa><br />
<def></def><br />
<kwa>set</kwa> <def>alu GGCCGGGCGCGGTGGCTCACGCCTGTAATCCCAGCACTTTGGGAGGCCGAGGCGGGCGGATCACCTGAGGT</def><br />
<kwa>append</kwa> <def>alu CAGGAGTTCGAGACCAGCCTGGCCAACATGGTGAAACCCCGTCTCTACTAAAAATACAAAAATTAGCC</def><br />
<kwa>append</kwa> <def>alu GGGCGTGGTGGCGCGCGCCTGTAATCCCAGCTACTCGGGAGGCTGAGGCAGGAGAATCGCTTGAACCC</def><br />
<kwa>append</kwa> <def>alu GGGAGGCGGAGGTTGCAGTGAGCCGAGATCGCGCCACTGCACTCCAGCCTGGGCGACAGAGCGAGACT</def><br />
<kwa>append</kwa> <def>alu CCGTCTCAAAAA</def><br />
<br />
<kwa>set</kwa> <def>iub</def> <sym>{</sym><def>a</def> <num>0.27</num> <def>c</def> <num>0.12</num> <def>g</def> <num>0.12</num> <def>t</def> <num>0.27</num> <def>B</def> <num>0.02</num> <def>D</def> <num>0.02</num> <def>H</def> <num>0.02</num> <def>K</def> <num>0.02</num> <def>M</def> <num>0.02</num> <def>N</def> <num>0.02</num><br />
<def>	 R</def> <num>0.02</num> <def>S</def> <num>0.02</num> <def>V</def> <num>0.02</num> <def>W</def> <num>0.02</num> <def>Y</def> <num>0.02</num><def></def><sym>}</sym><br />
<def></def><br />
<kwa>set</kwa> <def>hsapiens</def> <sym>{</sym><def>a</def> <num>0.3029549426680</num> <def>c</def> <num>0.1979883004921</num> <def>g</def> <num>0.1975473066391</num><br />
<def>		 t</def> <num>0.3015094502008</num><def></def><sym>}</sym><br />
<def></def><br />
<kwa>proc</kwa> <def>make_gen_random</def> <sym>{} {</sym><br />
<def></def>    <kwa>set</kwa> <def>params</def> <sym>[</sym><def></def><kwa>list</kwa> <def>IM $</def><sym>::</sym><def></def><kwd>IM</kwd> <def>IA $</def><sym>::</sym><def></def><kwd>IA</kwd> <def>IC $</def><sym>::</sym><def></def><kwd>IC</kwd><def></def><sym>]</sym><br />
<def></def>    <kwa>set</kwa> <def>body</def> <sym>[</sym><def></def><kwa>string</kwa> <def>map</def> <kwb>$params</kwb> <def></def><sym>{</sym><br />
<def></def>	<kwa>expr</kwa> <def></def><sym>{(</sym><def></def><kwb>$max</kwb> <def></def><sym>* [</sym><def></def><kwa>set</kwa> <def></def><sym>::</sym><def></def><kwd>last</kwd> <def></def><sym>[</sym><def></def><kwa>expr</kwa> <def></def><sym>{(</sym><def>$</def><sym>::</sym><def></def><kwd>last</kwd> <def></def><sym>*</sym> <def>IA</def> <sym>+</sym> <def>IC</def><sym>) %</sym> <def>IM</def><sym>}]]) /</sym> <def>IM</def><sym>}}]</sym><br />
<def></def>    <kwa>proc</kwa> <def>gen_random</def> <sym>{</sym><def>max</def><sym>}</sym> <def></def><kwb>$body</kwb><br />
<def></def><sym>}</sym><br />
<def></def><br />
<kwa>proc</kwa> <def>make_cumulative</def> <sym>{</sym><def>table</def><sym>} {</sym><br />
<def></def>    <kwa>set</kwa> <def>prob</def> <num>0.0</num><br />
<def></def>    <kwa>set</kwa> <def>pl</def> <sym>[</sym><def></def><kwa>list</kwa><def></def><sym>]</sym><br />
<def></def><br />
    <kwa>foreach</kwa> <def></def><sym>{</sym><def>char p</def><sym>}</sym> <def></def><kwb>$table</kwb> <def></def><sym>{</sym><def></def><kwa>lappend</kwa> <def>pl</def> <sym>[</sym><def></def><kwa>set</kwa> <def>prob</def> <sym>[</sym><def></def><kwa>expr</kwa> <def></def><sym>{</sym><def></def><kwb>$prob</kwb> <def></def><sym>+</sym> <def></def><kwb>$p</kwb><def></def><sym>}]]</sym> <def></def><kwb>$char</kwb><def></def><sym>}</sym><br />
<def></def>    <kwa>return</kwa> <def></def><kwb>$pl</kwb><br />
<def></def><sym>}</sym><br />
<def></def><br />
<kwa>proc</kwa> <def>make_repeat_fasta</def> <sym>{</sym><def>id desc src n</def><sym>} {</sym><br />
<def></def>    <kwa>foreach</kwa> <def></def><sym>{</sym><def>width s e</def><sym>} {</sym><def></def><num>59 0 59</num><def></def><sym>}</sym> <def></def><kwa>break</kwa><br />
<def></def><br />
    <kwa>puts</kwa> <def></def><str>&quot;&gt;$id $desc&quot;</str><def></def><br />
    <kwa>set</kwa> <def>l</def> <sym>[</sym><def></def><kwa>string</kwa> <def>length</def> <kwb>$src</kwb><def></def><sym>]</sym><br />
<def></def>    <kwa>set</kwa> <def>ls</def> <sym>[</sym><def></def><kwa>string</kwa> <def>repeat</def> <kwb>$src</kwb> <def></def><sym>[</sym><def></def><kwa>expr</kwa> <def></def><sym>{([</sym><def></def><kwa>incr</kwa> <def>n</def> <kwc>-1</kwc><def></def><sym>] /</sym> <def></def><kwb>$l</kwb><def></def><sym>)+</sym><def></def><num>1</num> <def></def><sym>}]]</sym><br />
<def></def>    <kwa>while</kwa> <def></def><sym>{</sym><def></def><kwb>$e</kwb> <def></def><sym>&lt;</sym> <def></def><kwb>$n</kwb><def></def><sym>} {</sym><br />
<def></def>	<kwa>puts</kwa> <def></def><sym>[</sym><def></def><kwa>string</kwa> <def>range</def> <kwb>$ls $s $e</kwb><def></def><sym>]</sym><br />
<def></def>	<kwa>set</kwa> <def>s</def> <sym>[</sym><def></def><kwa>incr</kwa> <def>e</def><sym>]</sym><br />
<def></def>	<kwa>incr</kwa> <def>e</def> <kwb>$width</kwb><br />
<def></def>    <sym>}</sym><br />
<def></def>    <kwa>puts</kwa> <def></def><sym>[</sym><def></def><kwa>string</kwa> <def>range</def> <kwb>$ls $s $n</kwb><def></def><sym>]</sym><br />
<def></def><sym>}</sym><br />
<def></def><br />
<kwa>proc</kwa> <def>make_random_fasta</def> <sym>{</sym><def>id desc src n</def><sym>} {</sym><br />
<def></def>    <kwa>foreach</kwa> <def></def><sym>{</sym><def>width line</def><sym>} {</sym><def></def><num>60</num> <def></def><str>&quot;&quot;</str><def></def><sym>}</sym> <def></def><kwa>break</kwa><br />
<def></def><br />
    <kwa>puts</kwa> <def></def><str>&quot;&gt;$id $desc&quot;</str><def></def><br />
    <kwa>set</kwa> <def>prob</def> <sym>[</sym><def>make_cumulative</def> <kwb>$src</kwb><def></def><sym>]</sym><br />
<def></def>    <kwa>for</kwa> <def></def><sym>{</sym><def></def><kwa>set</kwa> <def>i</def> <num>0</num><def></def><sym>} {</sym><def></def><kwb>$i</kwb> <def></def><sym>&lt;</sym> <def></def><kwb>$n</kwb><def></def><sym>} {</sym><def></def><kwa>incr</kwa> <def>i</def><sym>} {</sym><br />
<def></def>	<kwa>set</kwa> <def>rand</def> <sym>[</sym><def>gen_random</def> <num>1.0</num><def></def><sym>]</sym><br />
<def></def>	<kwa>foreach</kwa> <def></def><sym>{</sym><def>p c</def><sym>}</sym> <def></def><kwb>$prob</kwb> <def></def><sym>{</sym><br />
<def></def>	    <kwa>if</kwa> <def></def><sym>{</sym><def></def><kwb>$p</kwb> <def></def><sym>&gt;</sym> <def></def><kwb>$rand</kwb><def></def><sym>} {</sym><br />
<def></def>		<kwa>append</kwa> <def>line</def> <kwb>$c</kwb><br />
<def></def>		<kwa>break</kwa><br />
<def></def>	    <sym>}</sym><br />
<def></def>	<sym>}</sym><br />
<def></def>	<kwa>if</kwa> <def></def><sym>{[</sym><def></def><kwa>string</kwa> <def>length</def> <kwb>$line</kwb><def></def><sym>] ==</sym> <def></def><kwb>$width</kwb><def></def><sym>} {</sym><br />
<def></def>	    <kwa>puts</kwa> <def></def><kwb>$line</kwb><br />
<def></def>	    <kwa>set</kwa> <def>line</def> <str>&quot;&quot;</str><def></def><br />
	<sym>}</sym><br />
<def></def>    <sym>}</sym><br />
<def></def>    <kwa>if</kwa> <def></def><sym>{[</sym><def></def><kwa>string</kwa> <def>length</def> <kwb>$line</kwb><def></def><sym>]} {</sym><def></def><kwa>puts</kwa> <def></def><kwb>$line</kwb><def></def><sym>}</sym><br />
<def></def><sym>}</sym><br />
<def></def><br />
<kwa>proc</kwa> <def>main</def> <sym>{</sym><def>n</def><sym>} {</sym><br />
<def>    make_gen_random<br />
    make_repeat_fasta ONE</def> <str>&quot;Homo sapiens alu&quot;</str><def> $</def><sym>::</sym><def></def><kwd>alu</kwd> <def></def><sym>[</sym><def></def><kwa>expr</kwa> <def></def><sym>{</sym><def></def><kwb>$n</kwb><def></def><sym>*</sym><def></def><num>2</num><def></def><sym>}]</sym><br />
<def>    make_random_fasta TWO</def> <str>&quot;IUB ambiguity codes&quot;</str><def> $</def><sym>::</sym><def></def><kwd>iub</kwd> <def></def><sym>[</sym><def></def><kwa>expr</kwa> <def></def><sym>{</sym><def></def><kwb>$n</kwb><def></def><sym>*</sym><def></def><num>3</num><def></def><sym>}]</sym><br />
<def>    make_random_fasta THREE</def> <str>&quot;Homo sapiens frequency&quot;</str><def> $</def><sym>::</sym><def></def><kwd>hsapiens</kwd> <def></def><sym>[</sym><def></def><kwa>expr</kwa> <def></def><sym>{</sym><def></def><kwb>$n</kwb><def></def><sym>*</sym><def></def><num>5</num><def></def><sym>}]</sym><br />
<def></def><sym>}</sym><br />
<def></def><br />
<kwa>set</kwa> <def>N</def> <sym>[</sym><def></def><kwa>lindex</kwa> <def></def><kwb>$argv</kwb> <def></def><num>0</num><def></def><sym>]</sym><br />
<def></def><kwa>if</kwa> <def></def><sym>{</sym><def></def><kwb>$N</kwb> <def></def><sym>&lt;</sym> <def></def><num>1</num><def></def><sym>} {</sym><def></def><kwa>set</kwa> <def>N</def> <num>1</num><def></def><sym>}</sym><br />
<def>main</def> <kwb>$N</kwb><def></def><br />
</source>
