<source>
<def></def><slc>;; The Computer Language Benchmarks Game</slc><br />
<def></def><slc>;; http://shootout.alioth.debian.org/</slc><br />
<def></def><slc>;;</slc><br />
<def></def><slc>;; Based on D language implementation by Dave Fladebo [imperative version]</slc><br />
<def></def><slc>;; Derived from the Chicken variant by Anthony Borla</slc><br />
<def></def><slc>;; contributed by Matthew Flatt</slc><br />
<def><br />
<br />
#lang scheme</def><sym>/</sym><def>base</def><br />
<sym>(</sym><def>require scheme</def><sym>/</sym><def>cmdline</def><sym>)</sym><br />
<def></def><br />
<sym>(</sym><def>let</def> <sym>((</sym><def>n</def> <sym>(</sym><def>exact</def><sym>-&gt;</sym><def>inexact</def><br />
          <sym>(</sym><def>string</def><sym>-&gt;</sym><def>number</def><br />
           <sym>(</sym><def></def><kwa>command</kwa><def></def><sym>-</sym><def></def><kwa>line</kwa> <def>#</def><sym>:</sym><def>args</def> <sym>(</sym><def>n</def><sym>)</sym> <def>n</def><sym>)))))</sym><br />
<def></def><br />
  <sym>(</sym><def>let loop</def> <sym>([</sym><def>d</def> <num>0.0</num><def></def><sym>]</sym><br />
<def></def>             <sym>(</sym><def>alt</def> <num>1</num><def></def><sym>) (</sym><def>d2</def> <num>0</num><def></def><sym>) (</sym><def>d3</def> <num>0</num><def></def><sym>) (</sym><def>ds</def> <num>0</num><def></def><sym>) (</sym><def>dc</def> <num>0</num><def></def><sym>)</sym><br />
<def></def>             <sym>(</sym><def>s0</def> <num>0</num><def></def><sym>) (</sym><def>s1</def> <num>0</num><def></def><sym>) (</sym><def>s2</def> <num>0</num><def></def><sym>) (</sym><def>s3</def> <num>0</num><def></def><sym>) (</sym><def>s4</def> <num>0</num><def></def><sym>) (</sym><def>s5</def> <num>0</num><def></def><sym>) (</sym><def>s6</def> <num>0</num><def></def><sym>) (</sym><def>s7</def> <num>0</num><def></def><sym>) (</sym><def>s8</def> <num>0</num><def></def><sym>))</sym><br />
<def></def>    <sym>(</sym><def></def><kwa>if</kwa> <def></def><sym>(=</sym> <def>d n</def><sym>)</sym><br />
<def></def>        <sym>(</sym><def>let</def> <sym>([</sym><def>format</def><sym>-</sym><def>result</def><br />
               <sym>(</sym><def></def><kwa>lambda</kwa> <def></def><sym>(</sym><def>str n</def><sym>)</sym><br />
<def></def>                 <sym>(</sym><def>printf str</def> <sym>(</sym><def>real</def><sym>-&gt;</sym><def>decimal</def><sym>-</sym><def>string n</def> <num>9</num><def></def><sym>)))])</sym><br />
<def></def><br />
          <sym>(</sym><def>format</def><sym>-</sym><def>result</def> <str>&quot;~a</str><esc>\</esc><str>t(2/3)^k</str><esc>\</esc><str>n&quot;</str><def> s0</def><sym>)</sym><br />
<def></def>          <sym>(</sym><def>format</def><sym>-</sym><def>result</def> <str>&quot;~a</str><esc>\</esc><str>tk^-0.5</str><esc>\</esc><str>n&quot;</str><def> s1</def><sym>)</sym><br />
<def></def>          <sym>(</sym><def>format</def><sym>-</sym><def>result</def> <str>&quot;~a</str><esc>\</esc><str>t1/k(k+1)</str><esc>\</esc><str>n&quot;</str><def> s2</def><sym>)</sym><br />
<def></def>          <sym>(</sym><def>format</def><sym>-</sym><def>result</def> <str>&quot;~a</str><esc>\</esc><str>tFlint Hills</str><esc>\</esc><str>n&quot;</str><def> s3</def><sym>)</sym><br />
<def></def>          <sym>(</sym><def>format</def><sym>-</sym><def>result</def> <str>&quot;~a</str><esc>\</esc><str>tCookson Hills</str><esc>\</esc><str>n&quot;</str><def> s4</def><sym>)</sym><br />
<def></def>          <sym>(</sym><def>format</def><sym>-</sym><def>result</def> <str>&quot;~a</str><esc>\</esc><str>tHarmonic</str><esc>\</esc><str>n&quot;</str><def> s5</def><sym>)</sym><br />
<def></def>          <sym>(</sym><def>format</def><sym>-</sym><def>result</def> <str>&quot;~a</str><esc>\</esc><str>tRiemann Zeta</str><esc>\</esc><str>n&quot;</str><def> s6</def><sym>)</sym><br />
<def></def>          <sym>(</sym><def>format</def><sym>-</sym><def>result</def> <str>&quot;~a</str><esc>\</esc><str>tAlternating Harmonic</str><esc>\</esc><str>n&quot;</str><def> s7</def><sym>)</sym><br />
<def></def>          <sym>(</sym><def>format</def><sym>-</sym><def>result</def> <str>&quot;~a</str><esc>\</esc><str>tGregory</str><esc>\</esc><str>n&quot;</str><def> s8</def><sym>))</sym><br />
<def></def><br />
        <sym>(</sym><def>let</def><sym>* ((</sym><def>d</def> <sym>(+</sym> <def>d</def> <num>1</num><def></def><sym>))</sym><br />
<def></def>               <sym>(</sym><def>d2</def> <sym>(*</sym> <def>d d</def><sym>))</sym><br />
<def></def>               <sym>(</sym><def>d3</def> <sym>(*</sym> <def>d2 d</def><sym>))</sym><br />
<def></def>               <sym>(</sym><def>ds</def> <sym>(</sym><def></def><kwa>sin</kwa> <def>d</def><sym>))</sym><br />
<def></def>               <sym>(</sym><def>dc</def> <sym>(</sym><def></def><kwa>cos</kwa> <def>d</def><sym>))</sym><br />
<def></def><br />
               <sym>(</sym><def>s0</def> <sym>(+</sym> <def>s0</def> <sym>(</sym><def></def><kwa>expt</kwa> <def></def><sym>(/</sym> <def></def><num>2.0 3</num><def></def><sym>) (-</sym> <def>d</def> <num>1</num><def></def><sym>))))</sym><br />
<def></def>               <sym>(</sym><def>s1</def> <sym>(+</sym> <def>s1</def> <sym>(/</sym> <def></def><num>1</num> <def></def><sym>(</sym><def></def><kwa>sqrt</kwa> <def>d</def><sym>))))</sym><br />
<def></def>               <sym>(</sym><def>s2</def> <sym>(+</sym> <def>s2</def> <sym>(/</sym> <def></def><num>1</num> <def></def><sym>(*</sym> <def>d</def> <sym>(+</sym> <def>d</def> <num>1</num><def></def><sym>)))))</sym><br />
<def></def>               <sym>(</sym><def>s3</def> <sym>(+</sym> <def>s3</def> <sym>(/</sym> <def></def><num>1</num> <def></def><sym>(*</sym> <def>d3</def> <sym>(*</sym> <def>ds ds</def><sym>)))))</sym><br />
<def></def>               <sym>(</sym><def>s4</def> <sym>(+</sym> <def>s4</def> <sym>(/</sym> <def></def><num>1</num> <def></def><sym>(*</sym> <def>d3</def> <sym>(*</sym> <def>dc dc</def><sym>)))))</sym><br />
<def></def>               <sym>(</sym><def>s5</def> <sym>(+</sym> <def>s5</def> <sym>(/</sym> <def></def><num>1</num> <def>d</def><sym>)))</sym><br />
<def></def>               <sym>(</sym><def>s6</def> <sym>(+</sym> <def>s6</def> <sym>(/</sym> <def></def><num>1</num> <def>d2</def><sym>)))</sym><br />
<def></def>               <sym>(</sym><def>s7</def> <sym>(+</sym> <def>s7</def> <sym>(/</sym> <def>alt d</def><sym>)))</sym><br />
<def></def>               <sym>(</sym><def>s8</def> <sym>(+</sym> <def>s8</def> <sym>(/</sym> <def>alt</def> <sym>(- (*</sym> <def></def><num>2</num> <def>d</def><sym>)</sym> <def></def><num>1</num><def></def><sym>))))</sym><br />
<def></def>               <sym>(</sym><def>alt</def> <sym>(-</sym> <def>alt</def><sym>)))</sym><br />
<def></def><br />
	  <sym>(</sym><def>loop d<br />
		alt d2 d3 ds dc<br />
		s0 s1 s2 s3 s4 s5 s6 s7 s8</def><sym>)))))</sym><def></def><br />
</source>
