<source>
<def></def><slc>#The Great Computer Language Shootout</slc><br />
<def></def><slc>#http://shootout.alioth.debian.org/</slc><br />
<def></def><slc>#contributed by Dominique Wahli</slc><br />
<def></def><br />
<kwa>from</kwa> <def>sys</def> <kwa>import</kwa> <def>stdin</def><br />
<kwa>from</kwa> <def>re</def> <kwa>import</kwa> <def>sub</def><sym>,</sym> <def>findall<br />
<br />
seq</def> <sym>=</sym> <def>stdin</def><sym>.</sym><def></def><kwd>read</kwd><def></def><sym>()</sym><br />
<def>ilen</def> <sym>=</sym> <def></def><kwb>len</kwb><def></def><sym>(</sym><def>seq</def><sym>)</sym><br />
<def><br />
seq</def> <sym>=</sym> <def></def><kwd>sub</kwd><def></def><sym>(</sym><def></def><str>'(&gt;.*</str><esc>\n</esc><str>)|(</str><esc>\n</esc><str>)'</str><def></def><sym>,</sym> <def></def><str>''</str><def></def><sym>,</sym> <def>seq</def><sym>)</sym><br />
<def>clen</def> <sym>=</sym> <def></def><kwb>len</kwb><def></def><sym>(</sym><def>seq</def><sym>)</sym><br />
<def><br />
variants</def> <sym>= (</sym><br />
<def></def>      <str>'agggtaaa|tttaccct'</str><def></def><sym>,</sym><br />
<def></def>      <str>'[cgt]gggtaaa|tttaccc[acg]'</str><def></def><sym>,</sym><br />
<def></def>      <str>'a[act]ggtaaa|tttacc[agt]t'</str><def></def><sym>,</sym><br />
<def></def>      <str>'ag[act]gtaaa|tttac[agt]ct'</str><def></def><sym>,</sym><br />
<def></def>      <str>'agg[act]taaa|ttta[agt]cct'</str><def></def><sym>,</sym><br />
<def></def>      <str>'aggg[acg]aaa|ttt[cgt]ccct'</str><def></def><sym>,</sym><br />
<def></def>      <str>'agggt[cgt]aa|tt[acg]accct'</str><def></def><sym>,</sym><br />
<def></def>      <str>'agggta[cgt]a|t[acg]taccct'</str><def></def><sym>,</sym><br />
<def></def>      <str>'agggtaa[cgt]|[acg]ttaccct'</str><def></def><sym>)</sym><br />
<def></def><kwa>for</kwa> <def>f</def> <kwa>in</kwa> <def>variants</def><sym>:</sym><br />
<def></def>    <kwa>print</kwa> <def>f</def><sym>,</sym> <def></def><kwb>len</kwb><def></def><sym>(</sym><def></def><kwd>findall</kwd><def></def><sym>(</sym><def>f</def><sym>,</sym> <def>seq</def><sym>))</sym><br />
<def><br />
subst</def> <sym>= {</sym><br />
<def></def>      <str>'B'</str><def></def> <sym>:</sym> <def></def><str>'(c|g|t)'</str><def></def><sym>,</sym> <def></def><str>'D'</str><def></def> <sym>:</sym> <def></def><str>'(a|g|t)'</str><def></def><sym>,</sym>   <def></def><str>'H'</str><def></def> <sym>:</sym> <def></def><str>'(a|c|t)'</str><def></def><sym>,</sym> <def></def><str>'K'</str><def></def> <sym>:</sym> <def></def><str>'(g|t)'</str><def></def><sym>,</sym><br />
<def></def>      <str>'M'</str><def></def> <sym>:</sym> <def></def><str>'(a|c)'</str><def></def><sym>,</sym>   <def></def><str>'N'</str><def></def> <sym>:</sym> <def></def><str>'(a|c|g|t)'</str><def></def><sym>,</sym> <def></def><str>'R'</str><def></def> <sym>:</sym> <def></def><str>'(a|g)'</str><def></def><sym>,</sym>   <def></def><str>'S'</str><def></def> <sym>:</sym> <def></def><str>'(c|g)'</str><def></def><sym>,</sym><br />
<def></def>      <str>'V'</str><def></def> <sym>:</sym> <def></def><str>'(a|c|g)'</str><def></def><sym>,</sym> <def></def><str>'W'</str><def></def> <sym>:</sym> <def></def><str>'(a|t)'</str><def></def><sym>,</sym>     <def></def><str>'Y'</str><def></def> <sym>:</sym> <def></def><str>'(c|t)'</str><def></def><sym>}</sym><br />
<def></def><kwa>for</kwa> <def>f</def><sym>,</sym> <def>r</def> <kwa>in</kwa> <def>subst</def><sym>.</sym><def></def><kwd>items</kwd><def></def><sym>():</sym><br />
<def>    seq</def> <sym>=</sym> <def></def><kwd>sub</kwd><def></def><sym>(</sym><def>f</def><sym>,</sym> <def>r</def><sym>,</sym> <def>seq</def><sym>)</sym><br />
<def></def><br />
<kwa>print</kwa><br />
<def></def><kwa>print</kwa> <def>ilen</def><br />
<kwa>print</kwa> <def>clen</def><br />
<kwa>print</kwa> <def></def><kwb>len</kwb><def></def><sym>(</sym><def>seq</def><sym>)</sym><br />
<def></def><br />
<br />
</source>
