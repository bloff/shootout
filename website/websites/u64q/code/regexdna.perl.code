<source>
<def></def><slc># The Computer Language Benchmarks Game</slc><br />
<def></def><slc># http://shootout.alioth.debian.org/</slc><br />
<def></def><slc># contributed by Danny Sauer</slc><br />
<def></def><slc># completely rewritten and</slc><br />
<def></def><slc># cleaned up for speed and fun by</slc><br />
<def></def><slc># Mirco Wahab (wahab@chemie.uni-halle.de)</slc><br />
<def></def><slc>#</slc><br />
<def></def><slc># Rewritten by</slc><br />
<def></def><slc># Emanuele Zeppieri</slc><br />
<def></def><br />
<kwa>use</kwa> <def></def><kwd>strict</kwd><def></def><sym>;</sym><br />
<def></def><br />
<kwc>my</kwc> <def></def><kwb>$input</kwb> <def></def><sym>=</sym> <def></def><kwa>do</kwa> <def></def><sym>{</sym> <def></def><kwc>local</kwc> <def></def><sym>$/; &lt;</sym><def>STDIN</def><sym>&gt; };</sym><br />
<def></def><kwc>my</kwc> <def></def><kwb>$file_length</kwb> <def></def><sym>=</sym> <def>length</def> <kwb>$input</kwb><def></def><sym>;</sym><br />
<def></def><br />
<kwb>$input</kwb> <def></def><sym>=~</sym> <def>s</def><sym>/^&gt;.*$//</sym><def></def><kwd>mg</kwd><def></def><sym>;</sym><br />
<def></def><kwb>$input</kwb> <def></def><sym>=~</sym> <def>tr</def><sym>/</sym><def></def><esc>\n</esc><def></def><sym>//</sym><def></def><kwd>d</kwd><def></def><sym>;</sym><br />
<def></def><br />
<kwc>my</kwc> <def></def><kwb>$seq_length</kwb> <def></def><sym>=</sym> <def>length</def> <kwb>$input</kwb><def></def><sym>;</sym><br />
<def></def><br />
<kwa>for</kwa> <def></def><sym>(</sym><br />
<def></def>        <str>'agggtaaa|tttaccct'</str><def></def><sym>,</sym><br />
<def></def>    <str>'[cgt]gggtaaa|tttaccc[acg]'</str><def></def><sym>,</sym><br />
<def></def>    <str>'a[act]ggtaaa|tttacc[agt]t'</str><def></def><sym>,</sym><br />
<def></def>    <str>'ag[act]gtaaa|tttac[agt]ct'</str><def></def><sym>,</sym><br />
<def></def>    <str>'agg[act]taaa|ttta[agt]cct'</str><def></def><sym>,</sym><br />
<def></def>    <str>'aggg[acg]aaa|ttt[cgt]ccct'</str><def></def><sym>,</sym><br />
<def></def>    <str>'agggt[cgt]aa|tt[acg]accct'</str><def></def><sym>,</sym><br />
<def></def>    <str>'agggta[cgt]a|t[acg]taccct'</str><def></def><sym>,</sym><br />
<def></def>    <str>'agggtaa[cgt]|[acg]ttaccct'</str><def></def><br />
<sym>) {</sym><br />
<def></def>    <kwc>my</kwc> <def></def><sym>(</sym><def></def><kwb>$r1</kwb><def></def><sym>,</sym> <def></def><kwb>$r2</kwb><def></def><sym>) =</sym> <def>split</def> <sym>/</sym><def>\</def><sym>|/;</sym><br />
<def></def>    <kwc>my</kwc> <def></def><kwb>$count</kwb><def></def><sym>;</sym><br />
<def></def>    <kwb>$count</kwb><def></def><sym>++</sym> <def></def><kwa>while</kwa> <def></def><kwb>$input</kwb> <def></def><sym>=~ /</sym><def></def><kwb>$r1</kwb><def></def><sym>/</sym><def></def><kwd>gi</kwd><def></def><sym>;</sym><br />
<def></def>    <kwb>$count</kwb><def></def><sym>++</sym> <def></def><kwa>while</kwa> <def></def><kwb>$input</kwb> <def></def><sym>=~ /</sym><def></def><kwb>$r2</kwb><def></def><sym>/</sym><def></def><kwd>gi</kwd><def></def><sym>;</sym><br />
<def></def>    <kwc>print</kwc> <def></def><str>&quot;$_ $count</str><esc>\n</esc><str>&quot;</str><def></def><br />
<sym>}</sym><br />
<def></def><br />
<kwc>my</kwc> <def></def><kwb>%iub</kwb> <def></def><sym>= (</sym><br />
<def>    B</def> <sym>=&gt;</sym> <def></def><str>'(c|g|t)'</str><def></def><sym>,</sym> <def>D</def> <sym>=&gt;</sym> <def></def><str>'(a|g|t)'</str><def></def><sym>,</sym> <def>H</def> <sym>=&gt;</sym> <def></def><str>'(a|c|t)'</str><def></def>  <sym>,</sym><br />
<def>    K</def> <sym>=&gt;</sym> <def></def><str>'(g|t)'</str><def></def>  <sym>,</sym> <def>M</def> <sym>=&gt;</sym> <def></def><str>'(a|c)'</str><def></def>  <sym>,</sym> <def>N</def> <sym>=&gt;</sym> <def></def><str>'(a|c|g|t)'</str><def></def><sym>,</sym><br />
<def>    R</def> <sym>=&gt;</sym> <def></def><str>'(a|g)'</str><def></def>  <sym>,</sym> <def>S</def> <sym>=&gt;</sym> <def></def><str>'(c|g)'</str><def></def>  <sym>,</sym> <def>V</def> <sym>=&gt;</sym> <def></def><str>'(a|c|g)'</str><def></def>  <sym>,</sym><br />
<def>    W</def> <sym>=&gt;</sym> <def></def><str>'(a|t)'</str><def></def>  <sym>,</sym> <def>Y</def> <sym>=&gt;</sym> <def></def><str>'(c|t)'</str><def></def><br />
<sym>);</sym><br />
<def></def><kwc>my</kwc> <def></def><kwb>$findiub</kwb> <def></def><sym>=</sym> <def></def><str>'(['</str><def></def> <sym>.</sym> <def></def><kwd>join</kwd><def></def><sym>(</sym><def></def><str>''</str><def></def><sym>,</sym> <def>keys</def> <kwb>%iub</kwb><def></def><sym>) .</sym> <def></def><str>'])'</str><def></def><sym>;</sym><br />
<def></def><kwb>$input</kwb> <def></def><sym>=~</sym> <def>s</def><sym>/</sym><def></def><kwb>$findiub</kwb><def></def><sym>/</sym><def></def><kwb>$iub</kwb><def></def><sym>{</sym><def></def><kwb>$1</kwb><def></def><sym>}/</sym><def></def><kwd>og</kwd><def></def><sym>;</sym><br />
<def><br />
printf</def> <str>&quot;</str><esc>\n</esc><str>%d</str><esc>\n</esc><str>%d</str><esc>\n</esc><str>%d</str><esc>\n</esc><str>&quot;</str><def></def><sym>,</sym> <def></def><kwb>$file_length</kwb><def></def><sym>,</sym> <def></def><kwb>$seq_length</kwb><def></def><sym>,</sym> <def>length</def> <kwb>$input</kwb><def></def><sym>;</sym><def></def><br />
</source>
