<source>
<def></def><slc># The Computer Language Shootout</slc><br />
<def></def><slc># http://shootout.alioth.debian.org/</slc><br />
<def></def><slc># contributed by Heiner Marxen, modified for regexp by Andrew McParland</slc><br />
<def></def><br />
<kwa>proc</kwa> <def>regex</def><kwc>-dna</kwc> <def></def><sym>{} {</sym><br />
<def></def>    <kwa>set</kwa> <def>seq</def> <sym>[</sym><def></def><kwa>read</kwa> <def>stdin</def><sym>]</sym><br />
<def></def>    <kwa>set</kwa> <def>ilen</def>    <sym>[</sym><def></def><kwa>string</kwa> <def>length</def> <kwb>$seq</kwb><def></def><sym>]</sym><br />
<def></def><br />
    <kwa>regsub</kwa> <def></def><kwc>-all -line</kwc> <def></def><sym>{</sym><def>^</def><sym>&gt;</sym><def>.</def><sym>*</sym><def>\n</def><sym>|</sym><def>\n</def><sym>}</sym> <def></def><kwb>$seq</kwb> <def></def><sym>{}</sym> <def>seq</def><br />
    <kwa>set</kwa> <def>clen</def>    <sym>[</sym><def></def><kwa>string</kwa> <def>length</def> <kwb>$seq</kwb><def></def><sym>]</sym><br />
<def></def><br />
    <kwa>foreach</kwa> <def>pat</def> <sym>[</sym><def></def><kwa>list</kwa>   <def></def><sym>{</sym><def>agggtaaa</def><sym>|</sym><def>tttaccct</def><sym>}</sym>     <def>\</def><br />
            <sym>{[</sym><def>cgt</def><sym>]</sym><def>gggtaaa</def><sym>|</sym><def>tttaccc</def><sym>[</sym><def>acg</def><sym>]}</sym> <def>\</def><br />
            <sym>{</sym><def>a</def><sym>[</sym><def>act</def><sym>]</sym><def>ggtaaa</def><sym>|</sym><def>tttacc</def><sym>[</sym><def>agt</def><sym>]</sym><def>t</def><sym>}</sym> <def>\</def><br />
            <sym>{</sym><def>ag</def><sym>[</sym><def>act</def><sym>]</sym><def>gtaaa</def><sym>|</sym><def>tttac</def><sym>[</sym><def>agt</def><sym>]</sym><def>ct</def><sym>}</sym> <def>\</def><br />
            <sym>{</sym><def>agg</def><sym>[</sym><def>act</def><sym>]</sym><def>taaa</def><sym>|</sym><def>ttta</def><sym>[</sym><def>agt</def><sym>]</sym><def>cct</def><sym>}</sym> <def>\</def><br />
            <sym>{</sym><def>aggg</def><sym>[</sym><def>acg</def><sym>]</sym><def>aaa</def><sym>|</sym><def>ttt</def><sym>[</sym><def>cgt</def><sym>]</sym><def>ccct</def><sym>}</sym> <def>\</def><br />
            <sym>{</sym><def>agggt</def><sym>[</sym><def>cgt</def><sym>]</sym><def>aa</def><sym>|</sym><def>tt</def><sym>[</sym><def>acg</def><sym>]</sym><def>accct</def><sym>}</sym> <def>\</def><br />
            <sym>{</sym><def>agggta</def><sym>[</sym><def>cgt</def><sym>]</sym><def>a</def><sym>|</sym><def>t</def><sym>[</sym><def>acg</def><sym>]</sym><def>taccct</def><sym>}</sym> <def>\</def><br />
            <sym>{</sym><def>agggtaa</def><sym>[</sym><def>cgt</def><sym>]|[</sym><def>acg</def><sym>]</sym><def>ttaccct</def><sym>}</sym> <def>\</def><br />
        <sym>] {</sym><br />
<def></def>    <kwa>set</kwa> <def>cnt</def> <sym>[</sym><def></def><kwa>regexp</kwa> <def></def><kwc>-all -nocase</kwc> <def></def><sym>--</sym> <def></def><kwb>$pat $seq</kwb><def></def><sym>]</sym><br />
<def></def>    <kwa>puts</kwa> <def></def><str>&quot;$pat $cnt&quot;</str><def></def><br />
    <sym>}</sym><br />
<def></def><br />
    <kwa>lappend</kwa> <def>map B</def> <sym>{(</sym><def>c</def><sym>|</sym><def>g</def><sym>|</sym><def>t</def><sym>)}</sym> <def>D</def> <sym>{(</sym><def>a</def><sym>|</sym><def>g</def><sym>|</sym><def>t</def><sym>)}</sym> <def>H</def> <sym>{(</sym><def>a</def><sym>|</sym><def>c</def><sym>|</sym><def>t</def><sym>)}</sym> <def>K</def> <sym>{(</sym><def>g</def><sym>|</sym><def>t</def><sym>)}</sym><br />
<def></def>    <kwa>lappend</kwa> <def>map M</def> <sym>{(</sym><def>a</def><sym>|</sym><def>c</def><sym>)}</sym>   <def>N</def> <sym>{(</sym><def>a</def><sym>|</sym><def>c</def><sym>|</sym><def>g</def><sym>|</sym><def>t</def><sym>)}</sym>   <def>R</def> <sym>{(</sym><def>a</def><sym>|</sym><def>g</def><sym>)}</sym>   <def>S</def> <sym>{(</sym><def>c</def><sym>|</sym><def>g</def><sym>)}</sym><br />
<def></def>    <kwa>lappend</kwa> <def>map V</def> <sym>{(</sym><def>a</def><sym>|</sym><def>c</def><sym>|</sym><def>g</def><sym>)}</sym> <def>W</def> <sym>{(</sym><def>a</def><sym>|</sym><def>t</def><sym>)}</sym>   <def>Y</def> <sym>{(</sym><def>c</def><sym>|</sym><def>t</def><sym>)}</sym><br />
<def></def><br />
    <kwa>foreach</kwa> <def></def><sym>{</sym><def>in out</def><sym>}</sym> <def></def><kwb>$map</kwb> <def></def><sym>{</sym><br />
<def></def>        <kwa>regsub</kwa> <def></def><kwc>-all</kwc> <def></def><kwb>$in $seq $out</kwb> <def>seq</def><br />
    <sym>}</sym><br />
<def></def><br />
    <kwa>puts</kwa> <def></def><sym>{}</sym><br />
<def></def>    <kwa>puts</kwa> <def></def><kwb>$ilen</kwb><br />
<def></def>    <kwa>puts</kwa> <def></def><kwb>$clen</kwb><br />
<def></def>    <kwa>puts</kwa> <def></def><sym>[</sym><def></def><kwa>string</kwa> <def>length</def> <kwb>$seq</kwb><def></def><sym>]</sym><br />
<def></def><br />
    <kwa>return</kwa> <def></def><num>0</num><br />
<def></def><sym>}</sym><br />
<def><br />
regex</def><kwc>-dna</kwc><def></def><br />
</source>
