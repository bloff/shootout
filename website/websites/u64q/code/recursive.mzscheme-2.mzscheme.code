<source>
<def></def><slc>;; The Computer Language Benchmarks Game</slc><br />
<def></def><slc>;; http://shootout.alioth.debian.org/</slc><br />
<def></def><slc>;;</slc><br />
<def></def><slc>;; from the Chicken variant contributed by Anthony Borla</slc><br />
<def></def><slc>;; modified by Matthew Flatt</slc><br />
<def><br />
#lang scheme</def><sym>/</sym><def>base</def><br />
<sym>(</sym><def>require scheme</def><sym>/</sym><def>cmdline</def><sym>)</sym><br />
<def></def><br />
<slc>;; -------------------------------</slc><br />
<def></def><br />
<sym>(</sym><def>define</def> <sym>(</sym><def>ack m n</def><sym>)</sym><br />
<def></def>  <sym>(</sym><def></def><kwa>cond</kwa> <def></def><sym>((</sym><def>zero? m</def><sym>) (+</sym> <def>n</def> <num>1</num><def></def><sym>))</sym><br />
<def></def>        <sym>((</sym><def>zero? n</def><sym>) (</sym><def>ack</def> <sym>(-</sym> <def>m</def> <num>1</num><def></def><sym>)</sym> <def></def><num>1</num><def></def><sym>))</sym><br />
<def></def>        <sym>(</sym><def>else</def> <sym>(</sym><def>ack</def> <sym>(-</sym> <def>m</def> <num>1</num><def></def><sym>) (</sym><def>ack m</def> <sym>(-</sym> <def>n</def> <num>1</num><def></def><sym>))))))</sym><br />
<def></def><br />
<slc>;; --------------</slc><br />
<def></def><br />
<sym>(</sym><def>define</def> <sym>(</sym><def>fib n</def><sym>)</sym><br />
<def></def>  <sym>(</sym><def></def><kwa>cond</kwa> <def></def><sym>((&lt;</sym> <def>n</def> <num>2</num><def></def><sym>)</sym> <def></def><num>1</num><def></def><sym>)</sym><br />
<def></def>        <sym>(</sym><def>else</def> <sym>(+ (</sym><def>fib</def> <sym>(-</sym> <def>n</def> <num>2</num><def></def><sym>)) (</sym><def>fib</def> <sym>(-</sym> <def>n</def> <num>1</num><def></def><sym>))))))</sym><br />
<def></def><br />
<sym>(</sym><def>define</def> <sym>(</sym><def>fibflt n</def><sym>)</sym><br />
<def></def>  <sym>(</sym><def></def><kwa>cond</kwa> <def></def><sym>((&lt;</sym> <def>n</def> <num>2.0</num><def></def><sym>)</sym> <def></def><num>1.0</num><def></def><sym>)</sym><br />
<def></def>        <sym>(</sym><def>else</def> <sym>(+ (</sym><def>fibflt</def> <sym>(-</sym> <def>n</def> <num>2.0</num><def></def><sym>)) (</sym><def>fibflt</def> <sym>(-</sym> <def>n</def> <num>1.0</num><def></def><sym>))))))</sym><br />
<def></def><br />
<slc>;; --------------</slc><br />
<def></def><br />
<sym>(</sym><def>define</def> <sym>(</sym><def>tak x y z</def><sym>)</sym><br />
<def></def>  <sym>(</sym><def></def><kwa>cond</kwa> <def></def><sym>((</sym><def></def><kwa>not</kwa> <def></def><sym>(&lt;</sym> <def>y x</def><sym>))</sym> <def>z</def><sym>)</sym><br />
<def></def>        <sym>(</sym><def>else</def> <sym>(</sym><def>tak</def> <sym>(</sym><def>tak</def> <sym>(-</sym> <def>x</def> <num>1</num><def></def><sym>)</sym> <def>y z</def><sym>) (</sym><def>tak</def> <sym>(-</sym> <def>y</def> <num>1</num><def></def><sym>)</sym> <def>z x</def><sym>) (</sym><def>tak</def> <sym>(-</sym> <def>z</def> <num>1</num><def></def><sym>)</sym> <def>x y</def><sym>)))))</sym><br />
<def></def><br />
<sym>(</sym><def>define</def> <sym>(</sym><def>takflt x y z</def><sym>)</sym><br />
<def></def>  <sym>(</sym><def></def><kwa>cond</kwa> <def></def><sym>((</sym><def></def><kwa>not</kwa> <def></def><sym>(&lt;</sym> <def>y x</def><sym>))</sym> <def>z</def><sym>)</sym><br />
<def></def>        <sym>(</sym><def>else</def> <sym>(</sym><def>takflt</def> <sym>(</sym><def>takflt</def> <sym>(-</sym> <def>x</def> <num>1.0</num><def></def><sym>)</sym> <def>y z</def><sym>) (</sym><def>takflt</def> <sym>(-</sym> <def>y</def> <num>1.0</num><def></def><sym>)</sym> <def>z x</def><sym>) (</sym><def>takflt</def> <sym>(-</sym> <def>z</def> <num>1.0</num><def></def><sym>)</sym> <def>x y</def><sym>)))))</sym><br />
<def></def><br />
<slc>;; -------------------------------</slc><br />
<def></def><br />
<sym>(</sym><def>define</def> <sym>(</sym><def>main n</def><sym>)</sym><br />
<def></def><br />
  <sym>(</sym><def>printf</def> <str>&quot;Ack(3,~A): ~A~%&quot;</str><def> n</def> <sym>(</sym><def>ack</def> <num>3</num> <def>n</def><sym>))</sym><br />
<def></def>  <sym>(</sym><def>printf</def> <str>&quot;Fib(~a): ~a~%&quot;</str><def></def><br />
          <sym>(</sym><def>real</def><sym>-&gt;</sym><def>decimal</def><sym>-</sym><def>string</def> <sym>(+</sym> <def></def><num>27.0</num> <def>n</def><sym>)</sym> <def></def><num>1</num><def></def><sym>)</sym><br />
<def></def>          <sym>(</sym><def>real</def><sym>-&gt;</sym><def>decimal</def><sym>-</sym><def>string</def> <sym>(</sym><def>fibflt</def> <sym>(+</sym> <def></def><num>27.0</num> <def>n</def><sym>))</sym> <def></def><num>1</num><def></def><sym>))</sym><br />
<def></def><br />
  <sym>(</sym><def></def><kwa>set</kwa><def></def><sym>!</sym> <def>n</def> <sym>(-</sym> <def>n</def> <num>1</num><def></def><sym>))</sym><br />
<def></def>  <sym>(</sym><def>printf</def> <str>&quot;Tak(~A,~A,~A): ~A~%&quot;</str><def></def> <sym>(*</sym> <def>n</def> <num>3</num><def></def><sym>) (*</sym> <def>n</def> <num>2</num><def></def><sym>)</sym> <def>n</def> <sym>(</sym><def>tak</def> <sym>(*</sym> <def>n</def> <num>3</num><def></def><sym>) (*</sym> <def>n</def> <num>2</num><def></def><sym>)</sym> <def>n</def><sym>))</sym><br />
<def></def><br />
  <sym>(</sym><def>printf</def> <str>&quot;Fib(3): ~A~%&quot;</str><def></def> <sym>(</sym><def>fib</def> <num>3</num><def></def><sym>))</sym><br />
<def></def>  <sym>(</sym><def>printf</def> <str>&quot;Tak(3.0,2.0,1.0): ~a~%&quot;</str><def></def> <sym>(</sym><def>real</def><sym>-&gt;</sym><def>decimal</def><sym>-</sym><def>string</def> <sym>(</sym><def>takflt</def> <num>3.0 2.0 1.0</num><def></def><sym>)</sym> <def></def><num>1</num><def></def><sym>)))</sym><br />
<def></def><br />
<slc>;; -------------------------------</slc><br />
<def></def><br />
<sym>(</sym><def>main</def> <sym>(</sym><def></def><kwa>command</kwa><def></def><sym>-</sym><def></def><kwa>line</kwa> <def>#</def><sym>:</sym><def>args</def> <sym>(</sym><def>n</def><sym>) (</sym><def>string</def><sym>-&gt;</sym><def>number n</def><sym>)))</sym><def></def><br />
</source>
