<source>
<def></def><slc>#!/usr/bin/tclsh</slc><br />
<def></def><slc>##</slc><br />
<def></def><slc>## The Computer Lannguage Shootout</slc><br />
<def></def><slc>## http://shootout.alioth.debian.org/</slc><br />
<def></def><slc>## Contributed by Heiner Marxen</slc><br />
<def></def><slc>##</slc><br />
<def></def><slc>## &quot;spectral-norm&quot;	for Tcl</slc><br />
<def></def><slc>## Call:	tclsh spectral-norm.tcl N</slc><br />
<def></def><slc>##</slc><br />
<def></def><slc>## $Id: spectralnorm.tcl.code,v 1.1 2008-08-05 04:40:20 igouy-guest Exp $</slc><br />
<def></def><br />
<kwa>proc</kwa> <def>A</def> <sym>{</sym><def>i j</def><sym>} {</sym><br />
<def></def>    <kwa>return</kwa> <def></def><sym>[</sym><def></def><kwa>expr</kwa> <def></def><sym>{</sym><def></def><num>1.0</num> <def></def><sym>/ ((</sym><def></def><kwb>$i</kwb><def></def><sym>+</sym><def></def><kwb>$j</kwb><def></def><sym>)*(</sym><def></def><kwb>$i</kwb><def></def><sym>+</sym><def></def><kwb>$j</kwb><def></def><sym>+</sym><def></def><num>1</num><def></def><sym>)/</sym><def></def><num>2</num> <def></def><sym>+</sym> <def></def><kwb>$i</kwb><def></def><sym>+</sym><def></def><num>1</num><def></def><sym>)}]</sym><br />
<def></def><sym>}</sym><br />
<def></def><br />
<kwa>set</kwa> <def>mulBody</def> <sym>{</sym><br />
<def></def>    <kwa>set</kwa> <def>r</def> <sym>[</sym><def></def><kwa>list</kwa><def></def><sym>]</sym><br />
<def></def>    <kwa>for</kwa> <def></def><sym>{</sym><def></def><kwa>set</kwa> <def>i</def> <num>0</num><def></def><sym>} {</sym><def></def><kwb>$i</kwb> <def></def><sym>&lt;</sym> <def></def><kwb>$n</kwb><def></def><sym>} {</sym><def></def><kwa>incr</kwa> <def>i</def><sym>} {</sym><br />
<def></def>	<kwa>set</kwa> <def>sum</def> <num>0.0</num><br />
<def></def>	<kwa>for</kwa> <def></def><sym>{</sym><def></def><kwa>set</kwa> <def>j</def> <num>0</num><def></def><sym>} {</sym><def></def><kwb>$j</kwb> <def></def><sym>&lt;</sym> <def></def><kwb>$n</kwb><def></def><sym>} {</sym><def></def><kwa>incr</kwa> <def>j</def><sym>} {</sym><br />
<def></def>	    <kwa>set</kwa> <def>sum</def> <sym>[</sym><def></def><kwa>expr</kwa> <def></def><sym>{</sym><def></def><kwb>$sum</kwb> <def></def><sym>+ [</sym><def>A_i_j</def><sym>] * [</sym><def></def><kwa>lindex</kwa> <def></def><kwb>$v $j</kwb><def></def><sym>]}]</sym><br />
<def></def>	<sym>}</sym><br />
<def></def>	<kwa>lappend</kwa> <def>r</def> <kwb>$sum</kwb><br />
<def></def>    <sym>}</sym><br />
<def></def>    <kwa>return</kwa> <def></def><kwb>$r</kwb><br />
<def></def><sym>}</sym><br />
<def></def><br />
<kwa>proc</kwa> <def>mulAv</def>  <sym>{</sym><def>n v</def><sym>} [</sym><def></def><kwa>string</kwa> <def>map</def> <sym>[</sym><def></def><kwa>list</kwa> <def>A_i_j</def> <sym>{</sym><def>A</def> <kwb>$i $j</kwb><def></def><sym>}]</sym> <def></def><kwb>$mulBody</kwb><def></def><sym>]</sym><br />
<def></def><kwa>proc</kwa> <def>mulAtv</def> <sym>{</sym><def>n v</def><sym>} [</sym><def></def><kwa>string</kwa> <def>map</def> <sym>[</sym><def></def><kwa>list</kwa> <def>A_i_j</def> <sym>{</sym><def>A</def> <kwb>$j $i</kwb><def></def><sym>}]</sym> <def></def><kwb>$mulBody</kwb><def></def><sym>]</sym><br />
<def></def><br />
<kwa>proc</kwa> <def>mulAtAv</def> <sym>{</sym><def>n v</def><sym>} {</sym><br />
<def></def>    <kwa>return</kwa> <def></def><sym>[</sym><def>mulAtv</def> <kwb>$n</kwb> <def></def><sym>[</sym><def>mulAv</def> <kwb>$n $v</kwb><def></def><sym>]]</sym><br />
<def></def><sym>}</sym><br />
<def></def><br />
<kwa>proc</kwa> <def>approximate</def> <sym>{</sym><def>n</def><sym>} {</sym><br />
<def></def>    <kwa>for</kwa> <def></def><sym>{</sym><def></def><kwa>set</kwa> <def>i</def> <num>0</num><def></def><sym>} {</sym><def></def><kwb>$i</kwb> <def></def><sym>&lt;</sym> <def></def><kwb>$n</kwb><def></def><sym>} {</sym><def></def><kwa>incr</kwa> <def>i</def><sym>} {</sym><br />
<def></def>	<kwa>lappend</kwa> <def>u</def> <num>1.0</num><br />
<def></def>    <sym>}</sym><br />
<def></def><br />
    <kwa>for</kwa> <def></def><sym>{</sym><def></def><kwa>set</kwa> <def>i</def> <num>0</num><def></def><sym>} {</sym><def></def><kwb>$i</kwb> <def></def><sym>&lt;</sym> <def></def><num>10</num><def></def><sym>} {</sym><def></def><kwa>incr</kwa> <def>i</def><sym>} {</sym><br />
<def></def>	<kwa>set</kwa> <def>v</def> <sym>[</sym><def>mulAtAv</def> <kwb>$n $u</kwb><def></def><sym>]</sym><br />
<def></def>	<kwa>set</kwa> <def>u</def> <sym>[</sym><def>mulAtAv</def> <kwb>$n $v</kwb><def></def><sym>]</sym><br />
<def></def>    <sym>}</sym><br />
<def></def><br />
    <kwa>set</kwa> <def>vBv</def> <num>0.0</num><br />
<def></def>    <kwa>set</kwa> <def>vv</def>  <num>0.0</num><br />
<def></def>    <kwa>for</kwa> <def></def><sym>{</sym><def></def><kwa>set</kwa> <def>i</def> <num>0</num><def></def><sym>} {</sym><def></def><kwb>$i</kwb> <def></def><sym>&lt;</sym> <def></def><kwb>$n</kwb><def></def><sym>} {</sym><def></def><kwa>incr</kwa> <def>i</def><sym>} {</sym><br />
<def></def>	<kwa>set</kwa> <def>vi</def>  <sym>[</sym><def></def><kwa>lindex</kwa> <def></def><kwb>$v $i</kwb><def></def><sym>]</sym><br />
<def></def>	<kwa>set</kwa> <def>vBv</def> <sym>[</sym><def></def><kwa>expr</kwa> <def></def><sym>{</sym><def></def><kwb>$vBv</kwb> <def></def><sym>+</sym> <def></def><kwb>$vi</kwb> <def></def><sym>* [</sym><def></def><kwa>lindex</kwa> <def></def><kwb>$u $i</kwb><def></def><sym>]}]</sym><br />
<def></def>	<kwa>set</kwa> <def>vv</def>  <sym>[</sym><def></def><kwa>expr</kwa> <def></def><sym>{</sym><def></def><kwb>$vv</kwb>  <def></def><sym>+</sym> <def></def><kwb>$vi</kwb> <def></def><sym>*</sym> <def></def><kwb>$vi</kwb>           <def></def><sym>}]</sym><br />
<def></def>    <sym>}</sym><br />
<def></def>    <kwa>return</kwa> <def></def><sym>[</sym><def></def><kwa>expr</kwa> <def></def><sym>{</sym><def>sqrt</def><sym>(</sym> <def></def><kwb>$vBv</kwb> <def></def><sym>/</sym> <def></def><kwb>$vv</kwb> <def></def><sym>)}]</sym><br />
<def></def><sym>}</sym><br />
<def></def><br />
<kwa>proc</kwa> <def>main</def> <sym>{</sym><def>argv</def><sym>} {</sym><br />
<def></def>    <kwa>set</kwa> <def>n</def> <num>100</num><br />
<def></def>    <kwa>if</kwa> <def></def><sym>{[</sym><def></def><kwa>llength</kwa> <def></def><kwb>$argv</kwb><def></def><sym>]} {</sym><def></def><kwa>set</kwa> <def>n</def> <sym>[</sym><def></def><kwa>lindex</kwa> <def></def><kwb>$argv</kwb> <def></def><num>0</num><def></def><sym>]}</sym><br />
<def></def><br />
    <kwa>puts</kwa> <def></def><sym>[</sym><def></def><kwa>format</kwa> <def></def><str>&quot;%.9f&quot;</str><def></def> <sym>[</sym><def>approximate</def> <kwb>$n</kwb><def></def><sym>]]</sym><br />
<def></def><br />
    <kwa>return</kwa> <def></def><num>0</num><br />
<def></def><sym>}</sym><br />
<def><br />
main</def> <kwb>$argv</kwb><def></def><br />
</source>
