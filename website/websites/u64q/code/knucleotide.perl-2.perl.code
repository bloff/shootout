<source>
<def></def><slc>#  The Computer Language Benchmarks Game</slc><br />
<def></def><slc>#  http://shootout.alioth.debian.org/</slc><br />
<def></def><slc>#  contributed by Karl FORNER</slc><br />
<def></def><slc># (borrowed fasta loading routine from Kjetil Skotheim, 2005-11-29)</slc><br />
<def></def><slc># Corrected again by Jesse Millikan</slc><br />
<def></def><slc># revised by Kuang-che Wu</slc><br />
<def></def><br />
<kwc>my</kwc> <def></def><sym>(</sym><def></def><kwb>$sequence</kwb><def></def><sym>);</sym><br />
<def></def><sym>$/ =</sym> <def></def><str>&quot;&gt;&quot;</str><def></def><sym>;</sym><br />
<def></def><sym>/^</sym><def>THREE</def><sym>/</sym> <def></def><kwa>and</kwa> <def></def><kwb>$sequence</kwb> <def></def><sym>=</sym> <def></def><kwd>uc</kwd><def></def><sym>(</sym><def>join</def> <str>&quot;&quot;</str><def></def><sym>,</sym> <def>grep</def> <sym>!/^</sym><def>THREE</def><sym>/,</sym> <def>split</def> <sym>/</sym><def></def><esc>\n</esc><def></def><sym>+/)</sym> <def></def><kwa>while</kwa> <def></def><sym>&lt;</sym><def>STDIN</def><sym>&gt;;</sym><br />
<def></def><br />
<kwc>my</kwc> <def></def><sym>(</sym><def></def><kwb>$l</kwb><def></def><sym>,</sym><def></def><kwb>%h</kwb><def></def><sym>,</sym><def></def><kwb>$sum</kwb><def></def><sym>) = (</sym><def>length</def> <kwb>$sequence</kwb><def></def><sym>);</sym><br />
<def></def><kwa>foreach</kwa> <def></def><kwc>my</kwc> <def></def><kwb>$frame</kwb> <def></def><sym>(</sym><def></def><num>1</num><def></def><sym>,</sym><def></def><num>2</num><def></def><sym>) {</sym><br />
<def></def>  <kwb>%h</kwb> <def></def><sym>= ();</sym><br />
<def></def>  <kwd>update_hash_for_frame</kwd><def></def><sym>(</sym><def></def><kwb>$frame</kwb><def></def><sym>);</sym><br />
<def></def>  <kwb>$sum</kwb> <def></def><sym>=</sym> <def></def><kwb>$l</kwb> <def></def><sym>-</sym> <def></def><kwb>$frame</kwb> <def></def><sym>+</sym> <def></def><num>1</num><def></def><sym>;</sym><br />
<def>  printf</def> <str>&quot;$_ %.3f</str><esc>\n</esc><str>&quot;</str><def></def><sym>,</sym> <def></def><kwb>$h</kwb><def></def><sym>{</sym><def></def><kwb>$_</kwb><def></def><sym>}*</sym><def></def><num>100</num><def></def><sym>/</sym><def></def><kwb>$sum</kwb> <def></def><kwa>for</kwa> <def>sort</def> <sym>{</sym> <def></def><kwb>$h</kwb><def></def><sym>{</sym><def></def><kwb>$b</kwb><def></def><sym>} &lt;=&gt;</sym> <def></def><kwb>$h</kwb><def></def><sym>{</sym><def></def><kwb>$a</kwb><def></def><sym>} ||</sym> <def></def><kwb>$a</kwb> <def></def><kwa>cmp</kwa> <def></def><kwb>$b</kwb> <def></def><sym>}</sym> <def>keys</def> <kwb>%h</kwb><def></def><sym>;</sym><br />
<def></def>  <kwc>print</kwc> <def></def><str>&quot;</str><esc>\n</esc><str>&quot;</str><def></def><sym>;</sym><br />
<def></def><sym>}</sym><br />
<def></def><br />
<kwa>foreach</kwa> <def></def><kwc>my</kwc> <def></def><kwb>$s</kwb> <def></def><sym>(</sym><def></def><kwd>qw</kwd><def></def><sym>(</sym><def>GGT GGTA GGTATT GGTATTTTAATT GGTATTTTAATTTATAGT</def><sym>)) {</sym><br />
<def></def>  <kwd>update_hash_for_frame</kwd><def></def><sym>(</sym><def></def><kwd>length</kwd><def></def><sym>(</sym><def></def><kwb>$s</kwb><def></def><sym>));</sym><br />
<def>  printf</def> <str>&quot;%d</str><esc>\t</esc><str>$s</str><esc>\n</esc><str>&quot;</str><def></def><sym>,</sym> <def></def><kwb>$h</kwb><def></def><sym>{</sym><def></def><kwb>$s</kwb><def></def><sym>};</sym><br />
<def></def><sym>}</sym><br />
<def></def><br />
<kwa>sub</kwa> <def>update_hash_for_frame</def> <sym>{</sym><br />
<def></def>  <kwc>my</kwc> <def></def><kwb>$frame</kwb> <def></def><sym>=</sym> <def></def><kwb>$_</kwb><def></def><sym>[</sym><def></def><num>0</num><def></def><sym>];</sym><br />
<def></def>  <kwb>$h</kwb><def></def><sym>{</sym><def></def><kwd>substr</kwd><def></def><sym>(</sym><def></def><kwb>$sequence</kwb><def></def><sym>,</sym><def></def><kwb>$_</kwb><def></def><sym>,</sym><def></def><kwb>$frame</kwb><def></def><sym>)}++</sym> <def></def><kwa>foreach</kwa> <def></def><sym>(</sym><def></def><num>0</num><def></def><sym>..(</sym><def></def><kwb>$l</kwb> <def></def><sym>-</sym> <def></def><kwb>$frame</kwb><def></def><sym>));</sym><br />
<def></def><sym>}</sym><br />
<def></def><br />
</source>
